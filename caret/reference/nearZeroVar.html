<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identification of near zero variance predictors — nearZeroVar • caret</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Identification of near zero variance predictors — nearZeroVar" />
<meta property="og:description" content="nearZeroVar diagnoses predictors that have one unique value (i.e. are
zero variance predictors) or predictors that are have both of the following
characteristics: they have very few unique values relative to the number of
samples and the ratio of the frequency of the most common value to the
frequency of the second most common value is large. checkConditionalX
looks at the distribution of the columns of x conditioned on the
levels of y and identifies columns of x that are sparse within
groups of y." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caret</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">6.0.84</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/caret.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/topepo/caret">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identification of near zero variance predictors</h1>
    <small class="dont-index">Source: <a href='https://github.com/topepo/caret/blob/master/R/nearZeroVar.R'><code>R/nearZeroVar.R</code></a></small>
    <div class="hidden name"><code>nearZeroVar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>nearZeroVar</code> diagnoses predictors that have one unique value (i.e. are
zero variance predictors) or predictors that are have both of the following
characteristics: they have very few unique values relative to the number of
samples and the ratio of the frequency of the most common value to the
frequency of the second most common value is large. <code>checkConditionalX</code>
looks at the distribution of the columns of <code>x</code> conditioned on the
levels of <code>y</code> and identifies columns of <code>x</code> that are sparse within
groups of <code>y</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>nearZeroVar</span>(<span class='no'>x</span>, <span class='kw'>freqCut</span> <span class='kw'>=</span> <span class='fl'>95</span>/<span class='fl'>5</span>, <span class='kw'>uniqueCut</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>saveMetrics</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>foreach</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>allowParallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>checkConditionalX</span>(<span class='no'>x</span>, <span class='no'>y</span>)

<span class='fu'>checkResamples</span>(<span class='no'>index</span>, <span class='no'>x</span>, <span class='no'>y</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a numeric vector or matrix, or a data frame with all numeric data</p></td>
    </tr>
    <tr>
      <th>freqCut</th>
      <td><p>the cutoff for the ratio of the most common value to the
second most common value</p></td>
    </tr>
    <tr>
      <th>uniqueCut</th>
      <td><p>the cutoff for the percentage of distinct values out of the
number of total samples</p></td>
    </tr>
    <tr>
      <th>saveMetrics</th>
      <td><p>a logical. If false, the positions of the zero- or
near-zero predictors is returned. If true, a data frame with predictor
information is returned.</p></td>
    </tr>
    <tr>
      <th>names</th>
      <td><p>a logical. If false, column indexes are returned. If true,
column names are returned.</p></td>
    </tr>
    <tr>
      <th>foreach</th>
      <td><p>should the <span class="pkg">foreach</span> package be used for the
computations? If <code>TRUE</code>, less memory should be used.</p></td>
    </tr>
    <tr>
      <th>allowParallel</th>
      <td><p>should the parallel processing via the <span class="pkg">foreach</span>
package be used for the computations? If <code>TRUE</code>, more memory will be
used but execution time should be shorter.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a factor vector with at least two levels</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>a list. Each element corresponds to the training set samples in
<code>x</code> for a given resample</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>nearZeroVar</code>: if <code>saveMetrics = FALSE</code>, a vector of
integers corresponding to the column positions of the problematic
predictors. If <code>saveMetrics = TRUE</code>, a data frame with columns:</p>
<dt>freqRatio </dt><dd><p>the ratio of frequencies for the most common value over
the second most common value</p></dd> <dt>percentUnique </dt><dd><p>the percentage of unique
data points out of the total number of data points</p></dd> <dt>zeroVar </dt><dd><p>a vector
of logicals for whether the predictor has only one distinct value</p></dd> <dt>nzv
</dt><dd><p>a vector of logicals for whether the predictor is a near zero variance
predictor</p></dd>

For checkResamples or checkConditionalX, a vector of column
indicators for predictors with empty conditional distributions in at least
one class of y.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For example, an example of near zero variance predictor is one that, for
1000 samples, has two distinct values and 999 of them are a single value.</p>
<p>To be flagged, first the frequency of the most prevalent value over the
second most frequent value (called the ``frequency ratio'') must be above
<code>freqCut</code>. Secondly, the ``percent of unique values,'' the number of
unique values divided by the total number of samples (times 100), must also
be below <code>uniqueCut</code>.</p>
<p>In the above example, the frequency ratio is 999 and the unique value
percentage is 0.0001.</p>
<p>Checking the conditional distribution of <code>x</code> may be needed for some
models, such as naive Bayes where the conditional distributions should have
at least one data point within a class.</p>
<p><code>nzv</code> is the original version of the function.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>nearZeroVar</span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>], <span class='kw'>saveMetrics</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;              freqRatio percentUnique zeroVar   nzv
#&gt; Sepal.Length  1.111111      23.33333   FALSE FALSE
#&gt; Sepal.Width   1.857143      15.33333   FALSE FALSE
#&gt; Petal.Length  1.000000      28.66667   FALSE FALSE
#&gt; Petal.Width   2.230769      14.66667   FALSE FALSE</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>BloodBrain</span>)
<span class='fu'>nearZeroVar</span>(<span class='no'>bbbDescr</span>)</div><div class='output co'>#&gt; [1]  3 16 17 22 25 50 60</div><div class='input'><span class='fu'>nearZeroVar</span>(<span class='no'>bbbDescr</span>, <span class='kw'>names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] "negative"     "peoe_vsa.2.1" "peoe_vsa.3.1" "a_acid"       "vsa_acid"    
#&gt; [6] "frac.anion7." "alert"       </div><div class='input'>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>classes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>30</span>))
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='fl'>45</span>),
                <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>80</span>)))

<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>x</span>, <span class='no'>table</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>classes</span>)</div><div class='output co'>#&gt; $x1
#&gt;    y
#&gt;      a  b  c
#&gt;   0 15 15 15
#&gt;   1 15 15 15
#&gt; 
#&gt; $x2
#&gt;    y
#&gt;      a  b  c
#&gt;   0 10  0  0
#&gt;   1 20 30 30
#&gt; </div><div class='input'><span class='fu'>checkConditionalX</span>(<span class='no'>x</span>, <span class='no'>classes</span>)</div><div class='output co'>#&gt; [1] 2</div><div class='input'>
<span class='no'>folds</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='createDataPartition.html'>createFolds</a></span>(<span class='no'>classes</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>returnTrain</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>x</span>$<span class='no'>x3</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>$<span class='no'>x1</span>
<span class='no'>x</span>$<span class='no'>x3</span>[<span class='no'>folds</span><span class='kw'>[[</span><span class='fl'>1</span>]]] <span class='kw'>&lt;-</span> <span class='fl'>0</span>

<span class='fu'>checkResamples</span>(<span class='no'>folds</span>, <span class='no'>x</span>, <span class='no'>classes</span>)</div><div class='output co'>#&gt; [1] 3 2</div><div class='input'>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Max Kuhn, with speed improvements to nearZeroVar by Allan Engelhardt</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Max Kuhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


