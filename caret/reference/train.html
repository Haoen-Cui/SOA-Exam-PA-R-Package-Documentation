<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Predictive Models over Different Tuning Parameters — train • caret</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit Predictive Models over Different Tuning Parameters — train" />
<meta property="og:description" content="This function sets up a grid of tuning parameters for a number
 of classification and regression routines, fits each model and
 calculates a resampling based performance measure." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caret</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">6.0.84</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/caret.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/topepo/caret">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Predictive Models over Different Tuning Parameters</h1>
    <small class="dont-index">Source: <a href='https://github.com/topepo/caret/blob/master/R/train.default.R'><code>R/train.default.R</code></a></small>
    <div class="hidden name"><code>train.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function sets up a grid of tuning parameters for a number
 of classification and regression routines, fits each model and
 calculates a resampling based performance measure.</p>
    </div>

    <pre class="usage"><span class='fu'>train</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>train</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"rf"</span>, <span class='kw'>preProcess</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>,
  <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/factor.html'>is.factor</a></span>(<span class='no'>y</span>), <span class='st'>"Accuracy"</span>, <span class='st'>"RMSE"</span>),
  <span class='kw'>maximize</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>metric</span> <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"RMSE"</span>, <span class='st'>"logLoss"</span>, <span class='st'>"MAE"</span>), <span class='fl'>FALSE</span>,
  <span class='fl'>TRUE</span>), <span class='kw'>trControl</span> <span class='kw'>=</span> <span class='fu'><a href='trainControl.html'>trainControl</a></span>(), <span class='kw'>tuneGrid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>tuneLength</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>trControl</span>$<span class='no'>method</span> <span class='kw'>==</span> <span class='st'>"none"</span>, <span class='fl'>1</span>, <span class='fl'>3</span>))

<span class='co'># S3 method for formula</span>
<span class='fu'>train</span>(<span class='no'>form</span>, <span class='no'>data</span>, <span class='no'>...</span>, <span class='no'>weights</span>, <span class='no'>subset</span>,
  <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='no'>na.fail</span>, <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='co'># S3 method for recipe</span>
<span class='fu'>train</span>(<span class='no'>x</span>, <span class='no'>data</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"rf"</span>, <span class='no'>...</span>,
  <span class='kw'>metric</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/factor.html'>is.factor</a></span>(<span class='no'>y_dat</span>), <span class='st'>"Accuracy"</span>, <span class='st'>"RMSE"</span>),
  <span class='kw'>maximize</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>metric</span> <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"RMSE"</span>, <span class='st'>"logLoss"</span>, <span class='st'>"MAE"</span>), <span class='fl'>FALSE</span>,
  <span class='fl'>TRUE</span>), <span class='kw'>trControl</span> <span class='kw'>=</span> <span class='fu'><a href='trainControl.html'>trainControl</a></span>(), <span class='kw'>tuneGrid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>tuneLength</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>trControl</span>$<span class='no'>method</span> <span class='kw'>==</span> <span class='st'>"none"</span>, <span class='fl'>1</span>, <span class='fl'>3</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>For the default method, <code>x</code> is an object where
samples are in rows and features are in columns. This could be a
simple matrix, data frame or other type (e.g. sparse matrix) but
must have column names (see Details below). Preprocessing using
the <code>preProcess</code> argument only supports matrices or data
frames. When using the recipe method, <code>x</code> should be an
unprepared <code>recipe</code> object that describes the model
terms (i.e. outcome, predictors, etc.) as well as any
pre-processing that should be done to the data. This is an
alternative approach to specifying the model. Note that, when
using the recipe method, any arguments passed to <code>preProcess</code>
will be ignored. See the links and example below for more details
using recipes.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed to the classification or
regression routine (such as
<code><a href='https://rdrr.io/pkg/randomForest/man/randomForest.html'>randomForest</a></code>). Errors will occur if
values for tuning parameters are passed here.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A numeric or factor vector containing the outcome for
each sample.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A string specifying which classification or
regression model to use. Possible values are found using
<code><a href='https://rdrr.io/r/base/names.html'>names(getModelInfo())</a></code>. See
<a href='http://topepo.github.io/caret/train-models-by-tag.html'>http://topepo.github.io/caret/train-models-by-tag.html</a>. A
list of functions can also be passed for a custom model
function. See
<a href='http://topepo.github.io/caret/using-your-own-model-in-train.html'>http://topepo.github.io/caret/using-your-own-model-in-train.html</a>
for details.</p></td>
    </tr>
    <tr>
      <th>preProcess</th>
      <td><p>A string vector that defines a pre-processing
of the predictor data. Current possibilities are "BoxCox",
"YeoJohnson", "expoTrans", "center", "scale", "range",
"knnImpute", "bagImpute", "medianImpute", "pca", "ica" and
"spatialSign". The default is no pre-processing. See
<code><a href='preProcess.html'>preProcess</a></code> and <code><a href='trainControl.html'>trainControl</a></code> on the
procedures and how to adjust them. Pre-processing code is only
designed to work when <code>x</code> is a simple matrix or data frame.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>A numeric vector of case weights. This argument
will only affect models that allow case weights.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>A string that specifies what summary metric will
be used to select the optimal model. By default, possible values
are "RMSE" and "Rsquared" for regression and "Accuracy" and
"Kappa" for classification. If custom performance metrics are
used (via the <code>summaryFunction</code> argument in
<code><a href='trainControl.html'>trainControl</a></code>, the value of <code>metric</code> should
match one of the arguments. If it does not, a warning is issued
and the first metric given by the <code>summaryFunction</code> is
used. (NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>maximize</th>
      <td><p>A logical: should the metric be maximized or
minimized?</p></td>
    </tr>
    <tr>
      <th>trControl</th>
      <td><p>A list of values that define how this function
acts. See <code><a href='trainControl.html'>trainControl</a></code> and
<a href='http://topepo.github.io/caret/using-your-own-model-in-train.html'>http://topepo.github.io/caret/using-your-own-model-in-train.html</a>.
(NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>tuneGrid</th>
      <td><p>A data frame with possible tuning values. The
columns are named the same as the tuning parameters. Use
<code><a href='modelLookup.html'>getModelInfo</a></code> to get a list of tuning parameters
for each model or see
<a href='http://topepo.github.io/caret/available-models.html'>http://topepo.github.io/caret/available-models.html</a>.
(NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>tuneLength</th>
      <td><p>An integer denoting the amount of granularity
in the tuning parameter grid. By default, this argument is the
number of levels for each tuning parameters that should be
generated by <code>train</code>. If <code><a href='trainControl.html'>trainControl</a></code>
has the option <code>search = "random"</code>, this is the maximum
number of tuning parameter combinations that will be generated
by the random search. (NOTE: If given, this argument must be
named.)</p></td>
    </tr>
    <tr>
      <th>form</th>
      <td><p>A formula of the form <code>y ~ x1 + x2 + ...</code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame from which variables specified in
<code>formula</code> or <code>recipe</code> are preferentially to be taken.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An index vector specifying the cases to be used
in the training sample. (NOTE: If given, this argument must be
named.)</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>A function to specify the action to be taken
if NAs are found. The default action is for the procedure to
fail. An alternative is <code>na.omit</code>, which leads to rejection
of cases with missing values on any required variable. (NOTE: If
given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>contrasts</th>
      <td><p>A list of contrasts to be used for some or all
the factors appearing as variables in the model formula.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list is returned of class <code>train</code> containing:</p>
<dt>method </dt><dd><p>The chosen model.</p></dd> <dt>modelType </dt><dd><p>An
 identifier of the model type.</p></dd> <dt>results </dt><dd><p>A data frame the
 training error rate and values of the tuning parameters.</p></dd>
 <dt>bestTune </dt><dd><p>A data frame with the final parameters.</p></dd>
 <dt>call</dt><dd><p>The (matched) function call with dots expanded</p></dd>
 <dt>dots</dt><dd><p>A list containing any ... values passed to the
 original call</p></dd> <dt>metric</dt><dd><p>A string that specifies what
 summary metric will be used to select the optimal model.</p></dd>
 <dt>control</dt><dd><p>The list of control parameters.</p></dd> <dt>preProcess
 </dt><dd><p>Either <code>NULL</code> or an object of class
 <code><a href='preProcess.html'>preProcess</a></code></p></dd> <dt>finalModel</dt><dd><p>A fit object using
 the best parameters</p></dd> <dt>trainingData</dt><dd><p>A data frame</p></dd>
 <dt>resample</dt><dd><p>A data frame with columns for each performance
 metric. Each row corresponds to each resample. If leave-one-out
 cross-validation or out-of-bag estimation methods are requested,
 this will be <code>NULL</code>. The <code>returnResamp</code> argument of
 <code><a href='trainControl.html'>trainControl</a></code> controls how much of the resampled
 results are saved.</p></dd> <dt>perfNames</dt><dd><p>A character vector of
 performance metrics that are produced by the summary function</p></dd>
 <dt>maximize</dt><dd><p>A logical recycled from the function arguments.</p></dd>
 <dt>yLimits</dt><dd><p>The range of the training set outcomes.</p></dd>
 <dt>times</dt><dd><p>A list of execution times: <code>everything</code> is for
 the entire call to <code>train</code>, <code>final</code> for the final
 model fit and, optionally, <code>prediction</code> for the time to
 predict new samples (see <code><a href='trainControl.html'>trainControl</a></code>)</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>train</code> can be used to tune models by picking the
 complexity parameters that are associated with the optimal
 resampling statistics. For particular model, a grid of
 parameters (if any) is created and the model is trained on
 slightly different data for each candidate combination of tuning
 parameters. Across each data set, the performance of held-out
 samples is calculated and the mean and standard deviation is
 summarized for each combination. The combination with the
 optimal resampling statistic is chosen as the final model and
 the entire training set is used to fit a final model.</p>
<p>The predictors in <code>x</code> can be most any object as long as
 the underlying model fit function can deal with the object
 class. The function was designed to work with simple matrices
 and data frame inputs, so some functionality may not work (e.g.
 pre-processing). When using string kernels, the vector of
 character strings should be converted to a matrix with a single
 column.</p>
<p>More details on this function can be found at
 <a href='http://topepo.github.io/caret/model-training-and-tuning.html'>http://topepo.github.io/caret/model-training-and-tuning.html</a>.</p>
<p>A variety of models are currently available and are enumerated
 by tag (i.e. their model characteristics) at
 <a href='http://topepo.github.io/caret/train-models-by-tag.html'>http://topepo.github.io/caret/train-models-by-tag.html</a>.</p>
<p>More details on using recipes can be found at
 <a href='http://topepo.github.io/caret/using-recipes-with-train.html'>http://topepo.github.io/caret/using-recipes-with-train.html</a>.
 Note that case weights can be passed into <code>train</code> using a
 role of <code>"case weight"</code> for a single variable. Also, if
 there are non-predictor columns that should be used when
 determining the model's performance metrics, the role of
 <code>"performance var"</code> can be used with multiple columns and
 these will be made available during resampling to the
 <code>summaryFunction</code> function.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='http://topepo.github.io/caret/'>http://topepo.github.io/caret/</a></p>
<p>Kuhn (2008), ``Building Predictive Models in R Using the caret''
(<a href='http://www.jstatsoft.org/article/view/v028i05/v28i05.pdf'>http://www.jstatsoft.org/article/view/v028i05/v28i05.pdf</a>)</p>
<p><a href='https://topepo.github.io/recipes/'>https://topepo.github.io/recipes/</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='models.html'>models</a></code>, <code><a href='trainControl.html'>trainControl</a></code>,
 <code><a href='update.train.html'>update.train</a></code>, <code><a href='modelLookup.html'>modelLookup</a></code>,
 <code><a href='createDataPartition.html'>createFolds</a></code>, <code><a href='https://rdrr.io/pkg/recipes/man/recipe.html'>recipe</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='co'>#######################################</span>
<span class='co'>## Classification Example</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>iris</span>)
<span class='no'>TrainData</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[,<span class='fl'>1</span>:<span class='fl'>4</span>]
<span class='no'>TrainClasses</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>[,<span class='fl'>5</span>]

<span class='no'>knnFit1</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>TrainData</span>, <span class='no'>TrainClasses</span>,
                 <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"knn"</span>,
                 <span class='kw'>preProcess</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"center"</span>, <span class='st'>"scale"</span>),
                 <span class='kw'>tuneLength</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                 <span class='kw'>trControl</span> <span class='kw'>=</span> <span class='fu'><a href='trainControl.html'>trainControl</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"cv"</span>))

<span class='no'>knnFit2</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>TrainData</span>, <span class='no'>TrainClasses</span>,
                 <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"knn"</span>,
                 <span class='kw'>preProcess</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"center"</span>, <span class='st'>"scale"</span>),
                 <span class='kw'>tuneLength</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                 <span class='kw'>trControl</span> <span class='kw'>=</span> <span class='fu'><a href='trainControl.html'>trainControl</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"boot"</span>))


<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>MASS</span>)
<span class='no'>nnetFit</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>TrainData</span>, <span class='no'>TrainClasses</span>,
                 <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"nnet"</span>,
                 <span class='kw'>preProcess</span> <span class='kw'>=</span> <span class='st'>"range"</span>,
                 <span class='kw'>tuneLength</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                 <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                 <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>100</span>)

<span class='co'>#######################################</span>
<span class='co'>## Regression Example</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mlbench</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>BostonHousing</span>)

<span class='no'>lmFit</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>medv</span> ~ <span class='no'>.</span> + <span class='no'>rm</span>:<span class='no'>lstat</span>,
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>BostonHousing</span>,
               <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"lm"</span>)

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>rpart</span>)
<span class='no'>rpartFit</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>medv</span> ~ <span class='no'>.</span>,
                  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>BostonHousing</span>,
                  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"rpart"</span>,
                  <span class='kw'>tuneLength</span> <span class='kw'>=</span> <span class='fl'>9</span>)

<span class='co'>#######################################</span>
<span class='co'>## Example with a custom metric</span>

<span class='no'>madSummary</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span> (<span class='no'>data</span>,
                        <span class='no'>lev</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                        <span class='no'>model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>) {
  <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/mad.html'>mad</a></span>(<span class='no'>data</span>$<span class='no'>obs</span> - <span class='no'>data</span>$<span class='no'>pred</span>,
             <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>out</span>) <span class='kw'>&lt;-</span> <span class='st'>"MAD"</span>
  <span class='no'>out</span>
}

<span class='no'>robustControl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='trainControl.html'>trainControl</a></span>(<span class='kw'>summaryFunction</span> <span class='kw'>=</span> <span class='no'>madSummary</span>)
<span class='no'>marsGrid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>degree</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nprune</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>10</span>) * <span class='fl'>2</span>)

<span class='no'>earthFit</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>medv</span> ~ <span class='no'>.</span>,
                  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>BostonHousing</span>,
                  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"earth"</span>,
                  <span class='kw'>tuneGrid</span> <span class='kw'>=</span> <span class='no'>marsGrid</span>,
                  <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"MAD"</span>,
                  <span class='kw'>maximize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                  <span class='kw'>trControl</span> <span class='kw'>=</span> <span class='no'>robustControl</span>)


<span class='co'>#######################################</span>
<span class='co'>## Example with a recipe</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>cox2</span>)

<span class='no'>cox2</span> <span class='kw'>&lt;-</span> <span class='no'>cox2Descr</span>
<span class='no'>cox2</span>$<span class='no'>potency</span> <span class='kw'>&lt;-</span> <span class='no'>cox2IC50</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>recipes</span>)

<span class='no'>cox2_recipe</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/recipe.html'>recipe</a></span>(<span class='no'>potency</span> ~ <span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>cox2</span>) <span class='kw'>%&gt;%</span>
  <span class='co'>## Log the outcome</span>
  <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/step_log.html'>step_log</a></span>(<span class='no'>potency</span>, <span class='kw'>base</span> <span class='kw'>=</span> <span class='fl'>10</span>) <span class='kw'>%&gt;%</span>
  <span class='co'>## Remove sparse and unbalanced predictors</span>
  <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/step_nzv.html'>step_nzv</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/recipes/man/has_role.html'>all_predictors</a></span>()) <span class='kw'>%&gt;%</span>
  <span class='co'>## Surface area predictors are highly correlated so</span>
  <span class='co'>## conduct PCA just on these.</span>
  <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/step_pca.html'>step_pca</a></span>(<span class='fu'>contains</span>(<span class='st'>"VSA"</span>), <span class='kw'>prefix</span> <span class='kw'>=</span> <span class='st'>"surf_area_"</span>,
           <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>.95</span>) <span class='kw'>%&gt;%</span>
  <span class='co'>## Remove other highly correlated predictors</span>
  <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/step_corr.html'>step_corr</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/recipes/man/has_role.html'>all_predictors</a></span>(), -<span class='fu'>starts_with</span>(<span class='st'>"surf_area_"</span>),
            <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>.90</span>) <span class='kw'>%&gt;%</span>
  <span class='co'>## Center and scale all of the non-PCA predictors</span>
  <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/step_center.html'>step_center</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/recipes/man/has_role.html'>all_predictors</a></span>(), -<span class='fu'>starts_with</span>(<span class='st'>"surf_area_"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/recipes/man/step_scale.html'>step_scale</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/recipes/man/has_role.html'>all_predictors</a></span>(), -<span class='fu'>starts_with</span>(<span class='st'>"surf_area_"</span>))

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>888</span>)
<span class='no'>cox2_lm</span> <span class='kw'>&lt;-</span> <span class='fu'>train</span>(<span class='no'>cox2_recipe</span>,
                 <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>cox2</span>,
                 <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"lm"</span>,
                 <span class='kw'>trControl</span> <span class='kw'>=</span> <span class='fu'><a href='trainControl.html'>trainControl</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"cv"</span>))

<span class='co'>#######################################</span>
<span class='co'>## Parallel Processing Example via multicore package</span>

<span class='co'>## library(doMC)</span>
<span class='co'>## registerDoMC(2)</span>

<span class='co'>## NOTE: don't run models form RWeka when using</span>
<span class='co'>### multicore. The session will crash.</span>

<span class='co'>## The code for train() does not change:</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>usingMC</span> <span class='kw'>&lt;-</span>  <span class='fu'>train</span>(<span class='no'>medv</span> ~ <span class='no'>.</span>,
                  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>BostonHousing</span>,
                  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"glmboost"</span>)

<span class='co'>## or use:</span>
<span class='co'>## library(doMPI) or</span>
<span class='co'>## library(doParallel) or</span>
<span class='co'>## library(doSMP) and so on</span>

}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Max Kuhn (the guts of <code>train.formula</code> were based
 on Ripley's <code>nnet.formula</code>)</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Max Kuhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


