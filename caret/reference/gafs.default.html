<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Genetic algorithm feature selection — gafs.default • caret</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Genetic algorithm feature selection — gafs.default" />
<meta property="og:description" content="Supervised feature selection using genetic algorithms" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caret</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">6.0.84</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/caret.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/topepo/caret">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Genetic algorithm feature selection</h1>
    <small class="dont-index">Source: <a href='https://github.com/topepo/caret/blob/master/R/gafs.R'><code>R/gafs.R</code></a></small>
    <div class="hidden name"><code>gafs.default.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Supervised feature selection using genetic algorithms</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for default</span>
<span class='fu'>gafs</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>iters</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>popSize</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>pcrossover</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>pmutation</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>elite</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>suggestions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>differences</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>gafsControl</span> <span class='kw'>=</span> <span class='fu'><a href='safsControl.html'>gafsControl</a></span>(), <span class='no'>...</span>)

<span class='co'># S3 method for recipe</span>
<span class='fu'>gafs</span>(<span class='no'>x</span>, <span class='no'>data</span>, <span class='kw'>iters</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>popSize</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>pcrossover</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>pmutation</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>elite</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>suggestions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>differences</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>gafsControl</span> <span class='kw'>=</span> <span class='fu'><a href='safsControl.html'>gafsControl</a></span>(), <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object where samples are in rows and features are in columns.
This could be a simple matrix, data frame or other type (e.g. sparse
matrix). For the recipes method, <code>x</code> is a recipe object. See Details below</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a numeric or factor vector containing the outcome for each sample</p></td>
    </tr>
    <tr>
      <th>iters</th>
      <td><p>number of search iterations</p></td>
    </tr>
    <tr>
      <th>popSize</th>
      <td><p>number of subsets evaluated at each iteration</p></td>
    </tr>
    <tr>
      <th>pcrossover</th>
      <td><p>the crossover probability</p></td>
    </tr>
    <tr>
      <th>pmutation</th>
      <td><p>the mutation probability</p></td>
    </tr>
    <tr>
      <th>elite</th>
      <td><p>the number of best subsets to survive at each generation</p></td>
    </tr>
    <tr>
      <th>suggestions</th>
      <td><p>a binary matrix of subsets strings to be included in the
initial population. If provided the number of columns must match the number
of columns in <code>x</code></p></td>
    </tr>
    <tr>
      <th>differences</th>
      <td><p>a logical: should the difference in fitness values with
and without each predictor be calculated?</p></td>
    </tr>
    <tr>
      <th>gafsControl</th>
      <td><p>a list of values that define how this function acts. See
<code><a href='safsControl.html'>gafsControl</a></code> and URL.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to other methods</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame from which variables specified in
<code>formula</code> or <code>recipe</code> are preferentially to be taken.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>gafs</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>gafs</code> conducts a supervised binary search of the predictor
space using a genetic algorithm. See Mitchell (1996) and Scrucca (2013) for
more details on genetic algorithms.</p>
<p>This function conducts the search of the feature space repeatedly within
resampling iterations. First, the training data are split be whatever
resampling method was specified in the control function. For example, if
10-fold cross-validation is selected, the entire genetic algorithm is
conducted 10 separate times. For the first fold, nine tenths of the data are
used in the search while the remaining tenth is used to estimate the
external performance since these data points were not used in the search.</p>
<p>During the genetic algorithm, a measure of fitness is needed to guide the
search. This is the internal measure of performance. During the search, the
data that are available are the instances selected by the top-level
resampling (e.g. the nine tenths mentioned above). A common approach is to
conduct another resampling procedure. Another option is to use a holdout set
of samples to determine the internal estimate of performance (see the
holdout argument of the control function). While this is faster, it is more
likely to cause overfitting of the features and should only be used when a
large amount of training data are available. Yet another idea is to use a
penalized metric (such as the AIC statistic) but this may not exist for some
metrics (e.g. the area under the ROC curve).</p>
<p>The internal estimates of performance will eventually overfit the subsets to
the data. However, since the external estimate is not used by the search, it
is able to make better assessments of overfitting. After resampling, this
function determines the optimal number of generations for the GA.</p>
<p>Finally, the entire data set is used in the last execution of the genetic
algorithm search and the final model is built on the predictor subset that
is associated with the optimal number of generations determined by
resampling (although the update function can be used to manually set the
number of generations).</p>
<p>This is an example of the output produced when <code><a href='safsControl.html'>gafsControl(verbose =
TRUE)</a></code> is used:</p>
<pre>
Fold2 1 0.715 (13)
Fold2 2 0.715-&gt;0.737 (13-&gt;17, 30.4%) *
Fold2 3 0.737-&gt;0.732 (17-&gt;14, 24.0%)
Fold2 4 0.737-&gt;0.769 (17-&gt;23, 25.0%) *
</pre>

<p>For the second resample (e.g. fold 2), the best subset across all
individuals tested in the first generation contained 13 predictors and was
associated with a fitness value of 0.715. The second generation produced a
better subset containing 17 samples with an associated fitness values of
0.737 (and improvement is symbolized by the <code>*</code>. The percentage listed
is the Jaccard similarity between the previous best individual (with 13
predictors) and the new best. The third generation did not produce a better
fitness value but the fourth generation did.</p>
<p>The search algorithm can be parallelized in several places:</p><ol>
<li><p>each externally resampled GA can be run independently (controlled by
the <code>allowParallel</code> option of <code><a href='safsControl.html'>gafsControl</a></code>)</p></li>
<li><p>within a
GA, the fitness calculations at a particular generation can be run in
parallel over the current set of individuals (see the <code>genParallel</code>
option in <code><a href='safsControl.html'>gafsControl</a></code>)</p></li>
<li><p>if inner resampling is used,
these can be run in parallel (controls depend on the function used. See, for
example, <code><a href='trainControl.html'>trainControl</a></code>)</p></li>
<li><p>any parallelization of the
individual model fits. This is also specific to the modeling function.</p></li>
</ol>

<p>It is probably best to pick one of these areas for parallelization and the
first is likely to produces the largest decrease in run-time since it is the
least likely to incur multiple re-starting of the worker processes. Keep in
mind that if multiple levels of parallelization occur, this can effect the
number of workers and the amount of memory required exponentially.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kuhn M and Johnson K (2013), Applied Predictive Modeling,
Springer, Chapter 19 <a href='http://appliedpredictivemodeling.com'>http://appliedpredictivemodeling.com</a></p>
<p>Scrucca L (2013). GA: A Package for Genetic Algorithms in R. Journal of
Statistical Software, 53(4), 1-37. <a href='www.jstatsoft.org/v53/i04'>www.jstatsoft.org/v53/i04</a></p>
<p>Mitchell M (1996), An Introduction to Genetic Algorithms, MIT Press.</p>
<p><a href='http://en.wikipedia.org/wiki/Jaccard_index'>http://en.wikipedia.org/wiki/Jaccard_index</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='safsControl.html'>gafsControl</a></code>, <code><a href='predict.gafs.html'>predict.gafs</a></code>,
<code><a href='gafs_initial.html'>caretGA</a></code>, <code><a href='gafs_initial.html'>rfGA</a></code> <code><a href='gafs_initial.html'>treebagGA</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>train_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='twoClassSim.html'>twoClassSim</a></span>(<span class='fl'>100</span>, <span class='kw'>noiseVars</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>test_data</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='twoClassSim.html'>twoClassSim</a></span>(<span class='fl'>10</span>,  <span class='kw'>noiseVars</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'>## A short example</span>
<span class='no'>ctrl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='safsControl.html'>gafsControl</a></span>(<span class='kw'>functions</span> <span class='kw'>=</span> <span class='no'>rfGA</span>,
                    <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"cv"</span>,
                    <span class='kw'>number</span> <span class='kw'>=</span> <span class='fl'>3</span>)

<span class='no'>rf_search</span> <span class='kw'>&lt;-</span> <span class='fu'>gafs</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>train_data</span>[, -<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>train_data</span>)],
                  <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>train_data</span>$<span class='no'>Class</span>,
                  <span class='kw'>iters</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                  <span class='kw'>gafsControl</span> <span class='kw'>=</span> <span class='no'>ctrl</span>)

<span class='no'>rf_search</span>
  }</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Max Kuhn, Luca Scrucca (for GA internals)</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Max Kuhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


