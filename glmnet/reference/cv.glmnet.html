<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross-validation for glmnet — cv.glmnet • glmnet</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cross-validation for glmnet — cv.glmnet" />
<meta property="og:description" content="Does k-fold cross-validation for glmnet, produces a plot, and returns a
value for lambda (and gamma if relax=TRUE)" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/glmnet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Coxnet.html">Coxnet: Regularized Cox Regression</a>
    </li>
    <li>
      <a href="../articles/relax.html">Relaxed fits and other additions in `glmnet` 3.0</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-validation for glmnet</h1>
    
    <div class="hidden name"><code>cv.glmnet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Does k-fold cross-validation for glmnet, produces a plot, and returns a
value for <code>lambda</code> (and <code>gamma</code> if <code>relax=TRUE</code>)</p>
    </div>

    <pre class="usage"><span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>type.measure</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"default"</span>, <span class='st'>"mse"</span>, <span class='st'>"deviance"</span>, <span class='st'>"class"</span>, <span class='st'>"auc"</span>, <span class='st'>"mae"</span>,
  <span class='st'>"C"</span>), <span class='kw'>nfolds</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>foldid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alignment</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"lambda"</span>,
  <span class='st'>"fraction"</span>), <span class='kw'>grouped</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>gamma</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.25</span>, <span class='fl'>0.5</span>, <span class='fl'>0.75</span>, <span class='fl'>1</span>), <span class='kw'>relax</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>trace.it</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>x</code> matrix as in <code>glmnet</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response <code>y</code> as in <code>glmnet</code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Observation weights; defaults to 1 per observation</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Offset vector (matrix) as in <code>glmnet</code></p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Optional user-supplied lambda sequence; default is
<code>NULL</code>, and <code>glmnet</code> chooses its own sequence</p></td>
    </tr>
    <tr>
      <th>type.measure</th>
      <td><p>loss to use for cross-validation. Currently five
options, not all available for all models. The default is
<code>type.measure="deviance"</code>, which uses squared-error for gaussian models
(a.k.a <code>type.measure="mse"</code> there), deviance for logistic and poisson
regression, and partial-likelihood for the Cox model.
<code>type.measure="class"</code> applies to binomial and multinomial logistic
regression only, and gives misclassification error.
<code>type.measure="auc"</code> is for two-class logistic regression only, and
gives area under the ROC curve. <code>type.measure="mse"</code> or
<code>type.measure="mae"</code> (mean absolute error) can be used by all models
except the <code>"cox"</code>; they measure the deviation from the fitted mean to
the response.
<code>type.measure="C"</code> is Harrel's concordance measure, only available for <code>cox</code> models.</p></td>
    </tr>
    <tr>
      <th>nfolds</th>
      <td><p>number of folds - default is 10. Although <code>nfolds</code> can be
as large as the sample size (leave-one-out CV), it is not recommended for
large datasets. Smallest value allowable is <code>nfolds=3</code></p></td>
    </tr>
    <tr>
      <th>foldid</th>
      <td><p>an optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in. If supplied, <code>nfold</code> can
be missing.</p></td>
    </tr>
    <tr>
      <th>alignment</th>
      <td><p>This is an experimental argument, designed to fix the
problems users were having with CV, with possible values <code>"lambda"</code>
(the default) else <code>"fraction"</code>. With <code>"lambda"</code> the <code>lambda</code>
values from the master fit (on all the data) are used to line up the
predictions from each of the folds. In some cases this can give strange
values, since the effective <code>lambda</code> values in each fold could be quite
different. With <code>"fraction"</code> we line up the predictions in each fold
according to the fraction of progress along the regularization. If in the
call a <code>lambda</code> argument is also provided, <code>alignment="fraction"</code>
is ignored (with a warning).</p></td>
    </tr>
    <tr>
      <th>grouped</th>
      <td><p>This is an experimental argument, with default <code>TRUE</code>,
and can be ignored by most users. For all models except the <code>"cox"</code>,
this refers to computing <code>nfolds</code> separate statistics, and then using
their mean and estimated standard error to describe the CV curve. If
<code>grouped=FALSE</code>, an error matrix is built up at the observation level
from the predictions from the <code>nfold</code> fits, and then summarized (does
not apply to <code>type.measure="auc"</code>). For the <code>"cox"</code> family,
<code>grouped=TRUE</code> obtains the CV partial likelihood for the Kth fold by
<em>subtraction</em>; by subtracting the log partial likelihood evaluated on
the full dataset from that evaluated on the on the (K-1)/K dataset. This
makes more efficient use of risk sets. With <code>grouped=FALSE</code> the log
partial likelihood is computed only on the Kth fold</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>If <code>keep=TRUE</code>, a <em>prevalidated</em> array is returned
containing fitted values for each observation and each value of
<code>lambda</code>. This means these fits are computed with this observation and
the rest of its fold omitted. The <code>folid</code> vector is also returned.
Default is keep=FALSE.  If <code>relax=TRUE</code>, then a list of such arrays is
returned, one for each value of 'gamma'. Note: if the value 'gamma=1' is
omitted, this case is included in the list since it corresponds to the
original 'glmnet' fit.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>If <code>TRUE</code>, use parallel <code>foreach</code> to fit each
fold.  Must register parallel before hand, such as <code>doMC</code> or others.
See the example below.</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>The values of the parameter for mixing the relaxed fit with the
regularized fit, between 0 and 1; default is <code>gamma = c(0, 0.25, 0.5,
0.75, 1)</code></p></td>
    </tr>
    <tr>
      <th>relax</th>
      <td><p>If <code>TRUE</code>, then CV is done with respect to the mixing
parameter <code>gamma</code> as well as <code>lambda</code>. Default is
<code>relax=FALSE</code></p></td>
    </tr>
    <tr>
      <th>trace.it</th>
      <td><p>If <code>trace.it=1</code>, then progress bars are displayed;
useful for big models that take a long time to fit. Limited tracing if
<code>parallel=TRUE</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments that can be passed to <code>glmnet</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>"cv.glmnet"</code> is returned, which is a list
with the ingredients of the cross-validation fit.  If the object was created
with <code>relax=TRUE</code> then this class has a prefix class of
<code>"cv.relaxed"</code>.</p>
<dt>lambda</dt><dd><p>the values of <code>lambda</code> used in the
fits.</p></dd> <dt>cvm</dt><dd><p>The mean cross-validated error - a vector of length
<code><a href='https://rdrr.io/r/base/length.html'>length(lambda)</a></code>.</p></dd> <dt>cvsd</dt><dd><p>estimate of standard error of
<code>cvm</code>.</p></dd> <dt>cvup</dt><dd><p>upper curve = <code>cvm+cvsd</code>.</p></dd> <dt>cvlo</dt><dd><p>lower
curve = <code>cvm-cvsd</code>.</p></dd> <dt>nzero</dt><dd><p>number of non-zero coefficients at
each <code>lambda</code>.</p></dd> <dt>name</dt><dd><p>a text string indicating type of measure
(for plotting purposes).</p></dd> <dt>glmnet.fit</dt><dd><p>a fitted glmnet object for the
full data.</p></dd> <dt>lambda.min</dt><dd><p>value of <code>lambda</code> that gives minimum
<code>cvm</code>.</p></dd> <dt>lambda.1se</dt><dd><p>largest value of <code>lambda</code> such that
error is within 1 standard error of the minimum.</p></dd> <dt>fit.preval</dt><dd><p>if
<code>keep=TRUE</code>, this is the array of prevalidated fits. Some entries can
be <code>NA</code>, if that and subsequent values of <code>lambda</code> are not reached
for that fold</p></dd> <dt>foldid</dt><dd><p>if <code>keep=TRUE</code>, the fold assignments used</p></dd>
<dt>relaxed</dt><dd><p>if <code>relax=TRUE</code>, this additional item has the CV info
for each of the mixed fits. In particular it also selects <code>lambda,
gamma</code> pairs corresponding to the 1SE rule, as well as the minimum error.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function runs <code>glmnet</code> <code>nfolds</code>+1 times; the first to get the
<code>lambda</code> sequence, and then the remainder to compute the fit with each
of the folds omitted. The error is accumulated, and the average error and
standard deviation over the folds is computed.  Note that <code>cv.glmnet</code>
does NOT search for values for <code>alpha</code>. A specific value should be
supplied, else <code>alpha=1</code> is assumed by default. If users would like to
cross-validate <code>alpha</code> as well, they should call <code>cv.glmnet</code> with
a pre-computed vector <code>foldid</code>, and then use this same fold vector in
separate calls to <code>cv.glmnet</code> with different values of <code>alpha</code>.
Note also that the results of <code>cv.glmnet</code> are random, since the folds
are selected at random. Users can reduce this randomness by running
<code>cv.glmnet</code> many times, and averaging the error curves.</p>
<p>If <code>relax=TRUE</code> then the values of <code>gamma</code> are used to mix the
fits. If \(\eta\) is the fit for lasso/elastic net, and \(\eta_R\) is
the relaxed fit (with unpenalized coefficients), then a relaxed fit mixed by
\(\gamma\) is $$\eta(\gamma)=(1-\gamma)\eta_R+\gamma\eta$$. There is
practically no extra cost for having a lot of values for <code>gamma</code>.
However, 5 seems sufficient for most purposes. CV then selects both
<code>gamma</code> and <code>lambda</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Friedman, J., Hastie, T. and Tibshirani, R. (2008)
<em>Regularization Paths for Generalized Linear Models via Coordinate
Descent</em>, <a href='https://web.stanford.edu/~hastie/Papers/glmnet.pdf'>https://web.stanford.edu/~hastie/Papers/glmnet.pdf</a><br />
<em>Journal of Statistical Software, Vol. 33(1), 1-22 Feb 2010</em><br />
<a href='https://www.jstatsoft.org/v33/i01/'>https://www.jstatsoft.org/v33/i01/</a><br /> Simon, N., Friedman, J., Hastie,
T., Tibshirani, R. (2011) <em>Regularization Paths for Cox's Proportional
Hazards Model via Coordinate Descent, Journal of Statistical Software, Vol.
39(5) 1-13</em><br /> <a href='https://www.jstatsoft.org/v39/i05/'>https://www.jstatsoft.org/v39/i05/</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>glmnet</code> and <code>plot</code>, <code>predict</code>, and <code>coef</code>
methods for <code>"cv.glmnet"</code> and <code>"cv.relaxed"</code> objects.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1010</span>)
<span class='no'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>
<span class='no'>p</span> <span class='kw'>=</span> <span class='fl'>100</span>
<span class='no'>nzc</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>trunc</a></span>(<span class='no'>p</span>/<span class='fl'>10</span>)
<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span> * <span class='no'>p</span>), <span class='no'>n</span>, <span class='no'>p</span>)
<span class='no'>beta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>nzc</span>)
<span class='no'>fx</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>nzc</span>)] <span class='kw'>%*%</span> <span class='no'>beta</span>
<span class='no'>eps</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>) * <span class='fl'>5</span>
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/drop.html'>drop</a></span>(<span class='no'>fx</span> + <span class='no'>eps</span>)
<span class='no'>px</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>fx</span>)
<span class='no'>px</span> <span class='kw'>=</span> <span class='no'>px</span>/(<span class='fl'>1</span> + <span class='no'>px</span>)
<span class='no'>ly</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>px</span>), <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>px</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1011</span>)
<span class='no'>cvob1</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob1</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>cvob1</span>)</div><div class='output co'>#&gt; 101 x 1 sparse Matrix of class "dgCMatrix"
#&gt;                      1
#&gt; (Intercept) -0.1162737
#&gt; V1          -0.2171531
#&gt; V2           0.3237422
#&gt; V3           .        
#&gt; V4          -0.2190339
#&gt; V5          -0.1856601
#&gt; V6           0.2530652
#&gt; V7           0.1874832
#&gt; V8          -1.3574323
#&gt; V9           1.0162046
#&gt; V10          0.1558299
#&gt; V11          .        
#&gt; V12          .        
#&gt; V13          .        
#&gt; V14          .        
#&gt; V15          .        
#&gt; V16          .        
#&gt; V17          .        
#&gt; V18          .        
#&gt; V19          .        
#&gt; V20          .        
#&gt; V21          .        
#&gt; V22          .        
#&gt; V23          .        
#&gt; V24          .        
#&gt; V25          .        
#&gt; V26          .        
#&gt; V27          .        
#&gt; V28          .        
#&gt; V29          .        
#&gt; V30          .        
#&gt; V31          .        
#&gt; V32          .        
#&gt; V33          .        
#&gt; V34          .        
#&gt; V35          .        
#&gt; V36          .        
#&gt; V37          .        
#&gt; V38          .        
#&gt; V39          .        
#&gt; V40          .        
#&gt; V41          .        
#&gt; V42          .        
#&gt; V43          .        
#&gt; V44          .        
#&gt; V45          .        
#&gt; V46          .        
#&gt; V47          .        
#&gt; V48          .        
#&gt; V49          .        
#&gt; V50          .        
#&gt; V51          .        
#&gt; V52          .        
#&gt; V53          .        
#&gt; V54          .        
#&gt; V55          .        
#&gt; V56          .        
#&gt; V57          .        
#&gt; V58          .        
#&gt; V59          .        
#&gt; V60          .        
#&gt; V61          .        
#&gt; V62          .        
#&gt; V63          .        
#&gt; V64          .        
#&gt; V65          .        
#&gt; V66          .        
#&gt; V67          .        
#&gt; V68          .        
#&gt; V69          .        
#&gt; V70          .        
#&gt; V71          .        
#&gt; V72          .        
#&gt; V73          .        
#&gt; V74          .        
#&gt; V75         -0.1420966
#&gt; V76          .        
#&gt; V77          .        
#&gt; V78          .        
#&gt; V79          .        
#&gt; V80          .        
#&gt; V81          .        
#&gt; V82          .        
#&gt; V83          .        
#&gt; V84          .        
#&gt; V85          .        
#&gt; V86          .        
#&gt; V87          .        
#&gt; V88          .        
#&gt; V89          .        
#&gt; V90          .        
#&gt; V91          .        
#&gt; V92          .        
#&gt; V93          .        
#&gt; V94          .        
#&gt; V95          .        
#&gt; V96          .        
#&gt; V97          .        
#&gt; V98          .        
#&gt; V99          .        
#&gt; V100         .        </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvob1</span>, <span class='kw'>newx</span> <span class='kw'>=</span> <span class='no'>x</span>[<span class='fl'>1</span>:<span class='fl'>5</span>, ], <span class='kw'>s</span> <span class='kw'>=</span> <span class='st'>"lambda.min"</span>)</div><div class='output co'>#&gt;               1
#&gt; [1,] -1.3447658
#&gt; [2,]  0.9443441
#&gt; [3,]  0.6989746
#&gt; [4,]  1.8698290
#&gt; [5,] -4.7372693</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Gaussian Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)</div><div class='img'><img src='cv.glmnet-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1011</span>)
<span class='no'>cvob1a</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>type.measure</span> <span class='kw'>=</span> <span class='st'>"mae"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob1a</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Gaussian Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)</div><div class='img'><img src='cv.glmnet-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1011</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>mar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4.5</span>, <span class='fl'>4.5</span>, <span class='fl'>4</span>, <span class='fl'>1</span>))
<span class='no'>cvob2</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>ly</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Binomial Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/frame.html'>frame</a></span>()
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1011</span>)
<span class='no'>cvob3</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>ly</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>, <span class='kw'>type.measure</span> <span class='kw'>=</span> <span class='st'>"class"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob3</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Binomial Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>cvob1r</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>relax</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob1r</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>cvob1r</span>, <span class='kw'>newx</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fl'>1</span>:<span class='fl'>5</span>])
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1011</span>)
<span class='no'>cvob3a</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>ly</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>, <span class='kw'>type.measure</span> <span class='kw'>=</span> <span class='st'>"auc"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob3a</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Binomial Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1011</span>)
<span class='no'>mu</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>fx</span>/<span class='fl'>10</span>)
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span>(<span class='no'>n</span>, <span class='no'>mu</span>)
<span class='no'>cvob4</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"poisson"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvob4</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Poisson Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)

<span class='co'># Multinomial</span>
<span class='no'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>
<span class='no'>p</span> <span class='kw'>=</span> <span class='fl'>30</span>
<span class='no'>nzc</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>trunc</a></span>(<span class='no'>p</span>/<span class='fl'>10</span>)
<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span> * <span class='no'>p</span>), <span class='no'>n</span>, <span class='no'>p</span>)
<span class='no'>beta3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>30</span>), <span class='fl'>10</span>, <span class='fl'>3</span>)
<span class='no'>beta3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>beta3</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>, <span class='no'>p</span> - <span class='fl'>10</span>, <span class='fl'>3</span>))
<span class='no'>f3</span> <span class='kw'>=</span> <span class='no'>x</span> <span class='kw'>%*%</span> <span class='no'>beta3</span>
<span class='no'>p3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>f3</span>)
<span class='no'>p3</span> <span class='kw'>=</span> <span class='no'>p3</span>/<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>p3</span>, <span class='fl'>1</span>, <span class='no'>sum</span>)
<span class='no'>g3</span> <span class='kw'>=</span> <span class='kw pkg'>glmnet</span><span class='kw ns'>:::</span><span class='fu'><a href='https://rdrr.io/pkg/glmnet/man/rmult.html'>rmult</a></span>(<span class='no'>p3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>10101</span>)
<span class='no'>cvfit</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>g3</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"multinomial"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cvfit</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Multinomial Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)
<span class='co'># Cox</span>
<span class='no'>beta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>nzc</span>)
<span class='no'>fx</span> <span class='kw'>=</span> <span class='no'>x</span>[, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='no'>nzc</span>)] <span class='kw'>%*%</span> <span class='no'>beta</span>/<span class='fl'>3</span>
<span class='no'>hx</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>fx</span>)
<span class='no'>ty</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Exponential.html'>rexp</a></span>(<span class='no'>n</span>, <span class='no'>hx</span>)
<span class='no'>tcens</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>)  <span class='co'># censoring indicator</span>
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>ty</span>, <span class='kw'>status</span> <span class='kw'>=</span> <span class='fl'>1</span> - <span class='no'>tcens</span>)  <span class='co'># y=Surv(ty,1-tcens) with library(survival)</span>
<span class='no'>foldid</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>10</span>), <span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n</span>))
<span class='no'>fit1_cv</span> <span class='kw'>=</span> <span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"cox"</span>, <span class='kw'>foldid</span> <span class='kw'>=</span> <span class='no'>foldid</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>fit1_cv</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span>(<span class='st'>"Cox Family"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fl'>2.5</span>)
<span class='co'># Parallel</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>doMC</span>)
<span class='fu'>registerDoMC</span>(<span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e+05</span> * <span class='fl'>100</span>), <span class='fl'>1e+05</span>, <span class='fl'>100</span>)
<span class='no'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1e+05</span>)
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>))
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='fu'>cv.glmnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
}</div><div class='img'><img src='cv.glmnet-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jerome Friedman, Trevor Hastie and Rob Tibshirani<br /> Noah Simon
helped develop the 'coxnet' function.<br /> Jeffrey Wong and B. Narasimhan
helped with the parallel option<br /> Maintainer: Trevor Hastie
<a href='mailto:hastie@stanford.edu'>hastie@stanford.edu</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jerome Friedman, Trevor Hastie, Rob Tibshirani, Balasubramanian Narasimhan, Noah Simon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


