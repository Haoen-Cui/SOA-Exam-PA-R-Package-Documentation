<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Frequency Table from a Copenhagen Housing Conditions Survey — housing • MASS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Frequency Table from a Copenhagen Housing Conditions Survey — housing" />
<meta property="og:description" content="The housing data frame has 72 rows and 5 variables." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MASS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">7.3.51.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Frequency Table from a Copenhagen Housing Conditions Survey</h1>
    
    <div class="hidden name"><code>housing.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>housing</code> data frame has 72 rows and 5 variables.</p>
    </div>

    <pre class="usage"><span class='no'>housing</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p></p><dl class='dl-horizontal'>
    <dt><code>Sat</code></dt><dd><p>Satisfaction of householders with their present housing
      circumstances, (High, Medium or Low, ordered factor).</p></dd>
    <dt><code>Infl</code></dt><dd><p>Perceived degree of influence householders have on the
      management of the property (High, Medium, Low).</p></dd>
    <dt><code>Type</code></dt><dd><p>Type of rental accommodation, (Tower, Atrium, Apartment, Terrace).</p></dd>
    <dt><code>Cont</code></dt><dd><p>Contact residents are afforded with other residents, (Low, High).</p></dd>
    <dt><code>Freq</code></dt><dd><p>Frequencies: the numbers of residents in each class.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Madsen, M. (1976)
  Statistical analysis of multiple contingency tables. Two examples.
  <em>Scand. J. Statist.</em> <b>3</b>, 97--106.</p>
<p>Cox, D. R. and Snell, E. J. (1984)
  <em>Applied Statistics, Principles and Examples</em>.
  Chapman &amp; Hall.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Venables, W. N. and Ripley, B. D. (2002)
  <em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"contr.treatment"</span>, <span class='st'>"contr.poly"</span>))

<span class='co'># Surrogate Poisson models</span>
<span class='no'>house.glm0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>Freq</span> ~ <span class='no'>Infl</span>*<span class='no'>Type</span>*<span class='no'>Cont</span> + <span class='no'>Sat</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>poisson</span>,
                  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>housing</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>house.glm0</span>, <span class='kw'>cor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glm(formula = Freq ~ Infl * Type * Cont + Sat, family = poisson, 
#&gt;     data = housing)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -4.5551  -1.0612  -0.0593   0.6483   4.1478  
#&gt; 
#&gt; Coefficients:
#&gt;                                     Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)                        3.136e+00  1.196e-01  26.225  &lt; 2e-16 ***
#&gt; InflMedium                         2.733e-01  1.586e-01   1.723 0.084868 .  
#&gt; InflHigh                          -2.054e-01  1.784e-01  -1.152 0.249511    
#&gt; TypeApartment                      3.666e-01  1.555e-01   2.357 0.018403 *  
#&gt; TypeAtrium                        -7.828e-01  2.134e-01  -3.668 0.000244 ***
#&gt; TypeTerrace                       -8.145e-01  2.157e-01  -3.775 0.000160 ***
#&gt; ContHigh                          -1.490e-15  1.690e-01   0.000 1.000000    
#&gt; Sat.L                              1.159e-01  4.038e-02   2.871 0.004094 ** 
#&gt; Sat.Q                              2.629e-01  4.515e-02   5.824 5.76e-09 ***
#&gt; InflMedium:TypeApartment          -1.177e-01  2.086e-01  -0.564 0.572571    
#&gt; InflHigh:TypeApartment             1.753e-01  2.279e-01   0.769 0.441783    
#&gt; InflMedium:TypeAtrium             -4.068e-01  3.035e-01  -1.340 0.180118    
#&gt; InflHigh:TypeAtrium               -1.692e-01  3.294e-01  -0.514 0.607433    
#&gt; InflMedium:TypeTerrace             6.292e-03  2.860e-01   0.022 0.982450    
#&gt; InflHigh:TypeTerrace              -9.305e-02  3.280e-01  -0.284 0.776633    
#&gt; InflMedium:ContHigh               -1.398e-01  2.279e-01  -0.613 0.539715    
#&gt; InflHigh:ContHigh                 -6.091e-01  2.800e-01  -2.176 0.029585 *  
#&gt; TypeApartment:ContHigh             5.029e-01  2.109e-01   2.385 0.017083 *  
#&gt; TypeAtrium:ContHigh                6.774e-01  2.751e-01   2.462 0.013811 *  
#&gt; TypeTerrace:ContHigh               1.099e+00  2.675e-01   4.106 4.02e-05 ***
#&gt; InflMedium:TypeApartment:ContHigh  5.359e-02  2.862e-01   0.187 0.851450    
#&gt; InflHigh:TypeApartment:ContHigh    1.462e-01  3.380e-01   0.432 0.665390    
#&gt; InflMedium:TypeAtrium:ContHigh     1.555e-01  3.907e-01   0.398 0.690597    
#&gt; InflHigh:TypeAtrium:ContHigh       4.782e-01  4.441e-01   1.077 0.281619    
#&gt; InflMedium:TypeTerrace:ContHigh   -4.980e-01  3.671e-01  -1.357 0.174827    
#&gt; InflHigh:TypeTerrace:ContHigh     -4.470e-01  4.545e-01  -0.984 0.325326    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; (Dispersion parameter for poisson family taken to be 1)
#&gt; 
#&gt;     Null deviance: 833.66  on 71  degrees of freedom
#&gt; Residual deviance: 217.46  on 46  degrees of freedom
#&gt; AIC: 610.43
#&gt; 
#&gt; Number of Fisher Scoring iterations: 5
#&gt; </div><div class='input'>
<span class='fu'><a href='addterm.html'>addterm</a></span>(<span class='no'>house.glm0</span>, ~<span class='no'>.</span> + <span class='no'>Sat</span>:(<span class='no'>Infl</span>+<span class='no'>Type</span>+<span class='no'>Cont</span>), <span class='kw'>test</span> <span class='kw'>=</span> <span class='st'>"Chisq"</span>)</div><div class='output co'>#&gt; Single term additions
#&gt; 
#&gt; Model:
#&gt; Freq ~ Infl * Type * Cont + Sat
#&gt;          Df Deviance    AIC     LRT   Pr(Chi)    
#&gt; &lt;none&gt;        217.46 610.43                      
#&gt; Infl:Sat  4   111.08 512.05 106.371 &lt; 2.2e-16 ***
#&gt; Type:Sat  6   156.79 561.76  60.669 3.292e-11 ***
#&gt; Cont:Sat  2   212.33 609.30   5.126   0.07708 .  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='no'>house.glm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>house.glm0</span>, <span class='no'>.</span> ~ <span class='no'>.</span> + <span class='no'>Sat</span>*(<span class='no'>Infl</span>+<span class='no'>Type</span>+<span class='no'>Cont</span>))
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>house.glm1</span>, <span class='kw'>cor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glm(formula = Freq ~ Infl + Type + Cont + Sat + Infl:Type + Infl:Cont + 
#&gt;     Type:Cont + Infl:Sat + Type:Sat + Cont:Sat + Infl:Type:Cont, 
#&gt;     family = poisson, data = housing)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -1.6022  -0.5282  -0.0641   0.5757   1.9322  
#&gt; 
#&gt; Coefficients:
#&gt;                                    Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)                        3.135074   0.120112  26.101  &lt; 2e-16 ***
#&gt; InflMedium                         0.248327   0.159979   1.552 0.120602    
#&gt; InflHigh                          -0.412645   0.184947  -2.231 0.025671 *  
#&gt; TypeApartment                      0.292524   0.157477   1.858 0.063231 .  
#&gt; TypeAtrium                        -0.792847   0.214413  -3.698 0.000218 ***
#&gt; TypeTerrace                       -1.018074   0.221263  -4.601 4.20e-06 ***
#&gt; ContHigh                          -0.001407   0.169711  -0.008 0.993385    
#&gt; Sat.L                             -0.098106   0.112592  -0.871 0.383570    
#&gt; Sat.Q                              0.285657   0.122283   2.336 0.019489 *  
#&gt; InflMedium:TypeApartment          -0.017882   0.210496  -0.085 0.932302    
#&gt; InflHigh:TypeApartment             0.386869   0.233297   1.658 0.097263 .  
#&gt; InflMedium:TypeAtrium             -0.360311   0.304979  -1.181 0.237432    
#&gt; InflHigh:TypeAtrium               -0.036788   0.334793  -0.110 0.912503    
#&gt; InflMedium:TypeTerrace             0.185154   0.288892   0.641 0.521580    
#&gt; InflHigh:TypeTerrace               0.310749   0.334815   0.928 0.353345    
#&gt; InflMedium:ContHigh               -0.200060   0.228748  -0.875 0.381799    
#&gt; InflHigh:ContHigh                 -0.725790   0.282352  -2.571 0.010155 *  
#&gt; TypeApartment:ContHigh             0.569691   0.212152   2.685 0.007247 ** 
#&gt; TypeAtrium:ContHigh                0.702115   0.276056   2.543 0.010979 *  
#&gt; TypeTerrace:ContHigh               1.215930   0.269968   4.504 6.67e-06 ***
#&gt; InflMedium:Sat.L                   0.519627   0.096830   5.366 8.03e-08 ***
#&gt; InflHigh:Sat.L                     1.140302   0.118180   9.649  &lt; 2e-16 ***
#&gt; InflMedium:Sat.Q                  -0.064474   0.102666  -0.628 0.530004    
#&gt; InflHigh:Sat.Q                     0.115436   0.127798   0.903 0.366380    
#&gt; TypeApartment:Sat.L               -0.520170   0.109793  -4.738 2.16e-06 ***
#&gt; TypeAtrium:Sat.L                  -0.288484   0.149551  -1.929 0.053730 .  
#&gt; TypeTerrace:Sat.L                 -0.998666   0.141527  -7.056 1.71e-12 ***
#&gt; TypeApartment:Sat.Q                0.055418   0.118515   0.468 0.640068    
#&gt; TypeAtrium:Sat.Q                  -0.273820   0.149713  -1.829 0.067405 .  
#&gt; TypeTerrace:Sat.Q                 -0.032328   0.149251  -0.217 0.828520    
#&gt; ContHigh:Sat.L                     0.340703   0.087778   3.881 0.000104 ***
#&gt; ContHigh:Sat.Q                    -0.097929   0.094068  -1.041 0.297851    
#&gt; InflMedium:TypeApartment:ContHigh  0.046900   0.286212   0.164 0.869837    
#&gt; InflHigh:TypeApartment:ContHigh    0.126229   0.338208   0.373 0.708979    
#&gt; InflMedium:TypeAtrium:ContHigh     0.157239   0.390719   0.402 0.687364    
#&gt; InflHigh:TypeAtrium:ContHigh       0.478611   0.444244   1.077 0.281320    
#&gt; InflMedium:TypeTerrace:ContHigh   -0.500162   0.367135  -1.362 0.173091    
#&gt; InflHigh:TypeTerrace:ContHigh     -0.463099   0.454713  -1.018 0.308467    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; (Dispersion parameter for poisson family taken to be 1)
#&gt; 
#&gt;     Null deviance: 833.657  on 71  degrees of freedom
#&gt; Residual deviance:  38.662  on 34  degrees of freedom
#&gt; AIC: 455.63
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4
#&gt; </div><div class='input'>
<span class='fl'>1</span> - <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span>(<span class='no'>house.glm1</span>), <span class='no'>house.glm1</span>$<span class='no'>df.residual</span>)</div><div class='output co'>#&gt; [1] 0.2671363</div><div class='input'>
<span class='fu'><a href='dropterm.html'>dropterm</a></span>(<span class='no'>house.glm1</span>, <span class='kw'>test</span> <span class='kw'>=</span> <span class='st'>"Chisq"</span>)</div><div class='output co'>#&gt; Single term deletions
#&gt; 
#&gt; Model:
#&gt; Freq ~ Infl + Type + Cont + Sat + Infl:Type + Infl:Cont + Type:Cont + 
#&gt;     Infl:Sat + Type:Sat + Cont:Sat + Infl:Type:Cont
#&gt;                Df Deviance    AIC     LRT   Pr(Chi)    
#&gt; &lt;none&gt;              38.662 455.63                      
#&gt; Infl:Sat        4  147.780 556.75 109.117 &lt; 2.2e-16 ***
#&gt; Type:Sat        6  100.889 505.86  62.227 1.586e-11 ***
#&gt; Cont:Sat        2   54.722 467.69  16.060 0.0003256 ***
#&gt; Infl:Type:Cont  6   43.952 448.92   5.290 0.5072454    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='fu'><a href='addterm.html'>addterm</a></span>(<span class='no'>house.glm1</span>, ~<span class='no'>.</span> + <span class='no'>Sat</span>:(<span class='no'>Infl</span>+<span class='no'>Type</span>+<span class='no'>Cont</span>)^<span class='fl'>2</span>, <span class='kw'>test</span>  <span class='kw'>=</span>  <span class='st'>"Chisq"</span>)</div><div class='output co'>#&gt; Single term additions
#&gt; 
#&gt; Model:
#&gt; Freq ~ Infl + Type + Cont + Sat + Infl:Type + Infl:Cont + Type:Cont + 
#&gt;     Infl:Sat + Type:Sat + Cont:Sat + Infl:Type:Cont
#&gt;               Df Deviance    AIC     LRT Pr(Chi)  
#&gt; &lt;none&gt;             38.662 455.63                  
#&gt; Infl:Type:Sat 12   16.107 457.08 22.5550 0.03175 *
#&gt; Infl:Cont:Sat  4   37.472 462.44  1.1901 0.87973  
#&gt; Type:Cont:Sat  6   28.256 457.23 10.4064 0.10855  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='no'>hnames</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>housing</span>[, -<span class='fl'>5</span>], <span class='no'>levels</span>) <span class='co'># omit Freq</span>
<span class='no'>newData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>hnames</span>)
<span class='no'>newData</span>$<span class='no'>Sat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span>(<span class='no'>newData</span>$<span class='no'>Sat</span>)
<span class='no'>house.pm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>house.glm1</span>, <span class='no'>newData</span>,
                    <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"response"</span>)  <span class='co'># poisson means</span>
<span class='no'>house.pm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>house.pm</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                   <span class='kw'>dimnames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>NULL</span>, <span class='no'>hnames</span><span class='kw'>[[</span><span class='fl'>1</span>]]))
<span class='no'>house.pr</span> <span class='kw'>&lt;-</span> <span class='no'>house.pm</span>/<span class='fu'><a href='https://rdrr.io/r/base/drop.html'>drop</a></span>(<span class='no'>house.pm</span> <span class='kw'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>3</span>))
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>hnames</span>[-<span class='fl'>1</span>]), <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>house.pr</span>, <span class='fl'>2</span>))</div><div class='output co'>#&gt;      Infl      Type Cont  Low Medium High
#&gt; 1     Low     Tower  Low 0.40   0.26 0.34
#&gt; 2  Medium     Tower  Low 0.26   0.27 0.47
#&gt; 3    High     Tower  Low 0.15   0.19 0.66
#&gt; 4     Low Apartment  Low 0.54   0.23 0.23
#&gt; 5  Medium Apartment  Low 0.39   0.26 0.34
#&gt; 6    High Apartment  Low 0.26   0.21 0.53
#&gt; 7     Low    Atrium  Low 0.43   0.32 0.25
#&gt; 8  Medium    Atrium  Low 0.30   0.35 0.36
#&gt; 9    High    Atrium  Low 0.19   0.27 0.54
#&gt; 10    Low   Terrace  Low 0.65   0.22 0.14
#&gt; 11 Medium   Terrace  Low 0.51   0.27 0.22
#&gt; 12   High   Terrace  Low 0.37   0.24 0.39
#&gt; 13    Low     Tower High 0.30   0.28 0.42
#&gt; 14 Medium     Tower High 0.18   0.27 0.54
#&gt; 15   High     Tower High 0.10   0.19 0.71
#&gt; 16    Low Apartment High 0.44   0.27 0.30
#&gt; 17 Medium Apartment High 0.30   0.28 0.42
#&gt; 18   High Apartment High 0.18   0.21 0.61
#&gt; 19    Low    Atrium High 0.33   0.36 0.31
#&gt; 20 Medium    Atrium High 0.22   0.36 0.42
#&gt; 21   High    Atrium High 0.13   0.27 0.60
#&gt; 22    Low   Terrace High 0.55   0.27 0.19
#&gt; 23 Medium   Terrace High 0.40   0.31 0.29
#&gt; 24   High   Terrace High 0.27   0.26 0.47</div><div class='input'>
<span class='co'># Iterative proportional scaling</span>
<span class='fu'><a href='loglm.html'>loglm</a></span>(<span class='no'>Freq</span> ~ <span class='no'>Infl</span>*<span class='no'>Type</span>*<span class='no'>Cont</span> + <span class='no'>Sat</span>*(<span class='no'>Infl</span>+<span class='no'>Type</span>+<span class='no'>Cont</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>housing</span>)</div><div class='output co'>#&gt; Call:
#&gt; loglm(formula = Freq ~ Infl * Type * Cont + Sat * (Infl + Type + 
#&gt;     Cont), data = housing)
#&gt; 
#&gt; Statistics:
#&gt;                       X^2 df  P(&gt; X^2)
#&gt; Likelihood Ratio 38.66222 34 0.2671359
#&gt; Pearson          38.90831 34 0.2582333</div><div class='input'>

<span class='co'># multinomial model</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>nnet</span>)
(<span class='no'>house.mult</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nnet/man/multinom.html'>multinom</a></span>(<span class='no'>Sat</span> ~ <span class='no'>Infl</span> + <span class='no'>Type</span> + <span class='no'>Cont</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='no'>Freq</span>,
                       <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>housing</span>))</div><div class='output co'>#&gt; # weights:  24 (14 variable)
#&gt; initial  value 1846.767257 
#&gt; iter  10 value 1747.045232
#&gt; final  value 1735.041933 
#&gt; converged</div><div class='output co'>#&gt; Call:
#&gt; multinom(formula = Sat ~ Infl + Type + Cont, data = housing, 
#&gt;     weights = Freq)
#&gt; 
#&gt; Coefficients:
#&gt;        (Intercept) InflMedium  InflHigh TypeApartment TypeAtrium TypeTerrace
#&gt; Medium  -0.4192316  0.4464003 0.6649367    -0.4356851  0.1313663  -0.6665728
#&gt; High    -0.1387453  0.7348626 1.6126294    -0.7356261 -0.4079808  -1.4123333
#&gt;         ContHigh
#&gt; Medium 0.3608513
#&gt; High   0.4818236
#&gt; 
#&gt; Residual Deviance: 3470.084 
#&gt; AIC: 3498.084 </div><div class='input'><span class='no'>house.mult2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nnet/man/multinom.html'>multinom</a></span>(<span class='no'>Sat</span> ~ <span class='no'>Infl</span>*<span class='no'>Type</span>*<span class='no'>Cont</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='no'>Freq</span>,
                        <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>housing</span>)</div><div class='output co'>#&gt; # weights:  75 (48 variable)
#&gt; initial  value 1846.767257 
#&gt; iter  10 value 1734.465581
#&gt; iter  20 value 1717.220153
#&gt; iter  30 value 1715.760679
#&gt; iter  40 value 1715.713306
#&gt; final  value 1715.710836 
#&gt; converged</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>house.mult</span>, <span class='no'>house.mult2</span>)</div><div class='output co'>#&gt; Likelihood ratio tests of Multinomial Models
#&gt; 
#&gt; Response: Sat
#&gt;                Model Resid. df Resid. Dev   Test    Df LR stat.   Pr(Chi)
#&gt; 1 Infl + Type + Cont       130   3470.084                                
#&gt; 2 Infl * Type * Cont        96   3431.422 1 vs 2    34 38.66219 0.2671367</div><div class='input'>
<span class='no'>house.pm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>house.mult</span>, <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>hnames</span>[-<span class='fl'>1</span>]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"probs"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>hnames</span>[-<span class='fl'>1</span>]), <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>house.pm</span>, <span class='fl'>2</span>))</div><div class='output co'>#&gt;      Infl      Type Cont  Low Medium High
#&gt; 1     Low     Tower  Low 0.40   0.26 0.34
#&gt; 2  Medium     Tower  Low 0.26   0.27 0.47
#&gt; 3    High     Tower  Low 0.15   0.19 0.66
#&gt; 4     Low Apartment  Low 0.54   0.23 0.23
#&gt; 5  Medium Apartment  Low 0.39   0.26 0.34
#&gt; 6    High Apartment  Low 0.26   0.21 0.53
#&gt; 7     Low    Atrium  Low 0.43   0.32 0.25
#&gt; 8  Medium    Atrium  Low 0.30   0.35 0.36
#&gt; 9    High    Atrium  Low 0.19   0.27 0.54
#&gt; 10    Low   Terrace  Low 0.65   0.22 0.14
#&gt; 11 Medium   Terrace  Low 0.51   0.27 0.22
#&gt; 12   High   Terrace  Low 0.37   0.24 0.39
#&gt; 13    Low     Tower High 0.30   0.28 0.42
#&gt; 14 Medium     Tower High 0.18   0.27 0.54
#&gt; 15   High     Tower High 0.10   0.19 0.71
#&gt; 16    Low Apartment High 0.44   0.27 0.30
#&gt; 17 Medium Apartment High 0.30   0.28 0.42
#&gt; 18   High Apartment High 0.18   0.21 0.61
#&gt; 19    Low    Atrium High 0.33   0.36 0.31
#&gt; 20 Medium    Atrium High 0.22   0.36 0.42
#&gt; 21   High    Atrium High 0.13   0.27 0.60
#&gt; 22    Low   Terrace High 0.55   0.27 0.19
#&gt; 23 Medium   Terrace High 0.40   0.31 0.29
#&gt; 24   High   Terrace High 0.27   0.26 0.47</div><div class='input'>
<span class='co'># proportional odds model</span>
<span class='no'>house.cpr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>house.pr</span>, <span class='fl'>1</span>, <span class='no'>cumsum</span>)
<span class='no'>logit</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>x</span>/(<span class='fl'>1</span>-<span class='no'>x</span>))
<span class='no'>house.ld</span> <span class='kw'>&lt;-</span> <span class='fu'>logit</span>(<span class='no'>house.cpr</span>[<span class='fl'>2</span>, ]) - <span class='fu'>logit</span>(<span class='no'>house.cpr</span>[<span class='fl'>1</span>, ])
(<span class='no'>ratio</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/drop.html'>drop</a></span>(<span class='no'>house.ld</span>)))</div><div class='output co'>#&gt;  [1] 0.9357341 0.9854433 1.0573182 1.0680491 1.0772649 1.0803574 1.0824895
#&gt;  [8] 1.0998759 1.1199975 1.1554228 1.1768138 1.1866427 1.2091541 1.2435026
#&gt; [15] 1.2724096 1.2750171 1.2849903 1.3062598 1.3123988 1.3904715 1.4540087
#&gt; [22] 1.4947753 1.4967585 1.6068789</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>ratio</span>)</div><div class='output co'>#&gt; [1] 1.223835</div><div class='input'>
(<span class='no'>house.plr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='polr.html'>polr</a></span>(<span class='no'>Sat</span> ~ <span class='no'>Infl</span> + <span class='no'>Type</span> + <span class='no'>Cont</span>,
                   <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>housing</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='no'>Freq</span>))</div><div class='output co'>#&gt; Call:
#&gt; polr(formula = Sat ~ Infl + Type + Cont, data = housing, weights = Freq)
#&gt; 
#&gt; Coefficients:
#&gt;    InflMedium      InflHigh TypeApartment    TypeAtrium   TypeTerrace 
#&gt;     0.5663937     1.2888191    -0.5723501    -0.3661866    -1.0910149 
#&gt;      ContHigh 
#&gt;     0.3602841 
#&gt; 
#&gt; Intercepts:
#&gt;  Low|Medium Medium|High 
#&gt;  -0.4961353   0.6907083 
#&gt; 
#&gt; Residual Deviance: 3479.149 
#&gt; AIC: 3495.149 </div><div class='input'>
<span class='no'>house.pr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>house.plr</span>, <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>hnames</span>[-<span class='fl'>1</span>]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"probs"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='no'>hnames</span>[-<span class='fl'>1</span>]), <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>house.pr1</span>, <span class='fl'>2</span>))</div><div class='output co'>#&gt;      Infl      Type Cont  Low Medium High
#&gt; 1     Low     Tower  Low 0.38   0.29 0.33
#&gt; 2  Medium     Tower  Low 0.26   0.27 0.47
#&gt; 3    High     Tower  Low 0.14   0.21 0.65
#&gt; 4     Low Apartment  Low 0.52   0.26 0.22
#&gt; 5  Medium Apartment  Low 0.38   0.29 0.33
#&gt; 6    High Apartment  Low 0.23   0.26 0.51
#&gt; 7     Low    Atrium  Low 0.47   0.27 0.26
#&gt; 8  Medium    Atrium  Low 0.33   0.29 0.38
#&gt; 9    High    Atrium  Low 0.19   0.25 0.56
#&gt; 10    Low   Terrace  Low 0.64   0.21 0.14
#&gt; 11 Medium   Terrace  Low 0.51   0.26 0.23
#&gt; 12   High   Terrace  Low 0.33   0.29 0.38
#&gt; 13    Low     Tower High 0.30   0.28 0.42
#&gt; 14 Medium     Tower High 0.19   0.25 0.56
#&gt; 15   High     Tower High 0.10   0.17 0.72
#&gt; 16    Low Apartment High 0.43   0.28 0.29
#&gt; 17 Medium Apartment High 0.30   0.28 0.42
#&gt; 18   High Apartment High 0.17   0.23 0.60
#&gt; 19    Low    Atrium High 0.38   0.29 0.33
#&gt; 20 Medium    Atrium High 0.26   0.27 0.47
#&gt; 21   High    Atrium High 0.14   0.21 0.64
#&gt; 22    Low   Terrace High 0.56   0.25 0.19
#&gt; 23 Medium   Terrace High 0.42   0.28 0.30
#&gt; 24   High   Terrace High 0.26   0.27 0.47</div><div class='input'>
<span class='no'>Fr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>housing</span>$<span class='no'>Freq</span>, <span class='kw'>ncol</span>  <span class='kw'>=</span>  <span class='fl'>3</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fl'>2</span>*<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>Fr</span>*<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>house.pr</span>/<span class='no'>house.pr1</span>))</div><div class='output co'>#&gt; [1] 9.065433</div><div class='input'>
<span class='no'>house.plr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='stepAIC.html'>stepAIC</a></span>(<span class='no'>house.plr</span>, ~<span class='no'>.</span>^<span class='fl'>2</span>)</div><div class='output co'>#&gt; Start:  AIC=3495.15
#&gt; Sat ~ Infl + Type + Cont
#&gt; 
#&gt;             Df    AIC
#&gt; + Infl:Type  6 3484.6
#&gt; + Type:Cont  3 3492.5
#&gt; &lt;none&gt;         3495.1
#&gt; + Infl:Cont  2 3498.9
#&gt; - Cont       1 3507.5
#&gt; - Type       3 3545.1
#&gt; - Infl       2 3599.4
#&gt; 
#&gt; Step:  AIC=3484.64
#&gt; Sat ~ Infl + Type + Cont + Infl:Type
#&gt; 
#&gt;             Df    AIC
#&gt; + Type:Cont  3 3482.7
#&gt; &lt;none&gt;         3484.6
#&gt; + Infl:Cont  2 3488.5
#&gt; - Infl:Type  6 3495.1
#&gt; - Cont       1 3497.8
#&gt; 
#&gt; Step:  AIC=3482.69
#&gt; Sat ~ Infl + Type + Cont + Infl:Type + Type:Cont
#&gt; 
#&gt;             Df    AIC
#&gt; &lt;none&gt;         3482.7
#&gt; - Type:Cont  3 3484.6
#&gt; + Infl:Cont  2 3486.6
#&gt; - Infl:Type  6 3492.5</div><div class='input'><span class='no'>house.plr2</span>$<span class='no'>anova</span></div><div class='output co'>#&gt; Stepwise Model Path 
#&gt; Analysis of Deviance Table
#&gt; 
#&gt; Initial Model:
#&gt; Sat ~ Infl + Type + Cont
#&gt; 
#&gt; Final Model:
#&gt; Sat ~ Infl + Type + Cont + Infl:Type + Type:Cont
#&gt; 
#&gt; 
#&gt;          Step Df  Deviance Resid. Df Resid. Dev      AIC
#&gt; 1                               1673   3479.149 3495.149
#&gt; 2 + Infl:Type  6 22.509347      1667   3456.640 3484.640
#&gt; 3 + Type:Cont  3  7.945029      1664   3448.695 3482.695</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#format">Format</a></li>
      <li><a href="#source">Source</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian Ripley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


