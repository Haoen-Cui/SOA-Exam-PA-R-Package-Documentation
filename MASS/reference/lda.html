<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Linear Discriminant Analysis — lda • MASS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Linear Discriminant Analysis — lda" />
<meta property="og:description" content="Linear discriminant analysis." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MASS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">7.3.51.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Linear Discriminant Analysis</h1>
    
    <div class="hidden name"><code>lda.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Linear discriminant analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>lda</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for formula</span>
<span class='fu'>lda</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>...</span>, <span class='no'>subset</span>, <span class='no'>na.action</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>lda</span>(<span class='no'>x</span>, <span class='no'>grouping</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>proportions</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1.0e-4</span>,
    <span class='no'>method</span>, <span class='kw'>CV</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>nu</span>, <span class='no'>...</span>)

<span class='co'># S3 method for data.frame</span>
<span class='fu'>lda</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for matrix</span>
<span class='fu'>lda</span>(<span class='no'>x</span>, <span class='no'>grouping</span>, <span class='no'>...</span>, <span class='no'>subset</span>, <span class='no'>na.action</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A formula of the form <code>groups ~ x1 + x2 + ...</code>  That is, the
    response is the grouping factor and the right hand side specifies
    the (non-factor) discriminators.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Data frame from which variables specified in <code>formula</code> are
    preferentially to be taken.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>(required if no formula is given as the principal argument.)
    a matrix or data frame or Matrix containing the explanatory variables.</p></td>
    </tr>
    <tr>
      <th>grouping</th>
      <td><p>(required if no formula principal argument is given.)
    a factor specifying the class for each observation.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>the prior probabilities of class membership.  If unspecified, the
    class proportions for the training set are used.  If present, the
    probabilities should be specified in the order of the factor
    levels.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>A tolerance to decide if a matrix is singular; it will reject variables
    and linear combinations of unit-variance variables whose variance is
    less than <code>tol^2</code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An index vector specifying the cases to be used in the training
    sample.  (NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>A function to specify the action to be taken if <code>NA</code>s are found.
    The default action is for the procedure to fail.  An alternative is
    <code>na.omit</code>, which leads to rejection of cases with missing values on
    any required variable.  (NOTE: If given, this argument must be named.)</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code>"moment"</code> for standard estimators of the mean and variance,
    <code>"mle"</code> for MLEs, <code>"mve"</code> to use <code><a href='cov.rob.html'>cov.mve</a></code>, or
    <code>"t"</code> for robust estimates based on a \(t\) distribution.</p></td>
    </tr>
    <tr>
      <th>CV</th>
      <td><p>If true, returns results (classes and posterior probabilities) for
    leave-one-out cross-validation. Note that if the prior is estimated,
    the proportions in the whole dataset are used.</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>degrees of freedom for <code>method = "t"</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to or from other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>CV = TRUE</code> the return value is a list with components
  <code>class</code>, the MAP classification (a factor), and <code>posterior</code>,
  posterior probabilities for the classes.</p>
<p>Otherwise it is an object of class <code>"lda"</code> containing the
  following components:</p>
<dt>prior</dt><dd><p>the prior probabilities used.</p></dd>
  <dt>means</dt><dd><p>the group means.</p></dd>
  <dt>scaling</dt><dd><p>a matrix which transforms observations to discriminant functions,
    normalized so that within groups covariance matrix is spherical.</p></dd>
  <dt>svd</dt><dd><p>the singular values, which give the ratio of the between- and
    within-group standard deviations on the linear discriminant
    variables.  Their squares are the canonical F-statistics.</p></dd>
  <dt>N</dt><dd><p>The number of observations used.</p></dd>
  <dt>call</dt><dd><p>The (matched) function call.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function
tries hard to detect if the within-class covariance matrix is
singular. If any variable has within-group variance less than
<code>tol^2</code> it will stop and report the variable as constant.  This
could result from poor scaling of the problem, but is more
likely to result from constant variables.</p>
<p>Specifying the <code>prior</code> will affect the classification unless
over-ridden in <code>predict.lda</code>.  Unlike in most statistical packages, it
will also affect the rotation of the linear discriminants within their
space, as a weighted between-groups covariance matrix is used. Thus
the first few linear discriminants emphasize the differences between
groups with the weights given by the prior, which may differ from
their prevalence in the dataset.</p>
<p>If one or more groups is missing in the supplied data, they are dropped
with a warning, but the classifications produced are with respect to the
original set of levels.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function may be called giving either a formula and
optional data frame, or a matrix and grouping factor as the first
two arguments.  All other arguments are optional, but <code>subset=</code> and
<code>na.action=</code>, if required, must be fully named.</p>
<p>If a formula is given as the principal argument the object may be
modified using <code><a href='https://rdrr.io/r/stats/update.html'>update()</a></code> in the usual way.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Venables, W. N. and Ripley, B. D. (2002)
  <em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.</p>
<p>Ripley, B. D. (1996)
  <em>Pattern Recognition and Neural Networks</em>. Cambridge University Press.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predict.lda.html'>predict.lda</a></code>, <code><a href='qda.html'>qda</a></code>, <code><a href='predict.qda.html'>predict.qda</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>Iris</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>iris3</span>[,,<span class='fl'>1</span>], <span class='no'>iris3</span>[,,<span class='fl'>2</span>], <span class='no'>iris3</span>[,,<span class='fl'>3</span>]),
                   <span class='kw'>Sp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"s"</span>,<span class='st'>"c"</span>,<span class='st'>"v"</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>50</span>,<span class='fl'>3</span>)))
<span class='no'>train</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>150</span>, <span class='fl'>75</span>)
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>Iris</span>$<span class='no'>Sp</span>[<span class='no'>train</span>])</div><div class='output co'>#&gt; 
#&gt;  c  s  v 
#&gt; 22 31 22 </div><div class='input'><span class='co'>## your answer may differ</span>
<span class='co'>##  c  s  v</span>
<span class='co'>## 22 23 30</span>
<span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'>lda</span>(<span class='no'>Sp</span> ~ <span class='no'>.</span>, <span class='no'>Iris</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)/<span class='fl'>3</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>train</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>z</span>, <span class='no'>Iris</span>[-<span class='no'>train</span>, ])$<span class='no'>class</span></div><div class='output co'>#&gt;  [1] s s s s s s s s s s s s s s s s s s s c c c c c c c c c c c c v c c c c v c
#&gt; [39] c c c c c c c c c v v v v v v v v v v c v v v v v v v c v v v v v v v v v
#&gt; Levels: c s v</div><div class='input'><span class='co'>##  [1] s s s s s s s s s s s s s s s s s s s s s s s s s s s c c c</span>
<span class='co'>## [31] c c c c c c c v c c c c v c c c c c c c c c c c c v v v v v</span>
<span class='co'>## [61] v v v v v v v v v v v v v v v</span>
(<span class='no'>z1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>z</span>, <span class='no'>.</span> ~ <span class='no'>.</span> - <span class='no'>Petal.W.</span>))</div><div class='output co'>#&gt; Call:
#&gt; lda(Sp ~ Sepal.L. + Sepal.W. + Petal.L., data = Iris, prior = c(1, 
#&gt;     1, 1)/3, subset = train)
#&gt; 
#&gt; Prior probabilities of groups:
#&gt;         c         s         v 
#&gt; 0.3333333 0.3333333 0.3333333 
#&gt; 
#&gt; Group means:
#&gt;   Sepal.L. Sepal.W. Petal.L.
#&gt; c 5.968182 2.763636 4.254545
#&gt; s 4.974194 3.448387 1.458065
#&gt; v 6.668182 2.950000 5.600000
#&gt; 
#&gt; Coefficients of linear discriminants:
#&gt;                 LD1       LD2
#&gt; Sepal.L.  1.7449211 -1.254634
#&gt; Sepal.W.  0.0379671  3.754167
#&gt; Petal.L. -3.7525160  1.032709
#&gt; 
#&gt; Proportion of trace:
#&gt;    LD1    LD2 
#&gt; 0.9905 0.0095 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian Ripley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


