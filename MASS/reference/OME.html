<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tests of Auditory Perception in Children with OME — OME • MASS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Tests of Auditory Perception in Children with OME — OME" />
<meta property="og:description" content="Experiments were performed on children on their ability to
  differentiate a signal in broad-band noise. The noise was played from
  a pair of speakers and a signal was added to just one channel; the
  subject had to turn his/her head to the channel with the added signal.
  The signal was either coherent (the amplitude of the noise was
  increased for a period) or incoherent (independent noise was added for
  the same period to form the same increase in power).
The threshold used in the original analysis was the stimulus loudness
  needs to get 75% correct responses. Some of the children had
  suffered from otitis media with effusion (OME)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MASS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">7.3.51.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tests of Auditory Perception in Children with OME</h1>
    
    <div class="hidden name"><code>OME.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Experiments were performed on children on their ability to
  differentiate a signal in broad-band noise. The noise was played from
  a pair of speakers and a signal was added to just one channel; the
  subject had to turn his/her head to the channel with the added signal.
  The signal was either coherent (the amplitude of the noise was
  increased for a period) or incoherent (independent noise was added for
  the same period to form the same increase in power).</p>
<p>The threshold used in the original analysis was the stimulus loudness
  needs to get 75% correct responses. Some of the children had
  suffered from otitis media with effusion (OME).</p>
    </div>

    <pre class="usage"><span class='no'>OME</span></pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>The <code>OME</code> data frame has 1129 rows and 7 columns:</p><dl class='dl-horizontal'>
    <dt><code>ID</code></dt><dd><p>Subject ID (1 to 99, with some IDs missing). A few subjects were
      measured at different ages.</p></dd>
    <dt><code>OME</code></dt><dd><p><code>"low"</code> or <code>"high"</code> or <code>"N/A"</code> (at ages other than
      30 and 60 months).</p></dd>
    <dt><code>Age</code></dt><dd><p>Age of the subject (months).</p></dd>
    <dt><code>Loud</code></dt><dd><p>Loudness of stimulus, in decibels.</p></dd>
    <dt><code>Noise</code></dt><dd><p>Whether the signal in the stimulus was <code>"coherent"</code> or
      <code>"incoherent"</code>.</p></dd>
    <dt><code>Correct</code></dt><dd><p>Number of correct responses from <code>Trials</code> trials.</p></dd>
    <dt><code>Trials</code></dt><dd><p>Number of trials performed.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Sarah Hogan, Dept of Physiology, University of Oxford, via
  Dept of Statistics Consulting Service</p>
    <h2 class="hasAnchor" id="background"><a class="anchor" href="#background"></a>Background</h2>

    <p>The experiment was to study otitis media with effusion (OME), a very
  common childhood condition where the middle ear space, which is
  normally air-filled, becomes congested by a fluid.  There is a
  concomitant fluctuating, conductive hearing loss which can result in
  various language, cognitive and social deficits.  The term &#8216;binaural
    hearing&#8217; is used to describe the listening conditions in which the
  brain is processing information from both ears at the same time.  The
  brain computes differences in the intensity and/or timing of signals
  arriving at each ear which contributes to sound localisation and also
  to our ability to hear in background noise.</p>
<p>Some years ago, it was found that children of 7--8 years with a history
  of significant OME had significantly worse binaural hearing than
  children without such a history, despite having equivalent
  sensitivity.  The question remained as to whether it was the timing,
  the duration, or the degree of severity of the otitis media episodes
  during critical periods, which affected later binaural hearing.  In an
  attempt to begin to answer this question, 95 children were monitored for
  the presence of effusion every month since birth.  On the basis of OME
  experience in their first two years, the test population was split
  into one group of high OME prevalence and one of low prevalence.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Fit logistic curve from p = 0.5 to p = 1.0</span>
<span class='no'>fp1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deriv.html'>deriv</a></span>(~ <span class='fl'>0.5</span> + <span class='fl'>0.5</span>/(<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>-<span class='no'>L75</span>)/<span class='no'>scal</span>)),
             <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"L75"</span>, <span class='st'>"scal"</span>),
             <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>L75</span>,<span class='no'>scal</span>)<span class='kw'>NULL</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>Correct</span>/<span class='no'>Trials</span> ~ <span class='fu'>fp1</span>(<span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>scal</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>,
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>3</span>))</div><div class='output co'>#&gt; Nonlinear regression model
#&gt;   model: Correct/Trials ~ fp1(Loud, L75, scal)
#&gt;    data: OME
#&gt;    L75   scal 
#&gt; 44.149  3.775 
#&gt;  residual sum-of-squares: 69.88
#&gt; 
#&gt; Number of iterations to convergence: 4 
#&gt; Achieved convergence tolerance: 7.016e-06</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>Correct</span>/<span class='no'>Trials</span> ~ <span class='fu'>fp1</span>(<span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>scal</span>),
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>[<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"coherent"</span>,],
    <span class='kw'>start</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>3</span>))</div><div class='output co'>#&gt; Nonlinear regression model
#&gt;   model: Correct/Trials ~ fp1(Loud, L75, scal)
#&gt;    data: OME[OME$Noise == "coherent", ]
#&gt;    L75   scal 
#&gt; 47.993  1.259 
#&gt;  residual sum-of-squares: 30.35
#&gt; 
#&gt; Number of iterations to convergence: 5 
#&gt; Achieved convergence tolerance: 4.895e-06</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='no'>Correct</span>/<span class='no'>Trials</span> ~ <span class='fu'>fp1</span>(<span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>scal</span>),
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>[<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"incoherent"</span>,],
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>3</span>))</div><div class='output co'>#&gt; Nonlinear regression model
#&gt;   model: Correct/Trials ~ fp1(Loud, L75, scal)
#&gt;    data: OME[OME$Noise == "incoherent", ]
#&gt;   L75  scal 
#&gt; 38.87  2.17 
#&gt;  residual sum-of-squares: 23.73
#&gt; 
#&gt; Number of iterations to convergence: 11 
#&gt; Achieved convergence tolerance: 3.846e-06</div><div class='input'>
<span class='co'># individual fits for each experiment</span>

<span class='no'>aa</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>OME</span>$<span class='no'>Age</span>)
<span class='no'>ab</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>*<span class='no'>OME</span>$<span class='no'>ID</span> + <span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span>(<span class='no'>aa</span>)
<span class='no'>ac</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>unclass</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>ab</span>))
<span class='no'>OME</span>$<span class='no'>UID</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='no'>ac</span>)
<span class='no'>OME</span>$<span class='no'>UIDn</span> <span class='kw'>&lt;-</span> <span class='no'>OME</span>$<span class='no'>UID</span> + <span class='fl'>0.1</span>*(<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"incoherent"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span>(<span class='no'>aa</span>, <span class='no'>ab</span>, <span class='no'>ac</span>)
<span class='no'>OMEi</span> <span class='kw'>&lt;-</span> <span class='no'>OME</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>nlme</span>)
<span class='no'>fp2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deriv.html'>deriv</a></span>(~ <span class='fl'>0.5</span> + <span class='fl'>0.5</span>/(<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>-<span class='no'>L75</span>)/<span class='fl'>2</span>)),
            <span class='st'>"L75"</span>, <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>L75</span>) <span class='kw'>NULL</span>)
<span class='no'>dec</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"OutDec"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>show.error.messages</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>OutDec</span><span class='kw'>=</span><span class='st'>"."</span>)
<span class='no'>OMEi.nls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nlme/man/nlsList.html'>nlsList</a></span>(<span class='no'>Correct</span>/<span class='no'>Trials</span> ~ <span class='fu'>fp2</span>(<span class='no'>Loud</span>, <span class='no'>L75</span>) <span class='kw'>|</span> <span class='no'>UIDn</span>,
   <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OMEi</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>), <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>100</span>))
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>show.error.messages</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>OutDec</span><span class='kw'>=</span><span class='no'>dec</span>)
<span class='no'>tmp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='no'>OMEi.nls</span>, <span class='kw'>function</span>(<span class='no'>X</span>)
              {<span class='kw'>if</span>(<span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>X</span>)) <span class='fl'>NA</span> <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>X</span>))})
<span class='no'>OMEif</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>UID</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>((<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>tmp</span>)))),
         <span class='kw'>Noise</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"coherent"</span>, <span class='st'>"incoherent"</span>), <span class='fl'>110</span>),
         <span class='kw'>L75</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='no'>tmp</span>), <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>OMEif</span>$<span class='no'>Age</span> <span class='kw'>&lt;-</span> <span class='no'>OME</span>$<span class='no'>Age</span>[<span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span>(<span class='no'>OMEif</span>$<span class='no'>UID</span>, <span class='no'>OME</span>$<span class='no'>UID</span>)]
<span class='no'>OMEif</span>$<span class='no'>OME</span> <span class='kw'>&lt;-</span> <span class='no'>OME</span>$<span class='no'>OME</span>[<span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span>(<span class='no'>OMEif</span>$<span class='no'>UID</span>, <span class='no'>OME</span>$<span class='no'>UID</span>)]
<span class='no'>OMEif</span> <span class='kw'>&lt;-</span> <span class='no'>OMEif</span>[<span class='no'>OMEif</span>$<span class='no'>L75</span> <span class='kw'>&gt;</span> <span class='fl'>30</span>,]
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>L75</span> ~ <span class='no'>Noise</span>/<span class='no'>Age</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OMEif</span>, <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='no'>na.omit</span>))</div><div class='output co'>#&gt; <span class='error'>Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>L75</span> ~ <span class='no'>Noise</span>/(<span class='no'>Age</span> + <span class='no'>OME</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OMEif</span>,
           <span class='kw'>subset</span> <span class='kw'>=</span> (<span class='no'>Age</span> <span class='kw'>&gt;=</span> <span class='fl'>30</span> <span class='kw'>&amp;</span> <span class='no'>Age</span> <span class='kw'>&lt;=</span> <span class='fl'>60</span>),
           <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='no'>na.omit</span>), <span class='kw'>cor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in `contrasts&lt;-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels</span></div><div class='input'>
<span class='co'># Or fit by weighted least squares</span>
<span class='no'>fpl75</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deriv.html'>deriv</a></span>(~ <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n</span>)*(<span class='no'>r</span>/<span class='no'>n</span> - <span class='fl'>0.5</span> - <span class='fl'>0.5</span>/(<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>-<span class='no'>L75</span>)/<span class='no'>scal</span>))),
               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"L75"</span>, <span class='st'>"scal"</span>),
               <span class='kw'>function</span>(<span class='no'>r</span>,<span class='no'>n</span>,<span class='no'>x</span>,<span class='no'>L75</span>,<span class='no'>scal</span>) <span class='kw'>NULL</span>)
<span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='fl'>0</span> ~ <span class='fu'>fpl75</span>(<span class='no'>Correct</span>, <span class='no'>Trials</span>, <span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>scal</span>),
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>[<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"coherent"</span>,],
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>3</span>))</div><div class='output co'>#&gt; Nonlinear regression model
#&gt;   model: 0 ~ fpl75(Correct, Trials, Loud, L75, scal)
#&gt;    data: OME[OME$Noise == "coherent", ]
#&gt;    L75   scal 
#&gt; 47.798  1.296 
#&gt;  residual sum-of-squares: 91.72
#&gt; 
#&gt; Number of iterations to convergence: 5 
#&gt; Achieved convergence tolerance: 9.302e-06</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='fl'>0</span> ~ <span class='fu'>fpl75</span>(<span class='no'>Correct</span>, <span class='no'>Trials</span>, <span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>scal</span>),
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>[<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"incoherent"</span>,],
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>3</span>))</div><div class='output co'>#&gt; Nonlinear regression model
#&gt;   model: 0 ~ fpl75(Correct, Trials, Loud, L75, scal)
#&gt;    data: OME[OME$Noise == "incoherent", ]
#&gt;    L75   scal 
#&gt; 38.553  2.078 
#&gt;  residual sum-of-squares: 60.19
#&gt; 
#&gt; Number of iterations to convergence: 8 
#&gt; Achieved convergence tolerance: 4.55e-06</div><div class='input'>
<span class='co'># Test to see if the curves shift with age</span>
<span class='no'>fpl75age</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deriv.html'>deriv</a></span>(~<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n</span>)*(<span class='no'>r</span>/<span class='no'>n</span> -  <span class='fl'>0.5</span> - <span class='fl'>0.5</span>/(<span class='fl'>1</span> +
                  <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>-<span class='no'>L75</span>-<span class='no'>slope</span>*<span class='no'>age</span>)/<span class='no'>scal</span>))),
                  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"L75"</span>, <span class='st'>"slope"</span>, <span class='st'>"scal"</span>),
                  <span class='kw'>function</span>(<span class='no'>r</span>,<span class='no'>n</span>,<span class='no'>x</span>,<span class='no'>age</span>,<span class='no'>L75</span>,<span class='no'>slope</span>,<span class='no'>scal</span>) <span class='kw'>NULL</span>)
<span class='no'>OME.nls1</span> <span class='kw'>&lt;-</span>
<span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='fl'>0</span> ~ <span class='fu'>fpl75age</span>(<span class='no'>Correct</span>, <span class='no'>Trials</span>, <span class='no'>Loud</span>, <span class='no'>Age</span>, <span class='no'>L75</span>, <span class='no'>slope</span>, <span class='no'>scal</span>),
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>[<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"coherent"</span>,],
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>slope</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>OME.nls1</span>)))</div><div class='output co'>#&gt;        L75      slope       scal 
#&gt; 0.61091761 0.01665916 0.17566450 </div><div class='input'>
<span class='no'>OME.nls2</span> <span class='kw'>&lt;-</span>
<span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span>(<span class='fl'>0</span> ~ <span class='fu'>fpl75age</span>(<span class='no'>Correct</span>, <span class='no'>Trials</span>, <span class='no'>Loud</span>, <span class='no'>Age</span>, <span class='no'>L75</span>, <span class='no'>slope</span>, <span class='no'>scal</span>),
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OME</span>[<span class='no'>OME</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"incoherent"</span>,],
    <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fl'>45</span>, <span class='kw'>slope</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>scal</span><span class='kw'>=</span><span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>OME.nls2</span>)))</div><div class='output co'>#&gt;        L75      slope       scal 
#&gt; 0.49553854 0.01348281 0.24453836 </div><div class='input'>
<span class='co'># Now allow random effects by using NLME</span>
<span class='no'>OMEf</span> <span class='kw'>&lt;-</span> <span class='no'>OME</span>[<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>OME</span>), <span class='no'>OME</span>$<span class='no'>Trials</span>),]
<span class='no'>OMEf</span>$<span class='no'>Resp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>OME</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>0</span>), <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>Trials</span>)),
                          <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>Correct</span>, <span class='no'>Trials</span>-<span class='no'>Correct</span>))))
<span class='no'>OMEf</span> <span class='kw'>&lt;-</span> <span class='no'>OMEf</span>[, -<span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Correct"</span>, <span class='st'>"Trials"</span>), <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>OMEf</span>))]

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='co'>## these fail in R on most platforms</span>
<span class='no'>fp2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/deriv.html'>deriv</a></span>(~ <span class='fl'>0.5</span> + <span class='fl'>0.5</span>/(<span class='fl'>1</span> + <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>-<span class='no'>L75</span>)/<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='no'>lsc</span>))),
             <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"L75"</span>, <span class='st'>"lsc"</span>),
             <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>L75</span>, <span class='no'>lsc</span>) <span class='kw'>NULL</span>)
<span class='fu'><a href='https://rdrr.io/r/base/try.html'>try</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/nlme/man/nlme.html'>nlme</a></span>(<span class='no'>Resp</span> ~ <span class='fu'>fp2</span>(<span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>lsc</span>),
     <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>L75</span> ~ <span class='no'>Age</span>, <span class='no'>lsc</span> ~ <span class='fl'>1</span>),
     <span class='kw'>random</span> <span class='kw'>=</span> <span class='no'>L75</span> + <span class='no'>lsc</span> ~ <span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>UID</span>,
     <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OMEf</span>[<span class='no'>OMEf</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"coherent"</span>,], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ML"</span>,
     <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>48.7</span>, -<span class='fl'>0.03</span>), <span class='kw'>lsc</span><span class='kw'>=</span><span class='fl'>0.24</span>)), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))</div><div class='output co'>#&gt; Error in fp2(Loud, L75, lsc) : could not find function "fp2"</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/try.html'>try</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/nlme/man/nlme.html'>nlme</a></span>(<span class='no'>Resp</span> ~ <span class='fu'>fp2</span>(<span class='no'>Loud</span>, <span class='no'>L75</span>, <span class='no'>lsc</span>),
     <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>L75</span> ~ <span class='no'>Age</span>, <span class='no'>lsc</span> ~ <span class='fl'>1</span>),
     <span class='kw'>random</span> <span class='kw'>=</span> <span class='no'>L75</span> + <span class='no'>lsc</span> ~ <span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>UID</span>,
     <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>OMEf</span>[<span class='no'>OMEf</span>$<span class='no'>Noise</span> <span class='kw'>==</span> <span class='st'>"incoherent"</span>,], <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"ML"</span>,
     <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>L75</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>41.5</span>, -<span class='fl'>0.1</span>), <span class='kw'>lsc</span><span class='kw'>=</span><span class='fl'>0</span>)), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))</div><div class='output co'>#&gt; Error in fp2(Loud, L75, lsc) : could not find function "fp2"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#format">Format</a></li>
      <li><a href="#source">Source</a></li>
      <li><a href="#background">Background</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian Ripley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


