<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate the Shape Parameter of the Gamma Distribution in a GLM Fit — gamma.shape • MASS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate the Shape Parameter of the Gamma Distribution in a GLM Fit — gamma.shape" />
<meta property="og:description" content="Find the maximum likelihood estimate of the shape parameter of
the gamma distribution after fitting a Gamma generalized
linear model." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MASS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">7.3.51.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the Shape Parameter of the Gamma Distribution in a GLM Fit</h1>
    
    <div class="hidden name"><code>gamma.shape.glm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find the maximum likelihood estimate of the shape parameter of
the gamma distribution after fitting a <code>Gamma</code> generalized
linear model.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for glm</span>
<span class='fu'>gamma.shape</span>(<span class='no'>object</span>, <span class='kw'>it.lim</span> <span class='kw'>=</span> <span class='fl'>10</span>,
            <span class='kw'>eps.max</span> <span class='kw'>=</span> <span class='no'>.Machine</span>$<span class='no'>double.eps</span>^<span class='fl'>0.25</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Fitted model object from a <code>Gamma</code> family or <code>quasi</code> family with
<code>variance = "mu^2"</code>.</p></td>
    </tr>
    <tr>
      <th>it.lim</th>
      <td><p>Upper limit on the number of iterations.</p></td>
    </tr>
    <tr>
      <th>eps.max</th>
      <td><p>Maximum discrepancy between approximations for the iteration
process to continue.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code>, causes successive iterations to be printed out.  The
initial estimate is taken from the deviance.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments passed to or from other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of two components</p>
<dt>alpha</dt><dd><p>the maximum likelihood estimate</p></dd>
<dt>SE</dt><dd><p>the approximate standard error, the square-root of the reciprocal of
the observed information.</p></dd>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A glm fit for a Gamma family correctly calculates the maximum
likelihood estimate of the mean parameters but provides only a
crude estimate of the dispersion parameter.  This function takes
the results of the glm fit and solves the maximum likelihood
equation for the reciprocal of the dispersion parameter, which is
usually called the shape (or exponent) parameter.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Venables, W. N. and Ripley, B. D. (2002)
  <em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gamma.dispersion.html'>gamma.dispersion</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>clotting</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
    <span class='kw'>u</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>15</span>,<span class='fl'>20</span>,<span class='fl'>30</span>,<span class='fl'>40</span>,<span class='fl'>60</span>,<span class='fl'>80</span>,<span class='fl'>100</span>),
    <span class='kw'>lot1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>118</span>,<span class='fl'>58</span>,<span class='fl'>42</span>,<span class='fl'>35</span>,<span class='fl'>27</span>,<span class='fl'>25</span>,<span class='fl'>21</span>,<span class='fl'>19</span>,<span class='fl'>18</span>),
    <span class='kw'>lot2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>69</span>,<span class='fl'>35</span>,<span class='fl'>26</span>,<span class='fl'>21</span>,<span class='fl'>18</span>,<span class='fl'>16</span>,<span class='fl'>13</span>,<span class='fl'>12</span>,<span class='fl'>12</span>))
<span class='no'>clot1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>lot1</span> ~ <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>u</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>clotting</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>Gamma</span>)
<span class='fu'>gamma.shape</span>(<span class='no'>clot1</span>)</div><div class='output co'>#&gt;                
#&gt; Alpha: 538.1315
#&gt; SE:    253.5991</div><div class='input'>
<span class='no'>gm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>Days</span> + <span class='fl'>0.1</span> ~ <span class='no'>Age</span>*<span class='no'>Eth</span>*<span class='no'>Sex</span>*<span class='no'>Lrn</span>,
          <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>quasi</a></span>(<span class='kw'>link</span><span class='kw'>=</span><span class='no'>log</span>, <span class='kw'>variance</span><span class='kw'>=</span><span class='st'>"mu^2"</span>), <span class='no'>quine</span>,
          <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fl'>31</span>)))
<span class='fu'>gamma.shape</span>(<span class='no'>gm</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Initial estimate: 1.060344</span></div><div class='output co'>#&gt; <span class='message'>Iter. 1 Alpha: 1.238408</span></div><div class='output co'>#&gt; <span class='message'>Iter. 2 Alpha: 1.276997</span></div><div class='output co'>#&gt; <span class='message'>Iter. 3 Alpha: 1.278343</span></div><div class='output co'>#&gt; <span class='message'>Iter. 4 Alpha: 1.278345</span></div><div class='output co'>#&gt;                 
#&gt; Alpha: 1.2783449
#&gt; SE:    0.1345175</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>gm</span>, <span class='kw'>dispersion</span> <span class='kw'>=</span> <span class='fu'><a href='gamma.dispersion.html'>gamma.dispersion</a></span>(<span class='no'>gm</span>))  <span class='co'># better summary</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glm(formula = Days + 0.1 ~ Age * Eth * Sex * Lrn, family = quasi(link = log, 
#&gt;     variance = "mu^2"), data = quine, start = c(3, rep(0, 31)))
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -3.0385  -0.7164  -0.1532   0.3863   1.3087  
#&gt; 
#&gt; Coefficients: (4 not defined because of singularities)
#&gt;                       Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)            3.06105    0.44223   6.922 4.46e-12 ***
#&gt; AgeF1                 -0.61870    0.59331  -1.043 0.297041    
#&gt; AgeF2                 -2.31911    0.98885  -2.345 0.019014 *  
#&gt; AgeF3                 -0.37623    0.53149  -0.708 0.479020    
#&gt; EthN                  -0.13789    0.62540  -0.220 0.825496    
#&gt; SexM                  -0.48844    0.59331  -0.823 0.410369    
#&gt; LrnSL                 -1.92965    0.98885  -1.951 0.051009 .  
#&gt; AgeF1:EthN             0.10249    0.82338   0.124 0.900942    
#&gt; AgeF2:EthN            -0.50874    1.39845  -0.364 0.716017    
#&gt; AgeF3:EthN             0.06314    0.74584   0.085 0.932534    
#&gt; AgeF1:SexM             0.40695    0.94847   0.429 0.667884    
#&gt; AgeF2:SexM             3.06173    1.11626   2.743 0.006091 ** 
#&gt; AgeF3:SexM             1.10841    0.74208   1.494 0.135267    
#&gt; EthN:SexM             -0.74217    0.82338  -0.901 0.367394    
#&gt; AgeF1:LrnSL            2.60967    1.10114   2.370 0.017789 *  
#&gt; AgeF2:LrnSL            4.78434    1.36304   3.510 0.000448 ***
#&gt; AgeF3:LrnSL                 NA         NA      NA       NA    
#&gt; EthN:LrnSL             2.22936    1.39845   1.594 0.110899    
#&gt; SexM:LrnSL             1.56531    1.18112   1.325 0.185077    
#&gt; AgeF1:EthN:SexM       -0.30235    1.32176  -0.229 0.819065    
#&gt; AgeF2:EthN:SexM        0.29742    1.57035   0.189 0.849780    
#&gt; AgeF3:EthN:SexM        0.82215    1.03277   0.796 0.425995    
#&gt; AgeF1:EthN:LrnSL      -3.50803    1.54655  -2.268 0.023311 *  
#&gt; AgeF2:EthN:LrnSL      -3.33529    1.92481  -1.733 0.083133 .  
#&gt; AgeF3:EthN:LrnSL            NA         NA      NA       NA    
#&gt; AgeF1:SexM:LrnSL      -2.39791    1.51050  -1.587 0.112400    
#&gt; AgeF2:SexM:LrnSL      -4.12161    1.60698  -2.565 0.010323 *  
#&gt; AgeF3:SexM:LrnSL            NA         NA      NA       NA    
#&gt; EthN:SexM:LrnSL       -0.15305    1.66253  -0.092 0.926653    
#&gt; AgeF1:EthN:SexM:LrnSL  2.13480    2.08685   1.023 0.306317    
#&gt; AgeF2:EthN:SexM:LrnSL  2.11886    2.27882   0.930 0.352473    
#&gt; AgeF3:EthN:SexM:LrnSL       NA         NA      NA       NA    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; (Dispersion parameter for quasi family taken to be 0.7822615)
#&gt; 
#&gt;     Null deviance: 190.40  on 145  degrees of freedom
#&gt; Residual deviance: 128.36  on 118  degrees of freedom
#&gt; AIC: NA
#&gt; 
#&gt; Number of Fisher Scoring iterations: 7
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian Ripley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


