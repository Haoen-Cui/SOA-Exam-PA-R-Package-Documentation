<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Log-Linear Models by Iterative Proportional Scaling — loglm • MASS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit Log-Linear Models by Iterative Proportional Scaling — loglm" />
<meta property="og:description" content="This function provides a front-end to the standard function,
loglin, to allow log-linear models to be specified and fitted
in a manner similar to that of other fitting functions, such as
glm." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MASS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">7.3.51.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Log-Linear Models by Iterative Proportional Scaling</h1>
    
    <div class="hidden name"><code>loglm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function provides a front-end to the standard function,
<code>loglin</code>, to allow log-linear models to be specified and fitted
in a manner similar to that of other fitting functions, such as
<code>glm</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>loglm</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>subset</span>, <span class='no'>na.action</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A linear model formula specifying the log-linear model.</p>
<p>If the left-hand side is empty, the <code>data</code> argument is required
    and must be a (complete) array of frequencies.  In this case the
    variables on the right-hand side may be the names of the
    <code>dimnames</code> attribute of the frequency array, or may be the
    positive integers: 1, 2, 3, ... used as alternative names for the
    1st, 2nd, 3rd, ... dimension (classifying factor).
    If the left-hand side is not empty it specifies a vector of
    frequencies.  In this case the data argument, if present, must be
    a data frame from which the left-hand side vector and the
    classifying factors on the right-hand side are (preferentially)
    obtained.  The usual abbreviation of a <code>.</code> to stand for &#8216;all
    other variables in the data frame&#8217; is allowed.  Any non-factors
    on the right-hand side of the formula are coerced to factor.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Numeric array or data frame.  In the first case it specifies the
    array of frequencies; in then second it provides the data frame
    from which the variables occurring in the formula are
    preferentially obtained in the usual way.</p>    
<p>This argument may be the result of a call to <code><a href='https://rdrr.io/r/stats/xtabs.html'>xtabs</a></code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>Specifies a subset of the rows in the data frame to be used.  The
    default is to take all rows.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>Specifies a method for handling missing observations.  The
    default is to fail if missing values are present.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>May supply other arguments to the function <code><a href='loglm1.html'>loglm1</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"loglm"</code> conveying the results of the fitted
  log-linear model.  Methods exist for the generic functions <code>print</code>,
  <code>summary</code>, <code>deviance</code>, <code>fitted</code>, <code>coef</code>,
  <code>resid</code>, <code>anova</code> and <code>update</code>, which perform the expected
  tasks.  Only log-likelihood ratio tests are allowed using <code>anova</code>.</p>
<p>The deviance is simply an alternative name for the log-likelihood
  ratio statistic for testing the current model within a saturated
  model, in accordance with standard usage in generalized linear
  models.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the left-hand side of the formula is empty the <code>data</code> argument
  supplies the frequency array and the right-hand side of the
  formula is used to construct the list of fixed faces as required
  by <code>loglin</code>.  Structural zeros may be specified by giving a
  <code>start</code> argument with those entries set to zero, as described in
  the help information for <code>loglin</code>.</p>
<p>If the left-hand side is not empty, all variables on the
  right-hand side are regarded as classifying factors and an array
  of frequencies is constructed.  If some cells in the complete
  array are not specified they are treated as structural zeros.
  The right-hand side of the formula is again used to construct the
  list of faces on which the observed and fitted totals must agree,
  as required by <code>loglin</code>.  Hence terms such as
  <code>a:b</code>, <code>a*b</code> and <code>a/b</code> are all equivalent.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>If structural zeros are present, the calculation of degrees of
  freedom may not be correct.  <code>loglin</code> itself takes no action to
  allow for structural zeros.  <code>loglm</code> deducts one degree of
  freedom for each structural zero, but cannot make allowance for
  gains in error degrees of freedom due to loss of dimension in the
  model space.  (This would require checking the rank of the
  model matrix, but since iterative proportional scaling methods
  are developed largely to avoid constructing the model matrix
  explicitly, the computation is at least difficult.)</p>  
<p>When structural zeros (or zero fitted values) are present the
  estimated coefficients will not be available due to infinite
  estimates.  The deviances will normally continue to be correct, though.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Venables, W. N. and Ripley, B. D. (2002)
  <em>Modern Applied Statistics with S.</em> Fourth edition.  Springer.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='loglm1.html'>loglm1</a></code>, <code><a href='https://rdrr.io/r/stats/loglin.html'>loglin</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># The data frames  Cars93, minn38 and quine are available</span>
<span class='co'># in the MASS package.</span>

<span class='co'># Case 1: frequencies specified as an array.</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='no'>minn38</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span>(<span class='no'>x</span>)))</div><div class='output co'>#&gt;  hs phs fol sex   f 
#&gt;   3   4   7   2   0 </div><div class='input'><span class='co'>## hs phs fol sex f</span>
<span class='co'>##  3   4   7   2 0</span>
<span class='co'>##minn38a &lt;- array(0, c(3,4,7,2), lapply(minn38[, -5], levels))</span>
<span class='co'>##minn38a[data.matrix(minn38[,-5])] &lt;- minn38$f</span>

<span class='co'>## or more simply</span>
<span class='no'>minn38a</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/xtabs.html'>xtabs</a></span>(<span class='no'>f</span> ~ <span class='no'>.</span>, <span class='no'>minn38</span>)

<span class='no'>fm</span> <span class='kw'>&lt;-</span> <span class='fu'>loglm</span>(~ <span class='fl'>1</span> + <span class='fl'>2</span> + <span class='fl'>3</span> + <span class='fl'>4</span>, <span class='no'>minn38a</span>)  <span class='co'># numerals as names.</span>
<span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span>(<span class='no'>fm</span>)</div><div class='output co'>#&gt; [1] 3711.914</div><div class='input'><span class='co'>## [1] 3711.9</span>
<span class='no'>fm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>fm</span>, <span class='no'>.</span>~<span class='no'>.</span>^<span class='fl'>2</span>)
<span class='no'>fm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>fm</span>, <span class='no'>.</span>~<span class='no'>.</span>^<span class='fl'>3</span>, <span class='kw'>print</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; 5 iterations: deviation 0.07512432 </div><div class='input'><span class='co'>## 5 iterations: deviation 0.075</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>fm</span>, <span class='no'>fm1</span>, <span class='no'>fm2</span>)</div><div class='output co'>#&gt; LR tests for hierarchical log-linear models
#&gt; 
#&gt; Model 1:
#&gt;  ~1 + 2 + 3 + 4 
#&gt; Model 2:
#&gt;  . ~ `1` + `2` + `3` + `4` + `1`:`2` + `1`:`3` + `1`:`4` + `2`:`3` + `2`:`4` + `3`:`4` 
#&gt; Model 3:
#&gt;  . ~ `1` + `2` + `3` + `4` + `1`:`2` + `1`:`3` + `1`:`4` + `2`:`3` + `2`:`4` + `3`:`4` + `1`:`2`:`3` + `1`:`2`:`4` + `1`:`3`:`4` + `2`:`3`:`4` 
#&gt; 
#&gt;             Deviance  df Delta(Dev) Delta(df) P(&gt; Delta(Dev)
#&gt; Model 1   3711.91367 155                                    
#&gt; Model 2    220.04285 108 3491.87082        47        0.00000
#&gt; Model 3     47.74492  36  172.29794        72        0.00000
#&gt; Saturated    0.00000   0   47.74492        36        0.09114</div><div class='input'>
<span class='co'># Case 1. An array generated with xtabs.</span>

<span class='fu'>loglm</span>(~ <span class='no'>Type</span> + <span class='no'>Origin</span>, <span class='fu'><a href='https://rdrr.io/r/stats/xtabs.html'>xtabs</a></span>(~ <span class='no'>Type</span> + <span class='no'>Origin</span>, <span class='no'>Cars93</span>))</div><div class='output co'>#&gt; Call:
#&gt; loglm(formula = ~Type + Origin, data = xtabs(~Type + Origin, 
#&gt;     Cars93))
#&gt; 
#&gt; Statistics:
#&gt;                       X^2 df   P(&gt; X^2)
#&gt; Likelihood Ratio 18.36179  5 0.00252554
#&gt; Pearson          14.07985  5 0.01511005</div><div class='input'>
<span class='co'># Case 2.  Frequencies given as a vector in a data frame</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>quine</span>)</div><div class='output co'>#&gt; [1] "Eth"  "Sex"  "Age"  "Lrn"  "Days"</div><div class='input'><span class='co'>## [1] "Eth"  "Sex"  "Age"  "Lrn"  "Days"</span>
<span class='no'>fm</span> <span class='kw'>&lt;-</span> <span class='fu'>loglm</span>(<span class='no'>Days</span> ~ <span class='no'>.</span>^<span class='fl'>2</span>, <span class='no'>quine</span>)
<span class='no'>gm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span>(<span class='no'>Days</span> ~ <span class='no'>.</span>^<span class='fl'>2</span>, <span class='no'>poisson</span>, <span class='no'>quine</span>)  <span class='co'># check glm.</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span>(<span class='no'>fm</span>), <span class='fu'><a href='https://rdrr.io/r/stats/deviance.html'>deviance</a></span>(<span class='no'>gm</span>))          <span class='co'># deviances agree</span></div><div class='output co'>#&gt; [1] 1368.669 1368.669</div><div class='input'><span class='co'>## [1] 1368.7 1368.7</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>fm</span>$<span class='no'>df</span>, <span class='no'>gm</span>$<span class='no'>df</span>)                        <span class='co'># resid df do not!</span></div><div class='output co'>#&gt; [1] 127</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>fm</span>$<span class='no'>df</span>, <span class='no'>gm</span>$<span class='no'>df.residual</span>)               <span class='co'># resid df do not!</span></div><div class='output co'>#&gt; [1] 127 128</div><div class='input'>## [1] 127 128
# The loglm residual degrees of freedom is wrong because of
# a non-detectable redundancy in the model matrix.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#warning">Warning</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian Ripley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


