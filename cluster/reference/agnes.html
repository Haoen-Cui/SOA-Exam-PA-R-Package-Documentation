<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Agglomerative Nesting (Hierarchical Clustering) — agnes • cluster</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Agglomerative Nesting (Hierarchical Clustering) — agnes" />
<meta property="og:description" content="Computes agglomerative hierarchical clustering of the dataset." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cluster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Agglomerative Nesting (Hierarchical Clustering)</h1>
    
    <div class="hidden name"><code>agnes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes agglomerative hierarchical clustering of the dataset.</p>
    </div>

    <pre class="usage"><span class='fu'>agnes</span>(<span class='no'>x</span>, <span class='kw'>diss</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>inherits</a></span>(<span class='no'>x</span>, <span class='st'>"dist"</span>), <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>,
      <span class='kw'>stand</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"average"</span>, <span class='no'>par.method</span>,
      <span class='kw'>keep.diss</span> <span class='kw'>=</span> <span class='no'>n</span> <span class='kw'>&lt;</span> <span class='fl'>100</span>, <span class='kw'>keep.data</span> <span class='kw'>=</span> !<span class='no'>diss</span>, <span class='kw'>trace.lev</span> <span class='kw'>=</span> <span class='fl'>0</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>data matrix or data frame, or dissimilarity matrix, depending on the
    value of the <code>diss</code> argument.</p>
<p>In case of a matrix or data frame, each row corresponds to an observation,
    and each column corresponds to a variable. All variables must be numeric.
    Missing values (NAs) are allowed.</p>
<p>In case of a dissimilarity matrix, <code>x</code> is typically the output of
    <code><a href='daisy.html'>daisy</a></code> or <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>.
    Also a vector with length n*(n-1)/2 is allowed (where n is the number
    of observations), and will be interpreted in the same way as the
    output of the above-mentioned functions. Missing values (NAs) are not
    allowed.</p></td>
    </tr>
    <tr>
      <th>diss</th>
      <td><p>logical flag: if TRUE (default for <code>dist</code> or
    <code>dissimilarity</code> objects), then <code>x</code> is assumed to be a
    dissimilarity matrix.  If FALSE, then <code>x</code> is treated as
    a matrix of observations by variables.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>character string specifying the metric to be used for calculating
    dissimilarities between observations.
    The currently available options are <code>"euclidean"</code> and <code>"manhattan"</code>.
    Euclidean distances are root sum-of-squares of differences, and
    manhattan distances are the sum of absolute differences.
    If <code>x</code> is already a dissimilarity matrix, then this argument will
    be ignored.</p></td>
    </tr>
    <tr>
      <th>stand</th>
      <td><p>logical flag: if TRUE, then the measurements in <code>x</code> are
    standardized before calculating the dissimilarities. Measurements
    are standardized for each variable (column), by subtracting the
    variable's mean value and dividing by the variable's mean absolute
    deviation.  If <code>x</code> is already a dissimilarity matrix, then this
    argument will be ignored.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character string defining the clustering method.  The six methods
    implemented are
    <code>"average"</code> ([unweighted pair-]group [arithMetic] average method, aka &#8216;UPGMA&#8217;),
    <code>"single"</code> (single linkage), <code>"complete"</code> (complete linkage),
    <code>"ward"</code> (Ward's method),
    <code>"weighted"</code> (weighted average linkage, aka &#8216;WPGMA&#8217;), its generalization
    <code>"flexible"</code> which uses (a constant version of)
    the Lance-Williams formula and the <code>par.method</code> argument, and
    <code>"gaverage"</code> a generalized <code>"average"</code> aka &#8220;flexible
    UPGMA&#8221; method also using the Lance-Williams formula and <code>par.method</code>.</p>
<p>The default is <code>"average"</code>.</p></td>
    </tr>
    <tr>
      <th>par.method</th>
      <td><p>If <code>method</code> is <code>"flexible"</code> or <code>"gaverage"</code>, a numeric
    vector of length 1, 3, or 4, (with a default for <code>"gaverage"</code>), see in
    the details section.</p></td>
    </tr>
    <tr>
      <th>keep.diss, keep.data</th>
      <td><p>logicals indicating if the dissimilarities
    and/or input data <code>x</code> should be kept in the result.  Setting
    these to <code>FALSE</code> can give much smaller results and hence even save
    memory allocation <em>time</em>.</p></td>
    </tr>
    <tr>
      <th>trace.lev</th>
      <td><p>integer specifying a trace level for printing
    diagnostics during the algorithm.  Default <code>0</code> does not print
    anything; higher values print increasingly more.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>"agnes"</code> (which extends <code>"twins"</code>)
  representing the clustering.  See <code><a href='agnes.object.html'>agnes.object</a></code> for
  details, and methods applicable.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>agnes</code> is fully described in chapter 5 of Kaufman and Rousseeuw (1990).
  Compared to other agglomerative clustering methods such as <code>hclust</code>,
  <code>agnes</code> has the following features: (a) it yields the
  agglomerative coefficient (see <code><a href='agnes.object.html'>agnes.object</a></code>)
  which measures the amount of clustering structure found; and (b)
  apart from the usual tree it also provides the banner, a novel
  graphical display (see <code><a href='plot.agnes.html'>plot.agnes</a></code>).</p>
<p>The <code>agnes</code>-algorithm constructs a hierarchy of clusterings.<br />
  At first, each observation is a small cluster by itself.  Clusters are
  merged until only one large cluster remains which contains all the
  observations.  At each stage the two <em>nearest</em> clusters are combined
  to form one larger cluster.</p>
<p>For <code>method="average"</code>, the distance between two clusters is the
  average of the dissimilarities between the points in one cluster and the
  points in the other cluster.
  <br />
  In <code>method="single"</code>, we use the smallest dissimilarity between a
  point in the first cluster and a point in the second cluster (nearest
  neighbor method).
  <br />
  When <code>method="complete"</code>, we use the largest dissimilarity
  between a point in the first cluster and a point in the second cluster
  (furthest neighbor method).</p>
<p>The <code>method = "flexible"</code> allows (and requires) more details:
  The Lance-Williams formula specifies how dissimilarities are
  computed when clusters are agglomerated (equation (32) in K&amp;R(1990),
  p.237).  If clusters \(C_1\) and \(C_2\) are agglomerated into a
  new cluster, the dissimilarity between their union and another
  cluster \(Q\) is given by
  $$
    D(C_1 \cup C_2, Q) = \alpha_1 * D(C_1, Q) + \alpha_2 * D(C_2, Q) +
                         \beta * D(C_1,C_2) + \gamma * |D(C_1, Q) - D(C_2, Q)|,
  $$
  where the four coefficients \((\alpha_1, \alpha_2, \beta, \gamma)\)
  are specified by the vector <code>par.method</code>, either directly as vector of
  length 4, or (more conveniently) if <code>par.method</code> is of length 1,
  say \(= \alpha\), <code>par.method</code> is extended to
  give the &#8220;Flexible Strategy&#8221; (K&amp;R(1990), p.236 f) with
  Lance-Williams coefficients \((\alpha_1 = \alpha_2 = \alpha, \beta =
    1 - 2\alpha, \gamma=0)\).<br />
  Also, if <code>length(par.method) == 3</code>, \(\gamma = 0\) is set.</p>
<p><b>Care</b> and expertise is probably needed when using <code>method = "flexible"</code>
  particularly for the case when <code>par.method</code> is specified of
  longer length than one.  Since <span class="pkg">cluster</span> version 2.0, choices
  leading to invalid <code>merge</code> structures now signal an error (from
  the C code already).
  The <em>weighted average</em> (<code>method="weighted"</code>) is the same as
  <code>method="flexible", par.method = 0.5</code>.  Further,
  <code>method= "single"</code>  is equivalent to <code>method="flexible", par.method = c(.5,.5,0,-.5)</code>, and
  <code>method="complete"</code> is equivalent to <code>method="flexible", par.method = c(.5,.5,0,+.5)</code>.</p>
<p>The <code>method = "gaverage"</code> is a generalization of <code>"average"</code>, aka
  &#8220;flexible UPGMA&#8221; method, and is (a generalization of the approach)
  detailed in Belbin et al. (1992).  As <code>"flexible"</code>, it uses the
  Lance-Williams formula above for dissimilarity updating, but with
  \(\alpha_1\) and \(\alpha_2\) not constant, but <em>proportional</em> to
  the <em>sizes</em> \(n_1\) and \(n_2\) of the clusters \(C_1\) and
  \(C_2\) respectively, i.e,
  $$\alpha_j = \alpha'_j \frac{n_1}{n_1+n_2},$$
  where \(\alpha'_1\), \(\alpha'_2\) are determined from <code>par.method</code>,
  either directly as \((\alpha_1, \alpha_2, \beta, \gamma)\) or
  \((\alpha_1, \alpha_2, \beta)\) with \(\gamma = 0\), or (less flexibly,
  but more conveniently) as follows:</p>
<p>Belbin et al proposed &#8220;flexible beta&#8221;, i.e. the user would only
  specify \(\beta\) (as <code>par.method</code>), sensibly in
  $$-1 \leq \beta &lt; 1,$$
  and \(\beta\) determines \(\alpha'_1\) and \(\alpha'_2\) as
  $$\alpha'_j = 1 - \beta,$$ and \(\gamma = 0\).</p>
<p>This \(\beta\) may be specified by <code>par.method</code> (as length 1 vector),
  and if <code>par.method</code> is not specified, a default value of -0.1 is used,
  as Belbin et al recommend taking a \(\beta\) value around -0.1 as a general
  agglomerative hierarchical clustering strategy.</p>
<p>Note that <code>method = "gaverage", par.method = 0</code> (or <code>par.method =
  c(1,1,0,0)</code>) is equivalent to the <code>agnes()</code> default method <code>"average"</code>.</p>
    <h2 class="hasAnchor" id="background"><a class="anchor" href="#background"></a>BACKGROUND</h2>

    <p>Cluster analysis divides a dataset into groups (clusters) of
  observations that are similar to each other.</p><dl class='dl-horizontal'>
    <dt>Hierarchical methods</dt><dd><p>like
      <code>agnes</code>, <code><a href='diana.html'>diana</a></code>, and <code><a href='mona.html'>mona</a></code>
      construct a hierarchy of clusterings, with the number of clusters
      ranging from one to the number of observations.</p></dd>
    <dt>Partitioning methods</dt><dd><p>like
      <code><a href='pam.html'>pam</a></code>, <code><a href='clara.html'>clara</a></code>, and <code><a href='fanny.html'>fanny</a></code>
      require that the number of clusters be given by the user.</p></dd>
    
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kaufman, L. and Rousseeuw, P.J. (1990). (=: &#8220;K&amp;R(1990)&#8221;)
  <em>Finding Groups in Data: An Introduction to Cluster Analysis</em>.
  Wiley, New York.</p>
<p>Anja Struyf, Mia Hubert and Peter J. Rousseeuw (1996)
  Clustering in an Object-Oriented Environment.
  <em>Journal of Statistical Software</em> <b>1</b>.
  doi: <a href='https://doi.org/10.18637/jss.v001.i04'>10.18637/jss.v001.i04</a></p>
<p>Struyf, A., Hubert, M. and Rousseeuw, P.J. (1997). Integrating
  Robust Clustering Techniques in S-PLUS,
  <em>Computational Statistics and Data Analysis</em>, <b>26</b>, 17--37.</p>
<p>Lance, G.N., and W.T. Williams (1966).
  A General Theory of Classifactory Sorting Strategies, I. Hierarchical
  Systems.
  <em>Computer J.</em> <b>9</b>, 373--380.</p>
<p>Belbin, L., Faith, D.P. and Milligan, G.W. (1992). A Comparison of
  Two Approaches to Beta-Flexible Clustering.
  <em>Multivariate Behavioral Research</em>, <b>27</b>, 417--433.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='agnes.object.html'>agnes.object</a></code>, <code><a href='daisy.html'>daisy</a></code>, <code><a href='diana.html'>diana</a></code>,
  <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>, <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>, <code><a href='plot.agnes.html'>plot.agnes</a></code>,
  <code><a href='twins.object.html'>twins.object</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>votes.repub</span>)
<span class='no'>agn1</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>votes.repub</span>, <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"manhattan"</span>, <span class='kw'>stand</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>agn1</span></div><div class='output co'>#&gt; Call:	 agnes(x = votes.repub, metric = "manhattan", stand = TRUE) 
#&gt; Agglomerative coefficient:  0.7977555 
#&gt; Order of objects:
#&gt;  [1] Alabama        Georgia        Arkansas       Louisiana      Mississippi   
#&gt;  [6] South Carolina Alaska         Vermont        Arizona        Montana       
#&gt; [11] Nevada         Colorado       Idaho          Wyoming        Utah          
#&gt; [16] California     Oregon         Washington     Minnesota      Connecticut   
#&gt; [21] New York       New Jersey     Illinois       Ohio           Indiana       
#&gt; [26] Michigan       Pennsylvania   New Hampshire  Wisconsin      Delaware      
#&gt; [31] Kentucky       Maryland       Missouri       New Mexico     West Virginia 
#&gt; [36] Iowa           South Dakota   North Dakota   Kansas         Nebraska      
#&gt; [41] Maine          Massachusetts  Rhode Island   Florida        North Carolina
#&gt; [46] Tennessee      Virginia       Oklahoma       Hawaii         Texas         
#&gt; Height (summary):
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   8.382  12.804  18.528  23.118  28.411  87.455 
#&gt; 
#&gt; Available components:
#&gt; [1] "order"     "height"    "ac"        "merge"     "diss"      "call"     
#&gt; [7] "method"    "order.lab" "data"     </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>agn1</span>)</div><div class='img'><img src='agnes-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='agnes-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='no'>agn2</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='fu'><a href='daisy.html'>daisy</a></span>(<span class='no'>votes.repub</span>), <span class='kw'>diss</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"complete"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>agn2</span>)
<span class='co'>## alpha = 0.625 ==&gt; beta = -1/4  is "recommended" by some</span>
<span class='no'>agnS</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>votes.repub</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"flexible"</span>, <span class='kw'>par.meth</span> <span class='kw'>=</span> <span class='fl'>0.625</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>agnS</span>)</div><div class='img'><img src='agnes-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)

<span class='co'>## "show" equivalence of three "flexible" special cases</span>
<span class='no'>d.vr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='daisy.html'>daisy</a></span>(<span class='no'>votes.repub</span>)
<span class='no'>a.wgt</span>  <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>d.vr</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"weighted"</span>)
<span class='no'>a.sing</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>d.vr</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"single"</span>)
<span class='no'>a.comp</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>d.vr</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"complete"</span>)
<span class='no'>iC</span> <span class='kw'>&lt;-</span> -(<span class='fl'>6</span>:<span class='fl'>7</span>) <span class='co'># not using 'call' and 'method' for comparisons</span>
<span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span>(
  <span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>a.wgt</span> [<span class='no'>iC</span>], <span class='fu'>agnes</span>(<span class='no'>d.vr</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"flexible"</span>, <span class='kw'>par.method</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)[<span class='no'>iC</span>])   ,
  <span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>a.sing</span>[<span class='no'>iC</span>], <span class='fu'>agnes</span>(<span class='no'>d.vr</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"flex"</span>, <span class='kw'>par.method</span><span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.5</span>,<span class='fl'>.5</span>,<span class='fl'>0</span>, -<span class='fl'>.5</span>))[<span class='no'>iC</span>]),
  <span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>a.comp</span>[<span class='no'>iC</span>], <span class='fu'>agnes</span>(<span class='no'>d.vr</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"flex"</span>, <span class='kw'>par.method</span><span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.5</span>,<span class='fl'>.5</span>,<span class='fl'>0</span>, +<span class='fl'>.5</span>))[<span class='no'>iC</span>]))

<span class='co'>## Exploring the dendrogram structure</span>
(<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>agn2</span>)) <span class='co'># two main branches</span></div><div class='output co'>#&gt; 'dendrogram' with 2 branches and 50 members total, at height 281.9508 </div><div class='input'><span class='no'>d2</span><span class='kw'>[[</span><span class='fl'>1</span>]] <span class='co'># the first branch</span></div><div class='output co'>#&gt; 'dendrogram' with 2 branches and 8 members total, at height 116.7048 </div><div class='input'><span class='no'>d2</span><span class='kw'>[[</span><span class='fl'>2</span>]] <span class='co'># the 2nd one  { 8 + 42  = 50 }</span></div><div class='output co'>#&gt; 'dendrogram' with 2 branches and 42 members total, at height 178.4119 </div><div class='input'><span class='no'>d2</span><span class='kw'>[[</span><span class='fl'>1</span>]]<span class='kw'>[[</span><span class='fl'>1</span>]]<span class='co'># first sub-branch of branch 1 .. and shorter form</span></div><div class='output co'>#&gt; 'dendrogram' with 2 branches and 6 members total, at height 72.92212 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span>(<span class='no'>d2</span><span class='kw'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>)]],
          <span class='no'>d2</span><span class='kw'>[[</span><span class='fl'>1</span>]]<span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'>## a "textual picture" of the dendrogram :</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>d2</span>)</div><div class='output co'>#&gt; --[dendrogram w/ 2 branches and 50 members at h = 282]
#&gt;   |--[dendrogram w/ 2 branches and 8 members at h = 117]
#&gt;   |  |--[dendrogram w/ 2 branches and 6 members at h = 72.9]
#&gt;   |  |  |--[dendrogram w/ 2 branches and 3 members at h = 60.9]
#&gt;   |  |  |  |--[dendrogram w/ 2 branches and 2 members at h = 48.2]
#&gt;   |  |  |  |  |--leaf "Alabama" 
#&gt;   |  |  |  |  `--leaf "Georgia" 
#&gt;   |  |  |  `--leaf "Louisiana" 
#&gt;   |  |  `--[dendrogram w/ 2 branches and 3 members at h = 58.8]
#&gt;   |  |     |--[dendrogram w/ 2 branches and 2 members at h = 56.1]
#&gt;   |  |     |  |--leaf "Arkansas" 
#&gt;   |  |     |  `--leaf "Florida" 
#&gt;   |  |     `--leaf "Texas" 
#&gt;   |  `--[dendrogram w/ 2 branches and 2 members at h = 63.1]
#&gt;   |     |--leaf "Mississippi" 
#&gt;   |     `--leaf "South Carolina" 
#&gt;   `--[dendrogram w/ 2 branches and 42 members at h = 178]
#&gt;      |--[dendrogram w/ 2 branches and 37 members at h = 121]
#&gt;      |  |--[dendrogram w/ 2 branches and 31 members at h = 80.5]
#&gt;      |  |  |--[dendrogram w/ 2 branches and 17 members at h = 64.5]
#&gt;      |  |  |  |--[dendrogram w/ 2 branches and 13 members at h = 56.4]
#&gt;      |  |  |  |  |--[dendrogram w/ 2 branches and 10 members at h = 47.2]
#&gt;      |  |  |  |  |  |--[dendrogram w/ 2 branches and 2 members at h = 28.1]
#&gt;      |  |  |  |  |  |  |--leaf "Alaska" 
#&gt;      |  |  |  |  |  |  `--leaf "Michigan" 
#&gt;      |  |  |  |  |  `--[dendrogram w/ 2 branches and 8 members at h = 39.2]
#&gt;      |  |  |  |  |     |--[dendrogram w/ 2 branches and 5 members at h = 36.8]
#&gt;      |  |  |  |  |     |  |--[dendrogram w/ 2 branches and 3 members at h = 32.9]
#&gt;      |  |  |  |  |     |  |  |--[dendrogram w/ 2 branches and 2 members at h = 19.4]
#&gt;      |  |  |  |  |     |  |  |  |--leaf "Connecticut" 
#&gt;      |  |  |  |  |     |  |  |  `--leaf "New York" 
#&gt;      |  |  |  |  |     |  |  `--leaf "New Hampshire" 
#&gt;      |  |  |  |  |     |  `--[dendrogram w/ 2 branches and 2 members at h = 20.2]
#&gt;      |  |  |  |  |     |     |--leaf "Indiana" 
#&gt;      |  |  |  |  |     |     `--leaf "Ohio" 
#&gt;      |  |  |  |  |     `--[dendrogram w/ 2 branches and 3 members at h = 25.3]
#&gt;      |  |  |  |  |        |--[dendrogram w/ 2 branches and 2 members at h = 20.9]
#&gt;      |  |  |  |  |        |  |--leaf "Illinois" 
#&gt;      |  |  |  |  |        |  `--leaf "New Jersey" 
#&gt;      |  |  |  |  |        `--leaf "Pennsylvania" 
#&gt;      |  |  |  |  `--[dendrogram w/ 2 branches and 3 members at h = 42.2]
#&gt;      |  |  |  |     |--leaf "Minnesota" 
#&gt;      |  |  |  |     `--[dendrogram w/ 2 branches and 2 members at h = 33.7]
#&gt;      |  |  |  |        |--leaf "North Dakota" 
#&gt;      |  |  |  |        `--leaf "Wisconsin" 
#&gt;      |  |  |  `--[dendrogram w/ 2 branches and 4 members at h = 37.5]
#&gt;      |  |  |     |--[dendrogram w/ 2 branches and 2 members at h = 26.2]
#&gt;      |  |  |     |  |--leaf "Iowa" 
#&gt;      |  |  |     |  `--leaf "South Dakota" 
#&gt;      |  |  |     `--[dendrogram w/ 2 branches and 2 members at h = 25.9]
#&gt;      |  |  |        |--leaf "Kansas" 
#&gt;      |  |  |        `--leaf "Nebraska" 
#&gt;      |  |  `--[dendrogram w/ 2 branches and 14 members at h = 70.5]
#&gt;      |  |     |--[dendrogram w/ 2 branches and 8 members at h = 48]
#&gt;      |  |     |  |--[dendrogram w/ 2 branches and 4 members at h = 43.4]
#&gt;      |  |     |  |  |--[dendrogram w/ 2 branches and 3 members at h = 27.8]
#&gt;      |  |     |  |  |  |--[dendrogram w/ 2 branches and 2 members at h = 23.4]
#&gt;      |  |     |  |  |  |  |--leaf "Arizona" 
#&gt;      |  |     |  |  |  |  `--leaf "Nevada" 
#&gt;      |  |     |  |  |  `--leaf "Montana" 
#&gt;      |  |     |  |  `--leaf "Oklahoma" 
#&gt;      |  |     |  `--[dendrogram w/ 2 branches and 4 members at h = 43.7]
#&gt;      |  |     |     |--leaf "Colorado" 
#&gt;      |  |     |     `--[dendrogram w/ 2 branches and 3 members at h = 31.2]
#&gt;      |  |     |        |--[dendrogram w/ 2 branches and 2 members at h = 17.2]
#&gt;      |  |     |        |  |--leaf "Idaho" 
#&gt;      |  |     |        |  `--leaf "Wyoming" 
#&gt;      |  |     |        `--leaf "Utah" 
#&gt;      |  |     `--[dendrogram w/ 2 branches and 6 members at h = 54.3]
#&gt;      |  |        |--[dendrogram w/ 2 branches and 3 members at h = 33.2]
#&gt;      |  |        |  |--leaf "California" 
#&gt;      |  |        |  `--[dendrogram w/ 2 branches and 2 members at h = 22.2]
#&gt;      |  |        |     |--leaf "Oregon" 
#&gt;      |  |        |     `--leaf "Washington" 
#&gt;      |  |        `--[dendrogram w/ 2 branches and 3 members at h = 35.1]
#&gt;      |  |           |--[dendrogram w/ 2 branches and 2 members at h = 21.1]
#&gt;      |  |           |  |--leaf "Missouri" 
#&gt;      |  |           |  `--leaf "New Mexico" 
#&gt;      |  |           `--leaf "West Virginia" 
#&gt;      |  `--[dendrogram w/ 2 branches and 6 members at h = 66.8]
#&gt;      |     |--[dendrogram w/ 2 branches and 3 members at h = 43.4]
#&gt;      |     |  |--leaf "Delaware" 
#&gt;      |     |  `--[dendrogram w/ 2 branches and 2 members at h = 33.5]
#&gt;      |     |     |--leaf "Kentucky" 
#&gt;      |     |     `--leaf "Maryland" 
#&gt;      |     `--[dendrogram w/ 2 branches and 3 members at h = 30.2]
#&gt;      |        |--[dendrogram w/ 2 branches and 2 members at h = 29.5]
#&gt;      |        |  |--leaf "North Carolina" 
#&gt;      |        |  `--leaf "Tennessee" 
#&gt;      |        `--leaf "Virginia" 
#&gt;      `--[dendrogram w/ 2 branches and 5 members at h = 83.1]
#&gt;         |--[dendrogram w/ 2 branches and 4 members at h = 55.4]
#&gt;         |  |--[dendrogram w/ 2 branches and 2 members at h = 32.8]
#&gt;         |  |  |--leaf "Hawaii" 
#&gt;         |  |  `--leaf "Maine" 
#&gt;         |  `--[dendrogram w/ 2 branches and 2 members at h = 22.6]
#&gt;         |     |--leaf "Massachusetts" 
#&gt;         |     `--leaf "Rhode Island" 
#&gt;         `--leaf "Vermont" </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>agriculture</span>)

<span class='co'>## Plot similar to Figure 7 in ref</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>agnes</span>(<span class='no'>agriculture</span>), <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>agnes</span>(<span class='no'>agriculture</span>))</div><div class='img'><img src='agnes-4.png' alt='' width='700' height='433' /></div><div class='img'><img src='agnes-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>animals</span>)
<span class='no'>aa.a</span>  <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>animals</span>) <span class='co'># default method = "average"</span>
<span class='no'>aa.ga</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>animals</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"gaverage"</span>)
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfcol</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>mgp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, <span class='fl'>0.6</span>, <span class='fl'>0</span>), <span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>+ <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>1</span>)),
          <span class='kw'>cex.main</span><span class='kw'>=</span><span class='fl'>0.8</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>aa.a</span>,  <span class='kw'>which.plot</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>aa.ga</span>, <span class='kw'>which.plot</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='agnes-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)
<span class='co'>## equivalence</span>
<span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span>( <span class='co'>## below show  ave == gave(0); here  ave == gave(c(1,1,0,0)):</span>
  <span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>aa.a</span> [<span class='no'>iC</span>], <span class='fu'>agnes</span>(<span class='no'>animals</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"gave"</span>, <span class='kw'>par.meth</span><span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>))[<span class='no'>iC</span>]),
  <span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>aa.ga</span>[<span class='no'>iC</span>], <span class='fu'>agnes</span>(<span class='no'>animals</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"gave"</span>, <span class='kw'>par.meth</span><span class='kw'>=</span> -<span class='fl'>0.1</span>)[<span class='no'>iC</span>]),
  <span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>aa.ga</span>[<span class='no'>iC</span>], <span class='fu'>agnes</span>(<span class='no'>animals</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"gav"</span>, <span class='kw'>par.m</span><span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.1</span>,<span class='fl'>1.1</span>,-<span class='fl'>0.1</span>,<span class='fl'>0</span>))[<span class='no'>iC</span>]))


<span class='co'>## Show how "gaverage" is a "generalized average":</span>
<span class='no'>aa.ga.0</span> <span class='kw'>&lt;-</span> <span class='fu'>agnes</span>(<span class='no'>animals</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"gaverage"</span>, <span class='kw'>par.method</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>aa.ga.0</span>[<span class='no'>iC</span>], <span class='no'>aa.a</span>[<span class='no'>iC</span>]))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#background">BACKGROUND</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Method <code>"gaverage"</code> has been contributed by Pierre Roudier, Landcare
  Research, New Zealand.</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Martin Maechler, Peter Rousseeuw, Anja Struyf, Mia Hubert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


