<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • data.table</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Changelog" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">data.table</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.12.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/datatable-benchmarking.html">Benchmarking data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-faq.html">Frequently Asked Questions about data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-importing.html">Importing data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-intro.html">Introduction to data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-keys-fast-subset.html">Keys and fast binary search based subset</a>
    </li>
    <li>
      <a href="../articles/datatable-reference-semantics.html">Reference semantics</a>
    </li>
    <li>
      <a href="../articles/datatable-reshape.html">Efficient reshaping using data.tables</a>
    </li>
    <li>
      <a href="../articles/datatable-sd-usage.html">Using .SD for Data Analysis</a>
    </li>
    <li>
      <a href="../articles/datatable-secondary-indices-and-auto-indexing.html">Secondary indices and auto indexing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Rdatatable/data.table">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/Rdatatable/data.table/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="data-table-v1-12-6" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-12-6" class="anchor"></a><small> 2019-10-18 </small>data.table <a href="https://github.com/Rdatatable/data.table/milestone/18?closed=1">v1.12.6</a>
</h1>
<div id="bug-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p><code><a href="../reference/shift.html">shift()</a></code> on a <code>nanotime</code> with the default <code>fill=NA</code> now fills a <code>nanotime</code> missing value correctly, <a href="https://github.com/Rdatatable/data.table/issues/3945"><a href='https://github.com/Rdatatable/data.table/issues/3945'>#3945</a></a>. Thanks to <a href='https://github.com/mschubmehl'>@mschubmehl</a> for reporting and fixing in PR <a href="https://github.com/Rdatatable/data.table/pull/3942"><a href='https://github.com/Rdatatable/data.table/issues/3942'>#3942</a></a>.</p></li>
<li><p>Compilation failed on CRAN’s MacOS due to an older version of <code>zlib.h/zconf.h</code> which did not have <code>z_const</code> defined, <a href="https://github.com/Rdatatable/data.table/issues/3939"><a href='https://github.com/Rdatatable/data.table/issues/3939'>#3939</a></a>. Other open-source projects unrelated to R have experienced this problem on MacOS too. We have followed the common practice of removing <code>z_const</code> to support the older <code>zlib</code> versions, and data.table’s release procedures have gained a <code>grep</code> to ensure <code>z_const</code> isn’t used again by accident in future. The library <code>zlib</code> is used for <code>fwrite</code>’s new feature of multithreaded compression on-the-fly; see item 3 of 1.12.4 below.</p></li>
<li><p>A runtime error in <code>fwrite</code>’s compression, but only observed so far on Solaris 10 32bit with zlib 1.2.8 (Apr 2013), <a href="https://github.com/Rdatatable/data.table/issues/3931"><a href='https://github.com/Rdatatable/data.table/issues/3931'>#3931</a></a>: <code>Error -2: one or more threads failed to allocate buffers or there was a compression error.</code> In case it happens again, this area has been made more robust and the error more detailed. As is often the case, investigating the Solaris problem revealed secondary issues in the same area of the code. In this case, some <code>%d</code> in verbose output should have been <code>%lld</code>. This obliquity that CRAN’s Solaris provides is greatly appreciated.</p></li>
<li><p>A leak could occur in the event of an unsupported column type error, or if working memory could only partially be allocated; <a href="https://github.com/Rdatatable/data.table/issues/3940"><a href='https://github.com/Rdatatable/data.table/issues/3940'>#3940</a></a>. Found thanks to <code>clang</code>’s Leak Sanitizer (prompted by CRAN’s diligent use of latest tools), and two tests in the test suite which tested the unsupported-type error.</p></li>
</ol>
</div>
<div id="notes" class="section level2">
<h2 class="hasAnchor">
<a href="#notes" class="anchor"></a>NOTES</h2>
<ol>
<li>Many thanks to Kurt Hornik for fixing R’s S3 dispatch of <code>rbind</code> and <code>cbind</code> methods, <a href="https://github.com/Rdatatable/data.table/issues/3948"><a href='https://github.com/Rdatatable/data.table/issues/3948'>#3948</a></a>. With <code>R&gt;=4.0.0</code> (current R-devel), <code>data.table</code> now registers the S3 methods <code>cbind.data.table</code> and <code>rbind.data.table</code>, and no longer applies the workaround documented in FAQ 2.24.</li>
</ol>
</div>
</div>
    <div id="data-table-v1-12-4-03-oct-2019" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-12-4-03-oct-2019" class="anchor"></a><small> 2019-10-03 </small>data.table <a href="https://github.com/Rdatatable/data.table/milestone/16?closed=1">v1.12.4</a> (03 Oct 2019)</h1>
<div id="new-features" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li><p><code><a href="../reference/rleid.html">rleid()</a></code> functions now support long vectors (length &gt; 2 billion).</p></li>
<li>
<code><a href="../reference/fread.html">fread()</a></code>:
<ul>
<li>now skips embedded <code>NUL</code> (<code>\0</code>), <a href="https://github.com/Rdatatable/data.table/issues/3400"><a href='https://github.com/Rdatatable/data.table/issues/3400'>#3400</a></a>. Thanks to Marcus Davy for reporting with examples, Roy Storey for the initial PR, and Bingjie Qian for testing this feature on a very complicated real-world file.</li>
<li>
<code>colClasses</code> now supports <code>'complex'</code>, <code>'raw'</code>, <code>'Date'</code>, <code>'POSIXct'</code>, and user-defined classes (so long as an <code>as.</code> method exists), <a href="https://github.com/Rdatatable/data.table/issues/491"><a href='https://github.com/Rdatatable/data.table/issues/491'>#491</a></a> <a href="https://github.com/Rdatatable/data.table/issues/1634"><a href='https://github.com/Rdatatable/data.table/issues/1634'>#1634</a></a> <a href="https://github.com/Rdatatable/data.table/issues/2610"><a href='https://github.com/Rdatatable/data.table/issues/2610'>#2610</a></a>. Any error during coercion results in a warning and the column is left as the default type (probably <code>"character"</code>). Thanks to <a href='https://github.com/hughparsonage'>@hughparsonage</a> for the PR.</li>
<li>
<code>stringsAsFactors=0.10</code> will factorize any character column containing under <code>0.10*nrow</code> unique strings, <a href="https://github.com/Rdatatable/data.table/issues/2025"><a href='https://github.com/Rdatatable/data.table/issues/2025'>#2025</a></a>. Thanks to <a href='https://github.com/hughparsonage'>@hughparsonage</a> for the PR.</li>
<li>
<code>colClasses=list(numeric=20:30, numeric="ID")</code> will apply the <code>numeric</code> type to column numbers <code>20:30</code> as before and now also column name <code>"ID"</code>; i.e. all duplicate class names are now respected rather than only the first. This need may arise when specifying some columns by name and others by number, as in this example. Thanks to <a href='https://github.com/hughparsonage'>@hughparsonage</a> for the PR.</li>
<li>gains <code>yaml</code> (default <code>FALSE</code>) and the ability to parse CSVY-formatted input files; i.e., csv files with metadata in a header formatted as YAML (<a href="http://csvy.org/" class="uri">http://csvy.org/</a>), <a href="https://github.com/Rdatatable/data.table/issues/1701"><a href='https://github.com/Rdatatable/data.table/issues/1701'>#1701</a></a>. See <code><a href="../reference/fread.html">?fread</a></code> and files in <code>/inst/tests/csvy/</code> for sample formats. Please provide feedback if you find this feature useful and would like extended capabilities. For now, consider it experimental, meaning the API/arguments may change. Thanks to <a href='https://github.com/leeper'>@leeper</a> at <a href="https://github.com/leeper/rio"><code>rio</code></a> for the inspiration and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for implementing.</li>
<li>
<code>select</code> can now be used to specify types for just the columns selected, <a href="https://github.com/Rdatatable/data.table/issues/1426"><a href='https://github.com/Rdatatable/data.table/issues/1426'>#1426</a></a>. Just like <code>colClasses</code> it can be a named vector of <code>colname=type</code> pairs, or a named <code>list</code> of <code>type=col(s)</code> pairs. For example:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="../reference/fread.html">fread</a></span>(file, <span class="dt">select=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">colD=</span><span class="st">"character"</span>,     <span class="co"># returns 2 columns: colD,colA</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                     <span class="dt">colA=</span><span class="st">"integer64"</span>))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="../reference/fread.html">fread</a></span>(file, <span class="dt">select=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">character=</span><span class="st">"colD"</span>,  <span class="co"># returns 5 columns: colD,8,9,10,colA</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                        <span class="dt">integer=</span>  <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                        <span class="dt">character=</span><span class="st">"colA"</span>))</a></code></pre></div>
<ul>
<li>gains <code>tmpdir=</code> argument which is passed to <code><a href="https://rdrr.io/r/base/tempfile.html">tempfile()</a></code> whenever a temporary file is needed. Thanks to <a href='https://github.com/mschubmehl'>@mschubmehl</a> for the PR. As before, setting <code>TMPDIR</code> (to <code>/dev/shm</code> for example) before starting the R session still works too; see <code><a href="https://rdrr.io/r/base/tempfile.html">?base::tempdir</a></code>.</li>
</ul>
</li>
<li>
<code><a href="../reference/fwrite.html">fwrite()</a></code>:
<ul>
<li>now writes compressed <code>.gz</code> files directly, <a href="https://github.com/Rdatatable/data.table/issues/2016"><a href='https://github.com/Rdatatable/data.table/issues/2016'>#2016</a></a>. Compression, like <code><a href="../reference/fwrite.html">fwrite()</a></code>, is multithreaded and compresses each chunk on-the-fly (a full size intermediate file is not created). Use a “.gz” extension, or the new <code>compress=</code> option. Many thanks to Philippe Chataignon for the significant PR. For example:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">A=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="fl">100e6</span>), <span class="dt">B=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="fl">50e6</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="../reference/fwrite.html">fwrite</a></span>(DT, <span class="st">"data.csv"</span>)      <span class="co"># 763MB; 1.3s</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="../reference/fwrite.html">fwrite</a></span>(DT, <span class="st">"data.csv.gz"</span>)   <span class="co">#   2MB; 1.6s</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="kw"><a href="../reference/fread.html">fread</a></span>(<span class="st">"data.csv.gz"</span>), DT)</a></code></pre></div>
<p>Note that compression is handled using <code>zlib</code> library. In the unlikely event of missing <code>zlib.h</code>, on a machine that is compiling <code>data.table</code> from sources, one may get <code>fwrite.c</code> compilation error <code>zlib.h: No such file or directory</code>. As of now, the easiest solution is to install missing library using <code>sudo apt install zlib1g-dev</code> (Debian/Ubuntu). Installing R (<code>r-base-dev</code>) depends on <code>zlib1g-dev</code> so this should be rather uncommon. If it happens to you please upvote related issue <a href="https://github.com/Rdatatable/data.table/issues/3872"><a href='https://github.com/Rdatatable/data.table/issues/3872'>#3872</a></a>.</p>
<ul>
<li><p>Gains <code>yaml</code> argument matching that of <code>fread</code>, <a href="https://github.com/Rdatatable/data.table/issues/3534"><a href='https://github.com/Rdatatable/data.table/issues/3534'>#3534</a></a>. See the item in <code>fread</code> for a bit more detail; here, we’d like to reiterate that feedback is appreciated in the initial phase of rollout for this feature.</p></li>
<li><p>Gains <code>bom</code> argument to add a <em>byte order mark</em> (BOM) at the beginning of the file to signal that the file is encoded in UTF-8, <a href="https://github.com/Rdatatable/data.table/issues/3488"><a href='https://github.com/Rdatatable/data.table/issues/3488'>#3488</a></a>. Thanks to Stefan Fleck for requesting and Philippe Chataignon for implementing.</p></li>
<li><p>Now supports type <code>complex</code>, <a href="https://github.com/Rdatatable/data.table/issues/3690"><a href='https://github.com/Rdatatable/data.table/issues/3690'>#3690</a></a>.</p></li>
<li><p>Gains <code>scipen</code> <a href="https://github.com/Rdatatable/data.table/issues/2020"><a href='https://github.com/Rdatatable/data.table/issues/2020'>#2020</a></a>, the number 1 most-requested feature <a href="https://github.com/Rdatatable/data.table/issues/3189"><a href='https://github.com/Rdatatable/data.table/issues/3189'>#3189</a></a>. The default is <code><a href="https://rdrr.io/r/base/options.html">getOption("scipen")</a></code> so that <code>fwrite</code> will now respect R’s option in the same way as <code>base::write.csv</code> and <code><a href="https://rdrr.io/r/base/format.html">base::format</a></code>, as expected. The parameter and option name have been kept the same as base R’s <code>scipen</code> for consistency and to aid online search. It stands for ‘scientific penalty’; i.e., the number of characters to add to the width within which non-scientific number format is used if it will fit. A high penalty essentially turns off scientific format. We believe that common practice is to use a value of 999, however, if you do use 999, because your data <em>might</em> include very long numbers such as <code>10^300</code>, <code>fwrite</code> needs to account for the worst case field width in its buffer allocation per thread. This may impact space or time. If you experience slowdowns or unacceptable memory usage, please pass <code>verbose=TRUE</code> to <code>fwrite</code>, inspect the output, and report the issue. A workaround, until we can determine the best strategy, may be to pass a smaller value to <code>scipen</code>, such as 50. We have observed that <code><a href="../reference/fwrite.html">fwrite(DT, scipen=50)</a></code> appears to write <code>10^50</code> accurately, unlike base R. However, this may be a happy accident and not apply generally. Further work may be needed in this area.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">a=</span><span class="fl">0.0001</span>, <span class="dt">b=</span><span class="dv">1000000</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="../reference/fwrite.html">fwrite</a></span>(DT)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># a,b</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># 1e-04,1e+06</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw"><a href="../reference/fwrite.html">fwrite</a></span>(DT,<span class="dt">scipen=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># a,b</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># 0.0001,1e+06</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw"><a href="../reference/fwrite.html">fwrite</a></span>(DT,<span class="dt">scipen=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co"># a,b</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co"># 0.0001,1000000</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="dv">10</span><span class="op">^</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co"># [1] 1e+50</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">scipen=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="dv">10</span><span class="op">^</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co"># [1] 100000000000000007629769841091887003294964970946560</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="kw"><a href="../reference/fwrite.html">fwrite</a></span>(<span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">A=</span><span class="dv">10</span><span class="op">^</span><span class="dv">50</span>))</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co"># A</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co"># 100000000000000000000000000000000000000000000000000</span></a></code></pre></div>
</li>
<li>
<p>Assigning to one item of a list column no longer requires the RHS to be wrapped with <code>list</code> or <code>.()</code>, <a href="https://github.com/Rdatatable/data.table/issues/950"><a href='https://github.com/Rdatatable/data.table/issues/950'>#950</a></a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span>DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">A=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">B=</span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="st">"foo"</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="op">&gt;</span><span class="st"> </span>DT</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">       A      B</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>list<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="dv">1</span><span class="op">:</span><span class="st">     </span><span class="dv">1</span>    <span class="dv">1</span>,<span class="dv">2</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="dv">2</span><span class="op">:</span><span class="st">     </span><span class="dv">2</span>    foo</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="dv">3</span><span class="op">:</span><span class="st">     </span><span class="dv">3</span>  <span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co"># The following all accomplish the same assignment:</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="er">&gt;</span><span class="st"> </span>DT[<span class="dv">2</span>, B<span class="op">:</span><span class="er">=</span>letters[<span class="dv">9</span><span class="op">:</span><span class="dv">13</span>]]           <span class="co"># was error, now works</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="op">&gt;</span><span class="st"> </span>DT[<span class="dv">2</span>, B<span class="op">:</span><span class="er">=</span>.(letters[<span class="dv">9</span><span class="op">:</span><span class="dv">13</span>])]        <span class="co"># was error, now works</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="op">&gt;</span><span class="st"> </span>DT[<span class="dv">2</span>, B<span class="op">:</span><span class="er">=</span>.(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(letters[<span class="dv">9</span><span class="op">:</span><span class="dv">13</span>]))]  <span class="co"># .(list()) was needed, still works</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="op">&gt;</span><span class="st"> </span>DT</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">       A         B</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>list<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="dv">1</span><span class="op">:</span><span class="st">     </span><span class="dv">1</span>       <span class="dv">1</span>,<span class="dv">2</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="dv">2</span><span class="op">:</span><span class="st">     </span><span class="dv">2</span> i,j,k,l,m</a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="dv">3</span><span class="op">:</span><span class="st">     </span><span class="dv">3</span>     <span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span></a></code></pre></div>
</li>
<li><p><code><a href="../reference/print.data.table.html">print.data.table()</a></code> gains an option to display the timezone of <code>POSIXct</code> columns when available, <a href="https://github.com/Rdatatable/data.table/issues/2842"><a href='https://github.com/Rdatatable/data.table/issues/2842'>#2842</a></a>. Thanks to Michael Chirico for reporting and Felipe Parages for the PR.</p></li>
<li>
<p>New functions <code>nafill</code> and <code>setnafill</code>, <a href="https://github.com/Rdatatable/data.table/issues/854"><a href='https://github.com/Rdatatable/data.table/issues/854'>#854</a></a>. Thanks to Matthieu Gomez for the request and Jan Gorecki for implementing.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/setDT.html">setDT</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="cf">function</span>(i) <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">9e6</span>), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA_real_</span>, <span class="fl">1e6</span>)))))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/object.size.html">object.size</a></span>(DT), <span class="dt">units=</span><span class="st">"GB"</span>)  ## 7.5 Gb</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">zoo<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/zoo/man/na.locf.html">na.locf</a></span>(DT, <span class="dt">na.rm=</span><span class="ot">FALSE</span>)  ## zoo           53.518s</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="../reference/openmp-utils.html">setDTthreads</a></span>(1L)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw"><a href="../reference/nafill.html">nafill</a></span>(DT, <span class="st">"locf"</span>)             ## DT 1 thread    7.562s</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw"><a href="../reference/openmp-utils.html">setDTthreads</a></span>(0L)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="../reference/nafill.html">nafill</a></span>(DT, <span class="st">"locf"</span>)             ## DT 40 threads  0.605s</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="kw"><a href="../reference/nafill.html">setnafill</a></span>(DT, <span class="st">"locf"</span>)          ## DT in-place    0.367s</a></code></pre></div>
</li>
<li><p>New variable <code>.Last.updated</code> (similar to R’s <code>.Last.value</code>) contains the number of rows affected by the most recent <code>:=</code> or <code><a href="../reference/assign.html">set()</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/1885"><a href='https://github.com/Rdatatable/data.table/issues/1885'>#1885</a></a>. For details see <code><a href="../reference/last.updated.html">?.Last.updated</a></code>.</p></li>
<li><p><code><a href="../reference/between.html">between()</a></code> and <code><a href="../reference/between.html">%between%</a></code> are faster for <code>POSIXct</code>, <a href="https://github.com/Rdatatable/data.table/issues/3519"><a href='https://github.com/Rdatatable/data.table/issues/3519'>#3519</a></a>, and now support the <code>.()</code> alias, <a href="https://github.com/Rdatatable/data.table/issues/2315"><a href='https://github.com/Rdatatable/data.table/issues/2315'>#2315</a></a>. Thanks to <a href='https://github.com/Henrik-P'>@Henrik-P</a> for the reports. There is now also support for <code>bit64</code>’s <code>integer64</code> class and more robust coercion of types, <a href="https://github.com/Rdatatable/data.table/issues/3517"><a href='https://github.com/Rdatatable/data.table/issues/3517'>#3517</a></a>. <code><a href="../reference/between.html">between()</a></code> gains <code>check=</code> which checks <code><a href="https://rdrr.io/r/base/any.html">any(lower&gt;upper)</a></code>; off by default for speed in particular for type character.</p></li>
<li><p>New convenience functions <code><a href="../reference/like.html">%ilike%</a></code> and <code><a href="../reference/like.html">%flike%</a></code> which map to new <code><a href="../reference/like.html">like()</a></code> arguments <code>ignore.case</code> and <code>fixed</code> respectively, <a href="https://github.com/Rdatatable/data.table/issues/3333"><a href='https://github.com/Rdatatable/data.table/issues/3333'>#3333</a></a>. <code><a href="../reference/like.html">%ilike%</a></code> is for case-insensitive pattern matching. <code><a href="../reference/like.html">%flike%</a></code> is for more efficient matching of fixed strings. Thanks to <a href='https://github.com/andreasLD'>@andreasLD</a> for providing most of the core code.</p></li>
<li><p><code>on=.NATURAL</code> (or alternatively <code>X[on=Y]</code> <a href="https://github.com/Rdatatable/data.table/issues/3621"><a href='https://github.com/Rdatatable/data.table/issues/3621'>#3621</a></a>) joins two tables on their common column names, so called <em>natural join</em>, <a href="https://github.com/Rdatatable/data.table/issues/629"><a href='https://github.com/Rdatatable/data.table/issues/629'>#629</a></a>. Thanks to David Kulp for request. As before, when <code>on=</code> is not provided, <code>X</code> must have a key and the key columns are used to join (like rownames, but multi-column and multi-type).</p></li>
<li><p><code>as.data.table</code> gains <code>key</code> argument mirroring its use in <code>setDT</code> and <code>data.table</code>, <a href="https://github.com/Rdatatable/data.table/issues/890"><a href='https://github.com/Rdatatable/data.table/issues/890'>#890</a></a>. As a byproduct, the arguments of <code>as.data.table.array</code> have changed order, which could affect code relying on positional arguments to this method. Thanks <a href='https://github.com/cooldome'>@cooldome</a> for the suggestion and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for implementation.</p></li>
<li><p><code>merge.data.table</code> is now exported, <a href="https://github.com/Rdatatable/data.table/pull/2618"><a href='https://github.com/Rdatatable/data.table/issues/2618'>#2618</a></a>. We realize that S3 methods should not ordinarily be exported. Rather, the method should be invoked via S3 dispatch. But users continue to request its export, perhaps because of intricacies relating to the fact that data.table inherits from data.frame, there are two arguments to <code><a href="../reference/merge.html">merge()</a></code> but S3 dispatch applies just to the first, and a desire to explicitly call <code><a href="../reference/merge.html">data.table::merge.data.table</a></code> from package code. Thanks to <a href='https://github.com/AndreMikulec'>@AndreMikulec</a> for the most recent request.</p></li>
<li><p>New rolling function to calculate rolling sum has been implemented and exported, see <code><a href="../reference/froll.html">?frollsum</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/2778"><a href='https://github.com/Rdatatable/data.table/issues/2778'>#2778</a></a>.</p></li>
<li><p><code>setkey</code> to an existing index now uses the index, <a href="https://github.com/Rdatatable/data.table/issues/2889"><a href='https://github.com/Rdatatable/data.table/issues/2889'>#2889</a></a>. Thanks to <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for suggesting and <a href='https://github.com/saraswatmks'>@saraswatmks</a> for the PR.</p></li>
<li><p><code>DT[order(col)[1:5], ...]</code> (i.e. where <code>i</code> is a compound expression involving <code><a href="../reference/setorder.html">order()</a></code>) is now optimized to use <code>data.table</code>’s multithreaded <code>forder</code>, <a href="https://github.com/Rdatatable/data.table/issues/1921"><a href='https://github.com/Rdatatable/data.table/issues/1921'>#1921</a></a>. This example is not a fully optimal top-N query since the full ordering is still computed. The improvement is that the call to <code><a href="../reference/setorder.html">order()</a></code> is computed faster for any <code>i</code> expression using <code>order</code>.</p></li>
<li><p><code>as.data.table</code> now unpacks columns in a <code>data.frame</code> which are themselves a <code>data.frame</code> or <code>matrix</code>. This need arises when parsing JSON, a corollary in <a href="https://github.com/Rdatatable/data.table/issues/3369#issuecomment-462662752"><a href='https://github.com/Rdatatable/data.table/issues/3369'>#3369</a></a>. Bug fix 19 in v1.12.2 (see below) added a helpful error (rather than segfault) to detect such invalid <code>data.table</code>, and promised that <code><a href="../reference/as.data.table.html">as.data.table()</a></code> would unpack these columns in the next release (i.e. this release) so that the invalid <code>data.table</code> is not created in the first place. Further, <code>setDT</code> now warns if it observes such columns and suggests using <code>as.data.table</code> instead, <a href="https://github.com/Rdatatable/data.table/issues/3760"><a href='https://github.com/Rdatatable/data.table/issues/3760'>#3760</a></a>.</p></li>
<li>
<p><code>CJ</code> has been ported to C and parallelized, thanks to a PR by Michael Chirico, <a href="https://github.com/Rdatatable/data.table/pull/3596"><a href='https://github.com/Rdatatable/data.table/issues/3596'>#3596</a></a>. All types benefit, but, as in many <code>data.table</code> operations, factors benefit more than character.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># default 4 threads on a laptop with 16GB RAM and 8 logical CPU</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">ids =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/outer.html">outer</a></span>(LETTERS, LETTERS, paste0))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>( <span class="kw"><a href="../reference/J.html">CJ</a></span>(ids, <span class="dv">1</span><span class="op">:</span><span class="dv">500000</span>) )  <span class="co"># 3.9GB; 340m rows</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#   user  system elapsed (seconds)</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#  3.000   0.817   3.798  # was</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#  1.800   0.832   2.190  # now</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># ids = as.factor(ids)</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>( <span class="kw"><a href="../reference/J.html">CJ</a></span>(ids, <span class="dv">1</span><span class="op">:</span><span class="dv">500000</span>) )  <span class="co"># 2.6GB; 340m rows</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#   user  system elapsed (seconds)</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#  1.779   0.534   2.293  # was</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#  0.357   0.763   0.292  # now</span></a></code></pre></div>
</li>
<li>
<p>New function <code><a href="../reference/coalesce.html">fcoalesce(...)</a></code> has been written in C, and is multithreaded for <code>numeric</code> and <code>factor</code>. It replaces missing values according to a prioritized list of candidates (as per SQL COALESCE, <code><a href="https://dplyr.tidyverse.org/reference/coalesce.html">dplyr::coalesce</a></code>, and <code>hutils::coalesce</code>), <a href="https://github.com/Rdatatable/data.table/issues/3424"><a href='https://github.com/Rdatatable/data.table/issues/3424'>#3424</a></a>. It accepts any number of vectors in several forms. For example, given three vectors <code>x</code>, <code>y</code>, and <code>z</code>, where each <code>NA</code> in <code>x</code> is to be replaced by the corresponding value in <code>y</code> if that is non-NA, else the corresponding value in <code>z</code>, the following equivalent forms are all accepted: <code><a href="../reference/coalesce.html">fcoalesce(x,y,z)</a></code>, <code><a href="../reference/coalesce.html">fcoalesce(x,list(y,z))</a></code>, and <code><a href="../reference/coalesce.html">fcoalesce(list(x,y,z))</a></code>. Being a new function, its behaviour is subject to change particularly for type <code>list</code>, <a href="https://github.com/Rdatatable/data.table/issues/3712"><a href='https://github.com/Rdatatable/data.table/issues/3712'>#3712</a></a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># default 4 threads on a laptop with 16GB RAM and 8 logical CPU</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">N =<span class="st"> </span><span class="fl">100e6</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dv">5</span>, {x=<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(N); x[<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(N, N<span class="op">/</span><span class="dv">2</span>)]=<span class="ot">NA</span>; x}, <span class="dt">simplify=</span><span class="ot">FALSE</span>)  <span class="co"># 2GB</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">y1 =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(dplyr<span class="op">::</span>coalesce, x)<span class="er">)</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">y2 =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(hutils<span class="op">::</span>coalesce, x)<span class="er">)</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">y3 =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(data.table<span class="op">::</span>fcoalesce, x)<span class="er">)</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#   user  system elapsed (seconds)</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#  4.935   1.876   6.810  # dplyr::coalesce</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#  3.122   0.831   3.956  # hutils::coalesce</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#  0.915   0.099   0.379  # data.table::fcoalesce</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(y1,y2) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(y1,y3)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co"># TRUE</span></a></code></pre></div>
</li>
<li><p>Type <code>complex</code> is now supported by <code>setkey</code>, <code>setorder</code>, <code>:=</code>, <code>by=</code>, <code>keyby=</code>, <code>shift</code>, <code>dcast</code>, <code>frank</code>, <code>rowid</code>, <code>rleid</code>, <code>CJ</code>, <code>fcoalesce</code>, <code>unique</code>, and <code>uniqueN</code>, <a href="https://github.com/Rdatatable/data.table/issues/3690"><a href='https://github.com/Rdatatable/data.table/issues/3690'>#3690</a></a>. Thanks to Gareth Ward and Elio Campitelli for their reports and input. Sorting <code>complex</code> is achieved the same way as base R; i.e., first by the real part then by the imaginary part (as if the <code>complex</code> column were two separate columns of <code>double</code>). There is no plan to support joining/merging on <code>complex</code> columns until a user demonstrates a need for that.</p></li>
<li><p><code>setkey</code>, <code>[key]by=</code> and <code>on=</code> in verbose mode (<code><a href="https://rdrr.io/r/base/options.html">options(datatable.verbose=TRUE)</a></code>) now detect any columns inheriting from <code>Date</code> which are stored as 8 byte double, test if any fractions are present, and if not suggest using a 4 byte integer instead (such as <code><a href="../reference/IDateTime.html">data.table::IDate</a></code>) to save space and time, <a href="https://github.com/Rdatatable/data.table/issues/1738"><a href='https://github.com/Rdatatable/data.table/issues/1738'>#1738</a></a>. In future this could be upgraded to <code>message</code> or <code>warning</code> depending on feedback.</p></li>
<li>
<p>New function <code><a href="../reference/fifelse.html">fifelse(test, yes, no, na)</a></code> has been implemented in C by Morgan Jacob, <a href="https://github.com/Rdatatable/data.table/issues/3657"><a href='https://github.com/Rdatatable/data.table/issues/3657'>#3657</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/3753"><a href='https://github.com/Rdatatable/data.table/issues/3753'>#3753</a></a>. It is comparable to <code><a href="https://rdrr.io/r/base/ifelse.html">base::ifelse</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">dplyr::if_else</a></code>, <code>hutils::if_else</code>, and (forthcoming) <a href="https://vctrs.r-lib.org/articles/stability.html#ifelse"><code>vctrs::if_else()</code></a>. It returns a vector of the same length as <code>test</code> but unlike <code><a href="https://rdrr.io/r/base/ifelse.html">base::ifelse</a></code> the output type is consistent with those of <code>yes</code> and <code>no</code>. Please see <code><a href="../reference/fifelse.html">?data.table::fifelse</a></code> for more details.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># default 4 threads on a laptop with 16GB RAM and 8 logical CPU</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>), <span class="fl">3e8</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)  <span class="co"># 1GB</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  base<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(x, 7L, 11L),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span>(x, 7L, 11L),</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  hutils<span class="op">::</span><span class="kw">if_else</span>(x, 7L, 11L),</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  data.table<span class="op">::</span><span class="kw">fifelse</span>(x, 7L, 11L),</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  <span class="dt">times =</span> 5L, <span class="dt">unit=</span><span class="st">"s"</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co"># Unit: seconds</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#                            expr  min  med  max neval</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#        base::ifelse(x, 7L, 11L)  8.5  8.6  8.8     5</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#      dplyr::if_else(x, 7L, 11L)  9.4  9.5  9.7     5</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#     hutils::if_else(x, 7L, 11L)  2.6  2.6  2.7     5</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co"># data.table::fifelse(x, 7L, 11L)  1.5  1.5  1.6     5  # setDTthreads(1)</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co"># data.table::fifelse(x, 7L, 11L)  0.8  0.8  0.9     5  # setDTthreads(2)</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co"># data.table::fifelse(x, 7L, 11L)  0.4  0.4  0.5     5  # setDTthreads(4)</span></a></code></pre></div>
</li>
<li><p><code>transpose</code> gains <code>keep.names=</code> and <code>make.names=</code> arguments, <a href="https://github.com/Rdatatable/data.table/issues/1886"><a href='https://github.com/Rdatatable/data.table/issues/1886'>#1886</a></a>. Previously, column names were dropped and there was no way to keep them. <code>keep.names="rn"</code> keeps the column names and puts them in the <code>"rn"</code> column of the result. Similarly, <code>make.names="rn"</code> uses column <code>"rn"</code> as the column names of the result. Both arguments are <code>NULL</code> by default for backwards compatibility. As these new arguments are new, they are subject to change in future according to community feedback. Thanks to <a href='https://github.com/ghost'>@ghost</a> for the request.</p></li>
<li><p>Added a <code>data.table</code> method for <code><a href="https://rdrr.io/r/utils/edit.html">utils::edit</a></code> to ensure a <code>data.table</code> is returned, for convenience, <a href="https://github.com/Rdatatable/data.table/issues/593"><a href='https://github.com/Rdatatable/data.table/issues/593'>#593</a></a>.</p></li>
<li><p>More efficient optimization of many columns in <code>j</code> (e.g. from <code>.SD</code>), <a href="https://github.com/Rdatatable/data.table/issues/1470"><a href='https://github.com/Rdatatable/data.table/issues/1470'>#1470</a></a>. Thanks <a href='https://github.com/Jorges1000'>@Jorges1000</a> for the report.</p></li>
<li><p><code><a href="../reference/setattr.html">setnames(DT, old, new)</a></code> now omits any <code>old==new</code> to save redundant key and index name updates, <a href="https://github.com/Rdatatable/data.table/issues/3783"><a href='https://github.com/Rdatatable/data.table/issues/3783'>#3783</a></a>. <code><a href="../reference/setattr.html">setnames(DT, new)</a></code> (i.e. not providing <code>old</code>) already omitted any column name updates where <code>names(DT)==new</code>; e.g. <code><a href="../reference/setattr.html">setnames(DT, gsub('^_', '', names(DT)))</a></code> exits early if no columns start with <code>_</code>.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/Extract.html">[[</a></code> by group is now optimized for regular vectors (not type list), <a href="https://github.com/Rdatatable/data.table/issues/3209"><a href='https://github.com/Rdatatable/data.table/issues/3209'>#3209</a></a>. Thanks <a href='https://github.com/renkun-ken'>@renkun-ken</a> for the suggestion. <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> by group was already optimized. Please file a feature request if you would like this optimization for list columns.</p></li>
<li>
<p>New function <code>frollapply</code> for rolling computation of arbitrary R functions (caveat: input <code>x</code> is coerced to numeric beforehand, and the function must return a scalar numeric value). The API is consistent to extant rolling functions <code>frollmean</code> and <code>frollsum</code>; note that it will generally be slower than those functions because (1) the known functions use our optimized internal C implementation and (2) there is no thread-safe API to R’s C <code>eval</code>. Nevertheless <code>frollapply</code> is faster than corresponding <code>base</code>-only and <code>zoo</code> versions:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">108</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">1e6</span>); n =<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">base_rollapply =<span class="st"> </span><span class="cf">function</span>(x, n, FUN) {</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  nx =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  ans =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">NA_real_</span>, nx)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  <span class="cf">for</span> (i <span class="cf">in</span> n<span class="op">:</span>nx) ans[i] =<span class="st"> </span><span class="kw">FUN</span>(x[(i<span class="op">-</span>n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>i])</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">  ans</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="kw">base_rollapply</span>(x, n, mean))</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(zoo<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/zoo/man/rollapply.html">rollapplyr</a></span>(x, n, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(x), <span class="dt">fill=</span><span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(zoo<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/zoo/man/rollmean.html">rollmeanr</a></span>(x, n, <span class="dt">fill=</span><span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="kw"><a href="../reference/froll.html">frollapply</a></span>(x, n, mean))</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(<span class="kw"><a href="../reference/froll.html">frollmean</a></span>(x, n))</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">### fun             mean     sum  median</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co"># base_rollapply   8.815   5.151  60.175</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co"># zoo::rollapply  34.373  27.837  88.552</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co"># zoo::roll[fun]   0.215   0.185      NA   ## median not fully supported</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co"># frollapply       5.404   1.419  56.475</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co"># froll[fun]       0.003   0.002      NA   ## median not yet supported</span></a></code></pre></div>
</li>
<li>
<p><code><a href="../reference/setattr.html">setnames()</a></code> now accepts functions in <code>old=</code> and <code>new=</code>, <a href="https://github.com/Rdatatable/data.table/issues/3703"><a href='https://github.com/Rdatatable/data.table/issues/3703'>#3703</a></a>. Thanks <a href='https://github.com/smingerson'>@smingerson</a> for the feature request and <a href='https://github.com/shrektan'>@shrektan</a> for the PR.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">a=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">b=</span><span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">c=</span><span class="dv">7</span><span class="op">:</span><span class="dv">9</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/setattr.html">setnames</a></span>(DT, toupper)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(DT)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># [1] "A" "B" "C"</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw"><a href="../reference/setattr.html">setnames</a></span>(DT, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>), tolower)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(DT)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co"># [1] "a" "B" "c"</span></a></code></pre></div>
</li>
<li><p><code>:=</code> and <code><a href="../reference/assign.html">set()</a></code> now use zero-copy type coercion. Accordingly, <code>DT[..., integerColumn:=0]</code> and <code><a href="../reference/assign.html">set(DT,i,j,0)</a></code> no longer warn about the <code>0</code> (‘numeric’) needing to be <code>0L</code> (‘integer’) because there is no longer any time or space used for this coercion. The old long warning was off-putting to new users (“what and why L?”), whereas advanced users appreciated the old warning so they could avoid the coercion. Although the time and space for one coercion in a single call is unmeasurably small, when placed in a loop the small overhead of any allocation on R’s heap could start to become noticeable (more so for <code><a href="../reference/assign.html">set()</a></code> whose purpose is low-overhead looping). Further, when assigning a value across columns of varying types, it could be inconvenient to supply the correct type for every column. Hence, zero-copy coercion was introduced to satisfy all these requirements. A warning is still issued, as before, when fractional data is discarded; e.g. when 3.14 is assigned to an integer column. Zero-copy coercion applies to length&gt;1 vectors as well as length-1 vectors.</p></li>
</ol>
</div>
<div id="bug-fixes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-1" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p><code>first</code>, <code>last</code>, <code>head</code> and <code>tail</code> by group no longer error in some cases, <a href="https://github.com/Rdatatable/data.table/issues/2030"><a href='https://github.com/Rdatatable/data.table/issues/2030'>#2030</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3462"><a href='https://github.com/Rdatatable/data.table/issues/3462'>#3462</a></a>. Thanks to <a href='https://github.com/franknarf1'>@franknarf1</a> for reporting.</p></li>
<li><p><code>keyby=colName</code> could use the wrong index and return incorrect results if both <code>colName</code> and <code>colNameExtra</code> (where <code>colName</code> is a leading subset of characters of <code>colNameExtra</code>) are column names and an index exists on <code>colNameExtra</code>, <a href="https://github.com/Rdatatable/data.table/issues/3498"><a href='https://github.com/Rdatatable/data.table/issues/3498'>#3498</a></a>. Thanks to Xianying Tan for the detailed report and pinpointing the source line at fault.</p></li>
<li><p>A missing item in <code>j</code> such as <code>j=.(colA, )</code> now gives a helpful error (<code>Item 2 of the .() or list() passed to j is missing</code>) rather than the unhelpful error <code>argument "this_jsub" is missing, with no default</code> (v1.12.2) or <code>argument 2 is empty</code> (v1.12.0 and before), <a href="https://github.com/Rdatatable/data.table/issues/3507"><a href='https://github.com/Rdatatable/data.table/issues/3507'>#3507</a></a>. Thanks to <a href='https://github.com/eddelbuettel'>@eddelbuettel</a> for the report.</p></li>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code> could crash when writing very long strings such as 30 million characters, <a href="https://github.com/Rdatatable/data.table/issues/2974"><a href='https://github.com/Rdatatable/data.table/issues/2974'>#2974</a></a>, and could be unstable in memory constrained environments, <a href="https://github.com/Rdatatable/data.table/issues/2612"><a href='https://github.com/Rdatatable/data.table/issues/2612'>#2612</a></a>. Thanks to <a href='https://github.com/logworthy'>@logworthy</a> and <a href='https://github.com/zachokeeffe'>@zachokeeffe</a> for reporting and Philippe Chataignon for fixing in PR <a href="https://github.com/Rdatatable/data.table/pull/3288"><a href='https://github.com/Rdatatable/data.table/issues/3288'>#3288</a></a>.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code> could crash if <code>quote=""</code> (i.e. ignore quotes), the last line is too short, and <code>fill=TRUE</code>, <a href="https://github.com/Rdatatable/data.table/pull/3524"><a href='https://github.com/Rdatatable/data.table/issues/3524'>#3524</a></a>. Thanks to Jiucang Hao for the report and reproducible example.</p></li>
<li><p>Printing could occur unexpectedly when code is run with <code>source</code>, <a href="https://github.com/Rdatatable/data.table/issues/2369"><a href='https://github.com/Rdatatable/data.table/issues/2369'>#2369</a></a>. Thanks to <a href='https://github.com/jan-glx'>@jan-glx</a> for the report and reproducible example.</p></li>
<li><p>Grouping by <code>NULL</code> on zero rows <code>data.table</code> now behaves consistently to non-zero rows <code>data.table</code>, <a href="https://github.com/Rdatatable/data.table/issues/3530"><a href='https://github.com/Rdatatable/data.table/issues/3530'>#3530</a></a>. Thanks to <a href='https://github.com/SymbolixAU'>@SymbolixAU</a> for the report and reproducible example.</p></li>
<li><p>GForce optimization of <code>median</code> did not retain the class; e.g. <code>median</code> of <code>Date</code> or <code>POSIXct</code> would return a raw number rather than retain the date class, <a href="https://github.com/Rdatatable/data.table/issues/3079"><a href='https://github.com/Rdatatable/data.table/issues/3079'>#3079</a></a>. Thanks to <a href='https://github.com/Henrik-P'>@Henrik-P</a> for reporting.</p></li>
<li><p><code>DT[, format(mean(date,""%b-%Y")), by=group]</code> could fail with <code>invalid 'trim' argument</code>, <a href="https://github.com/Rdatatable/data.table/issues/1876"><a href='https://github.com/Rdatatable/data.table/issues/1876'>#1876</a></a>. Thanks to Ross Holmberg for reporting.</p></li>
<li><p><code>externalVar=1:5; DT[, mean(externalVar), by=group]</code> could return incorrect results rather than a constant (<code>3</code> in this example) for each group, <a href="https://github.com/Rdatatable/data.table/issues/875"><a href='https://github.com/Rdatatable/data.table/issues/875'>#875</a></a>. GForce optimization was being applied incorrectly to the <code>mean</code> without realizing <code>externalVar</code> was not a column.</p></li>
<li><p><code><a href="../reference/test.data.table.html">test.data.table()</a></code> now passes in non-English R sessions, <a href="https://github.com/Rdatatable/data.table/issues/630"><a href='https://github.com/Rdatatable/data.table/issues/630'>#630</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3039"><a href='https://github.com/Rdatatable/data.table/issues/3039'>#3039</a></a>. Each test still checks that the number of warnings and/or errors produced is correct. However, a message is displayed suggesting to restart R with <code>LANGUAGE=en</code> in order to test that the text of the warning and/or error messages are as expected, too.</p></li>
<li><p>Joining a double column in <code>i</code> containing say 1.3, with an integer column in <code>x</code> containing say 1, would result in the 1.3 matching to 1, <a href="https://github.com/Rdatatable/data.table/issues/2592"><a href='https://github.com/Rdatatable/data.table/issues/2592'>#2592</a></a>, and joining a factor column to an integer column would match the factor’s integers rather than error. The type coercion logic has been revised and strengthened. Many thanks to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for reporting and fixing. Joining a character column in <code>i</code> to a factor column in <code>x</code> is now faster and retains the character column in the result rather than coercing it to factor. Joining an integer column in <code>i</code> to a double column in <code>x</code> now retains the integer type in the result rather than coercing the integers into the double type. Logical columns may now only be joined to logical columns, other than all-NA columns which are coerced to the matching column’s type. All coercions are reported in verbose mode: <code><a href="https://rdrr.io/r/base/options.html">options(datatable.verbose=TRUE)</a></code>.</p></li>
<li><p>Attempting to recycle 2 or more items into an existing <code>list</code> column now gives the intended helpful error rather than <code>Internal error: recycle length error not caught earlier.</code>, <a href="https://github.com/Rdatatable/data.table/issues/3543"><a href='https://github.com/Rdatatable/data.table/issues/3543'>#3543</a></a>. Thanks to <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for finding and reporting.</p></li>
<li><p>Subassigning using <code>$&lt;-</code> to a <code>data.table</code> embedded in a list column of a single-row <code>data.table</code> could fail, <a href="https://github.com/Rdatatable/data.table/issues/3474"><a href='https://github.com/Rdatatable/data.table/issues/3474'>#3474</a></a>. Note that <code>$&lt;-</code> is not recommended; please use <code>:=</code> instead which already worked in this case. Thanks to Jakob Richter for reporting.</p></li>
<li><p><code>rbind</code> and <code>rbindlist</code> of zero-row items now retain (again) the unused levels of any (zero-length) factor columns, <a href="https://github.com/Rdatatable/data.table/issues/3508"><a href='https://github.com/Rdatatable/data.table/issues/3508'>#3508</a></a>. This was a regression in v1.12.2 just for zero-row items. Unused factor levels were already retained for items having <code>nrow&gt;=1</code>. Thanks to Gregory Demin for reporting.</p></li>
<li><p><code>rbind</code> and <code>rbindlist</code> of an item containing an ordered factor with levels containing an <code>NA</code> (as opposed to an NA integer) could segfault, <a href="https://github.com/Rdatatable/data.table/issues/3601"><a href='https://github.com/Rdatatable/data.table/issues/3601'>#3601</a></a>. This was a a regression in v1.12.2. Thanks to Damian Betebenner for reporting. Also a related segfault when recycling a length-1 factor column, <a href="https://github.com/Rdatatable/data.table/issues/3662"><a href='https://github.com/Rdatatable/data.table/issues/3662'>#3662</a></a>.</p></li>
<li><p><code><a href="https://rdrr.io/r/utils/example.html">example(":=", local=TRUE)</a></code> now works rather than error, <a href="https://github.com/Rdatatable/data.table/issues/2972"><a href='https://github.com/Rdatatable/data.table/issues/2972'>#2972</a></a>. Thanks <a href='https://github.com/vlulla'>@vlulla</a> for the report.</p></li>
<li><p><code>rbind.data.frame</code> on <code>IDate</code> columns changed the column from <code>integer</code> to <code>double</code>, <a href="https://github.com/Rdatatable/data.table/issues/2008"><a href='https://github.com/Rdatatable/data.table/issues/2008'>#2008</a></a>. Thanks to <a href='https://github.com/rmcgehee'>@rmcgehee</a> for reporting.</p></li>
<li><p><code>merge.data.table</code> now retains any custom classes of the first argument, <a href="https://github.com/Rdatatable/data.table/issues/1378"><a href='https://github.com/Rdatatable/data.table/issues/1378'>#1378</a></a>. Thanks to <a href='https://github.com/michaelquinn32'>@michaelquinn32</a> for reopening.</p></li>
<li><p><code>c</code>, <code>seq</code> and <code>mean</code> of <code>ITime</code> objects now retain the <code>ITime</code> class via new <code>ITime</code> methods, <a href="https://github.com/Rdatatable/data.table/issues/3628"><a href='https://github.com/Rdatatable/data.table/issues/3628'>#3628</a></a>. Thanks <a href='https://github.com/UweBlock'>@UweBlock</a> for reporting. The <code>cut</code> and <code>split</code> methods for <code>ITime</code> have been removed since the default methods work, <a href="https://github.com/Rdatatable/data.table/pull/3630"><a href='https://github.com/Rdatatable/data.table/issues/3630'>#3630</a></a>.</p></li>
<li><p><code>as.data.table.array</code> now handles the case when some of the array’s dimension names are <code>NULL</code>, <a href="https://github.com/Rdatatable/data.table/issues/3636"><a href='https://github.com/Rdatatable/data.table/issues/3636'>#3636</a></a>.</p></li>
<li>
<p>Adding a <code>list</code> column using <code>cbind</code>, <code>as.data.table</code>, or <code>data.table</code> now works rather than treating the <code>list</code> as if it were a set of columns and introducing an invalid NA column name, <a href="https://github.com/Rdatatable/data.table/pull/3471"><a href='https://github.com/Rdatatable/data.table/issues/3471'>#3471</a></a>. However, please note that using <code>:=</code> to add columns is preferred.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>( <span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>,<span class="st">"b"</span>),<span class="st">"a"</span>) )</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#       V1     V2     NA   # v1.12.2 and before</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#    &lt;int&gt; &lt;char&gt; &lt;char&gt;</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># 1:     1      a      a</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co"># 2:     2      b      a</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#       V1     V2          # v1.12.4+</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#    &lt;int&gt; &lt;list&gt;</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co"># 1:     1    a,b</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co"># 2:     2      a</span></a></code></pre></div>
</li>
<li><p>Incorrect sorting/grouping results due to a bug in Intel’s <code>icc</code> compiler 2019 (Version 19.0.4.243 Build 20190416) has been worked around thanks to a report and fix by Sebastian Freundt, <a href="https://github.com/Rdatatable/data.table/issues/3647"><a href='https://github.com/Rdatatable/data.table/issues/3647'>#3647</a></a>. Please run <code><a href="../reference/test.data.table.html">data.table::test.data.table()</a></code>. If that passes, your installation does not have the problem.</p></li>
<li><p><code>column not found</code> could incorrectly occur in rare non-equi-join cases, <a href="https://github.com/Rdatatable/data.table/issues/3635"><a href='https://github.com/Rdatatable/data.table/issues/3635'>#3635</a></a>. Thanks to <a href='https://github.com/UweBlock'>@UweBlock</a> for the report.</p></li>
<li><p>Slight fix to the logic for auto-naming the <code>by</code> clause for using a custom function like <code>evaluate</code> to now be named <code>evaluate</code> instead of the name of the first symbolic argument, <a href="https://github.com/Rdatatable/data.table/issues/3758"><a href='https://github.com/Rdatatable/data.table/issues/3758'>#3758</a></a>.</p></li>
<li><p>Column binding of zero column <code>data.table</code> will now work as expected, <a href="https://github.com/Rdatatable/data.table/issues/3334"><a href='https://github.com/Rdatatable/data.table/issues/3334'>#3334</a></a>. Thanks to <a href='https://github.com/kzenstratus'>@kzenstratus</a> for the report.</p></li>
<li><p><code>integer64</code> sum-by-group is now properly optimized, <a href="https://github.com/Rdatatable/data.table/issues/1647"><a href='https://github.com/Rdatatable/data.table/issues/1647'>#1647</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/3464"><a href='https://github.com/Rdatatable/data.table/issues/3464'>#3464</a></a>. Thanks to <a href='https://github.com/mlandry22-h2o'>@mlandry22-h2o</a> for the report.</p></li>
<li><p>From v1.12.0 <code><a href="../reference/between.html">between()</a></code> and <code><a href="../reference/between.html">%between%</a></code> interpret missing values in <code>lower=</code> or <code>upper=</code> as unlimited bounds. A new parameter <code>NAbounds</code> has been added to achieve the old behaviour of returning <code>NA</code>, <a href="https://github.com/Rdatatable/data.table/issues/3522"><a href='https://github.com/Rdatatable/data.table/issues/3522'>#3522</a></a>. Thanks <a href='https://github.com/cguill95'>@cguill95</a> for reporting. This is now consistent for character input, <a href="https://github.com/Rdatatable/data.table/issues/3667"><a href='https://github.com/Rdatatable/data.table/issues/3667'>#3667</a></a> (thanks <a href='https://github.com/AnonymousBoba'>@AnonymousBoba</a>), and class <code>nanotime</code> is now supported too.</p></li>
<li><p><code>integer64</code> defined on a subset of a new column would leave “gibberish” on the remaining rows, <a href="https://github.com/Rdatatable/data.table/issues/3723"><a href='https://github.com/Rdatatable/data.table/issues/3723'>#3723</a></a>. A bug in <code>rbindlist</code> with the same root cause was also fixed, <a href="https://github.com/Rdatatable/data.table/issues/1459"><a href='https://github.com/Rdatatable/data.table/issues/1459'>#1459</a></a>. Thanks <a href='https://github.com/shrektan'>@shrektan</a> and <a href='https://github.com/jangorecki'>@jangorecki</a> for the reports.</p></li>
<li><p><code>groupingsets</code> functions now properly handle alone special symbols when using an empty set to group by, <a href="https://github.com/Rdatatable/data.table/issues/3653"><a href='https://github.com/Rdatatable/data.table/issues/3653'>#3653</a></a>. Thanks to <a href='https://github.com/Henrik-P'>@Henrik-P</a> for the report.</p></li>
<li><p>A <code>data.table</code> created using <code><a href="../reference/setDT.html">setDT()</a></code> on a <code>data.frame</code> containing identical columns referencing each other would cause <code><a href="../reference/setkey.html">setkey()</a></code> to return incorrect results, <a href="https://github.com/Rdatatable/data.table/issues/3496"><a href='https://github.com/Rdatatable/data.table/issues/3496'>#3496</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/3766"><a href='https://github.com/Rdatatable/data.table/issues/3766'>#3766</a></a>. Thanks <a href='https://github.com/kirillmayantsev'>@kirillmayantsev</a> and <a href='https://github.com/alex46015'>@alex46015</a> for reporting, and <a href='https://github.com/jaapwalhout'>@jaapwalhout</a> and <a href='https://github.com/Atrebas'>@Atrebas</a> for helping to debug and isolate the issue.</p></li>
<li><p><code>x[, round(.SD, 1)]</code> and similar operations on the whole of <code>.SD</code> could return a locked result, incorrectly preventing <code>:=</code> on the result, <a href="https://github.com/Rdatatable/data.table/issues/2245"><a href='https://github.com/Rdatatable/data.table/issues/2245'>#2245</a></a>. Thanks <a href='https://github.com/grayskripko'>@grayskripko</a> for raising.</p></li>
<li><p>Using <code>get</code>/<code>mget</code> in <code>j</code> could cause <code>.SDcols</code> to be ignored or reordered, <a href="https://github.com/Rdatatable/data.table/issues/1744"><a href='https://github.com/Rdatatable/data.table/issues/1744'>#1744</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/1965"><a href='https://github.com/Rdatatable/data.table/issues/1965'>#1965</a></a>, and <a href="https://github.com/Rdatatable/data.table/issues/2036"><a href='https://github.com/Rdatatable/data.table/issues/2036'>#2036</a></a>. Thanks <a href='https://github.com/franknarf1'>@franknarf1</a>, <a href='https://github.com/MichaelChirico'>@MichaelChirico</a>, and <a href='https://github.com/TonyBonen'>@TonyBonen</a>, for the reports.</p></li>
<li><p><code>DT[, i-1L, with=FALSE]</code> would misinterpret the minus sign and return an incorrect result, <a href="https://github.com/Rdatatable/data.table/issues/2109"><a href='https://github.com/Rdatatable/data.table/issues/2019'>#2019</a></a>. Thanks <a href='https://github.com/cguill95'>@cguill95</a> for the report.</p></li>
<li><p><code>DT[id==1, DT2[.SD, on="id"]]</code> (i.e. joining from <code>.SD</code> in <code>j</code>) could incorrectly fail in some cases due to <code>.SD</code> being locked, <a href="https://github.com/Rdatatable/data.table/issues/1926"><a href='https://github.com/Rdatatable/data.table/issues/1926'>#1926</a></a>, and when updating-on-join with factors <a href="https://github.com/Rdatatable/data.table/issues/3559"><a href='https://github.com/Rdatatable/data.table/issues/3559'>#3559</a></a> <a href="https://github.com/Rdatatable/data.table/issues/2099"><a href='https://github.com/Rdatatable/data.table/issues/2099'>#2099</a></a>. Thanks <a href='https://github.com/franknarf1'>@franknarf1</a> and <a href='https://github.com/Henrik-P'>@Henrik-P</a> for the reports and for diligently tracking use cases for almost 3 years!</p></li>
<li><p><code>as.IDate.POSIXct</code> returned <code>NA</code> for UTC times before Dec 1901 and after Jan 2038, <a href="https://github.com/Rdatatable/data.table/issues/3780"><a href='https://github.com/Rdatatable/data.table/issues/3780'>#3780</a></a>. Thanks <a href='https://github.com/gschett'>@gschett</a> for the report.</p></li>
<li><p><code>rbindlist</code> now returns correct idcols for lists with different length vectors, <a href="https://github.com/Rdatatable/data.table/issues/3785"><a href='https://github.com/Rdatatable/data.table/issues/3785'>#3785</a></a>, <a href="https://github.com/Rdatatable/data.table/pull/3786"><a href='https://github.com/Rdatatable/data.table/issues/3786'>#3786</a></a>. Thanks to <a href='https://github.com/shrektan'>@shrektan</a> for the report and fix.</p></li>
<li><p><code>DT[ , !rep(FALSE, ncol(DT)), with=FALSE]</code> correctly returns the full table, <a href="https://github.com/Rdatatable/data.table/issues/3013"><a href='https://github.com/Rdatatable/data.table/issues/3013'>#3013</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/2917"><a href='https://github.com/Rdatatable/data.table/issues/2917'>#2917</a></a>. Thanks <a href='https://github.com/alexnss'>@alexnss</a> and <a href='https://github.com/DavidArenburg'>@DavidArenburg</a> for the reports.</p></li>
<li><p><code><a href="../reference/shift.html">shift(x, 0:1, type='lead', give.names=TRUE)</a></code> uses <code>lead</code> in all returned column names, <a href="https://github.com/Rdatatable/data.table/issues/3832"><a href='https://github.com/Rdatatable/data.table/issues/3832'>#3832</a></a>. Thanks <a href='https://github.com/daynefiler'>@daynefiler</a> for the report.</p></li>
<li><p>Subtracting two <code>POSIXt</code> objects by group could lead to incorrect results because the <code>base</code> method internally calls <code>difftime</code> with <code>units='auto'</code>; <code>data.table</code> does not notice if the chosen units differ by group and only the last group’s <code>units</code> attribute was retained, <a href="https://github.com/Rdatatable/data.table/issues/3694"><a href='https://github.com/Rdatatable/data.table/issues/3694'>#3694</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/761"><a href='https://github.com/Rdatatable/data.table/issues/761'>#761</a></a>. To surmount this, we now internally force <code>units='secs'</code> on all <code>POSIXt-POSIXt</code> calls (reported when <code>verbose=TRUE</code>); generally we recommend calling <code>difftime</code> directly instead. Thanks <a href='https://github.com/oliver-oliver'>@oliver-oliver</a> and <a href='https://github.com/boethian'>@boethian</a> for the reports.</p></li>
<li><p>Using <code>get</code>/<code>mget</code> in <code>j</code> could cause <code>.SDcols</code> to be ignored or reordered, <a href="https://github.com/Rdatatable/data.table/issues/1744"><a href='https://github.com/Rdatatable/data.table/issues/1744'>#1744</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/1965"><a href='https://github.com/Rdatatable/data.table/issues/1965'>#1965</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/2036"><a href='https://github.com/Rdatatable/data.table/issues/2036'>#2036</a></a>, and <a href="https://github.com/Rdatatable/data.table/issues/2946"><a href='https://github.com/Rdatatable/data.table/issues/2946'>#2946</a></a>. Thanks <a href='https://github.com/franknarf1'>@franknarf1</a>, <a href='https://github.com/MichaelChirico'>@MichaelChirico</a>, <a href='https://github.com/TonyBonen'>@TonyBonen</a>, and Steffen J. (StackOverflow) for the reports.</p></li>
<li><p><code>DT[...,by={...}]</code> now handles expressions in <code>{</code>, <a href="https://github.com/Rdatatable/data.table/issues/3156"><a href='https://github.com/Rdatatable/data.table/issues/3156'>#3156</a></a>. Thanks to <a href='https://github.com/tdhock'>@tdhock</a> for the report.</p></li>
<li><p><code>:=</code> could change a <code>data.table</code> creation statement in the body of the function calling it, or a variable in calling scope, <a href="https://github.com/Rdatatable/data.table/issues/3890"><a href='https://github.com/Rdatatable/data.table/issues/3890'>#3890</a></a>. Many thanks to <a href='https://github.com/kirillmayantsev'>@kirillmayantsev</a> for the detailed reports.</p></li>
<li><p>Grouping could create a <code>malformed factor</code> and/or segfault when the factors returned by each group did not have identical levels, <a href="https://github.com/Rdatatable/data.table/issues/2199"><a href='https://github.com/Rdatatable/data.table/issues/2199'>#2199</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/2522"><a href='https://github.com/Rdatatable/data.table/issues/2522'>#2522</a></a>. Thanks to Václav Hausenblas, <a href='https://github.com/franknarf1'>@franknarf1</a>, <a href='https://github.com/ben519'>@ben519</a>, and <a href='https://github.com/Henrik-P'>@Henrik-P</a> for reporting.</p></li>
<li><p><code>rbindlist</code> (and printing a <code>data.table</code> with over 100 rows because that uses <code><a href="../reference/rbindlist.html">rbindlist(head, tail)</a></code>) could error with <code>malformed factor</code> for unordered factor columns containing a used <code>NA_character_</code> level, <a href="https://github.com/Rdatatable/data.table/issues/3915"><a href='https://github.com/Rdatatable/data.table/issues/3915'>#3915</a></a>. This is an unusual input for unordered factors because NA_integer_ is recommended by default in R. Thanks to <a href='https://github.com/sindribaldur'>@sindribaldur</a> for reporting.</p></li>
<li><p>Adding a <code>list</code> column containing an item of type <code>list</code> to a one row <code>data.table</code> could fail, <a href="https://github.com/Rdatatable/data.table/issues/3626"><a href='https://github.com/Rdatatable/data.table/issues/3626'>#3626</a></a>. Thanks to Jakob Richter for reporting.</p></li>
</ol>
</div>
<div id="notes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-1" class="anchor"></a>NOTES</h2>
<ol>
<li><p><code>rbindlist</code>’s <code>use.names="check"</code> now emits its message for automatic column names (<code>"V[0-9]+"</code>) too, <a href="https://github.com/Rdatatable/data.table/pull/3484"><a href='https://github.com/Rdatatable/data.table/issues/3484'>#3484</a></a>. See news item 5 of v1.12.2 below.</p></li>
<li>
<p>Adding a new column by reference using <code><a href="../reference/assign.html">set()</a></code> on a <code>data.table</code> loaded from binary file now give a more helpful error message, <a href="https://github.com/Rdatatable/data.table/issues/2996"><a href='https://github.com/Rdatatable/data.table/issues/2996'>#2996</a></a>. Thanks to Joseph Burling for reporting.</p>
<pre><code>This data.table has either been loaded from disk (e.g. using readRDS()/load()) or constructed
manually (e.g. using structure()). Please run setDT() or alloc.col() on it first (to pre-allocate
space for new columns) before adding new columns by reference to it.</code></pre>
</li>
<li><p><code>setorder</code> on a superset of a keyed <code>data.table</code>’s key now retains its key, <a href="https://github.com/Rdatatable/data.table/issues/3456"><a href='https://github.com/Rdatatable/data.table/issues/3456'>#3456</a></a>. For example, if <code>a</code> is the key of <code>DT</code>, <code><a href="../reference/setorder.html">setorder(DT, a, -v)</a></code> will leave <code>DT</code> keyed by <code>a</code>.</p></li>
<li><p>New option <code><a href="https://rdrr.io/r/base/options.html">options(datatable.quiet = TRUE)</a></code> turns off the package startup message, <a href="https://github.com/Rdatatable/data.table/issues/3489"><a href='https://github.com/Rdatatable/data.table/issues/3489'>#3489</a></a>. <code><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages()</a></code> continues to work too. Thanks to <a href='https://github.com/leobarlach'>@leobarlach</a> for the suggestion inspired by <code><a href="https://rdrr.io/r/base/options.html">options(tidyverse.quiet = TRUE)</a></code>. We don’t know of a way to make a package respect the <code>quietly=</code> option of <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> and <code><a href="https://rdrr.io/r/base/library.html">require()</a></code> because the <code>quietly=</code> isn’t passed through for use by the package’s own <code>.onAttach</code>. If you can see how to do that, please submit a patch to R.</p></li>
<li><p>When loading a <code>data.table</code> from disk (e.g. with <code>readRDS</code>), best practice is to run <code><a href="../reference/setDT.html">setDT()</a></code> on the new object to assure it is correctly allocated memory for new column pointers. Barring this, unexpected behavior can follow; for example, if you assign a new column to <code>DT</code> from a function <code>f</code>, the new columns will only be assigned within <code>f</code> and <code>DT</code> will be unchanged. The <code>verbose</code> messaging in this situation is now more helpful, <a href="https://github.com/Rdatatable/data.table/issues/1729"><a href='https://github.com/Rdatatable/data.table/issues/1729'>#1729</a></a>. Thanks <a href='https://github.com/vspinu'>@vspinu</a> for sharing his experience to spur this.</p></li>
<li><p>New vignette <em>Using <code>.SD</code> for Data Analysis</em>, a deep dive into use cases for the <code>.SD</code> variable to help illuminate this topic which we’ve found to be a sticking point for beginning and intermediate <code>data.table</code> users, <a href="https://github.com/Rdatatable/data.table/issues/3412"><a href='https://github.com/Rdatatable/data.table/issues/3412'>#3412</a></a>.</p></li>
<li><p>Added a note to <code><a href="../reference/frank.html">?frank</a></code> clarifying that ranking is being done according to C sorting (i.e., like <code>forder</code>), <a href="https://github.com/Rdatatable/data.table/issues/2328"><a href='https://github.com/Rdatatable/data.table/issues/2328'>#2328</a></a>. Thanks to <a href='https://github.com/cguill95'>@cguill95</a> for the request.</p></li>
<li><p>Historically, <code>dcast</code> and <code>melt</code> were built as enhancements to <code>reshape2</code>’s own <code>dcast</code>/<code>melt</code>. We removed dependency on <code>reshape2</code> in v1.9.6 but maintained some backward compatibility. As that package has been deprecated since December 2017, we will begin to formally complete the split from <code>reshape2</code> by removing some last vestiges. In particular we now warn when redirecting to <code>reshape2</code> methods and will later error before ultimately completing the split; see <a href="https://github.com/Rdatatable/data.table/issues/3549"><a href='https://github.com/Rdatatable/data.table/issues/3549'>#3549</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/3633"><a href='https://github.com/Rdatatable/data.table/issues/3633'>#3633</a></a>. We thank the <code>reshape2</code> authors for their original inspiration for these functions, and <a href='https://github.com/ProfFancyPants'>@ProfFancyPants</a> for testing and reporting regressions in dev which have been fixed before release.</p></li>
<li><p><code>DT[col]</code> where <code>col</code> is a column containing row numbers of itself to select, now suggests the correct syntax (<code>DT[(col)]</code> or <code>DT[DT$col]</code>), <a href="https://github.com/Rdatatable/data.table/issues/697"><a href='https://github.com/Rdatatable/data.table/issues/697'>#697</a></a>. This expands the message introduced in <a href="https://github.com/Rdatatable/data.table/issues/1884"><a href='https://github.com/Rdatatable/data.table/issues/1884'>#1884</a></a> for the case where <code>col</code> is type <code>logical</code> and <code>DT[col==TRUE]</code> is suggested.</p></li>
<li><p>The <code>datatable.old.unique.by.key</code> option has been warning for 1 year that it is deprecated: <code>... Please stop using it and pass by=key(DT) instead for clarity ...</code>. This warning is now upgraded to error as per the schedule in note 10 of v1.11.0 (May 2018), and note 1 of v1.9.8 (Nov 2016). In June 2020 the option will be removed.</p></li>
<li><p>We intend to deprecate the <code>datatable.nomatch</code> option, <a href="https://github.com/Rdatatable/data.table/pull/3578/files">more info</a>. A message is now printed upon use of the option (once per session) as a first step. It asks you to please stop using the option and to pass <code>nomatch=NULL</code> explicitly if you require inner join. Outer join (<code>nomatch=NA</code>) has always been the default because it is safer; it does not drop missing data silently. The problem is that the option is global; i.e., if a user changes the default using this option for their own use, that can change the behavior of joins inside packages that use <code>data.table</code> too. This is the only <code>data.table</code> option with this concern.</p></li>
<li><p>The test suite of 9k tests now runs with three R options on: <code>warnPartialMatchArgs</code>, <code>warnPartialMatchAttr</code>, and <code>warnPartialMatchDollar</code>. This ensures that we don’t rely on partial argument matching in internal code, for robustness and efficiency, and so that users can turn these options on for their code in production, <a href="https://github.com/Rdatatable/data.table/issues/3664"><a href='https://github.com/Rdatatable/data.table/issues/3664'>#3664</a></a>. Thanks to Vijay Lulla for the suggestion, and Michael Chirico for fixing 48 internal calls to <code><a href="https://rdrr.io/r/base/attr.html">attr()</a></code> which were missing <code>exact=TRUE</code>, for example. Thanks to R-core for adding these options to R 2.6.0 (Oct 2007).</p></li>
<li><p><code><a href="../reference/test.data.table.html">test.data.table()</a></code> could fail if the <code>datatable.integer64</code> user option was set, <a href="https://github.com/Rdatatable/data.table/issues/3683"><a href='https://github.com/Rdatatable/data.table/issues/3683'>#3683</a></a>. Thanks <a href='https://github.com/xiaguoxin'>@xiaguoxin</a> for reporting.</p></li>
<li><p>The warning message when using <code>keyby=</code> together with <code>:=</code> is clearer, <a href="https://github.com/Rdatatable/data.table/issues/2763"><a href='https://github.com/Rdatatable/data.table/issues/2763'>#2763</a></a>. Thanks to <a href='https://github.com/eliocamp'>@eliocamp</a>.</p></li>
<li><p><code>first</code> and <code>last</code> gain an explicit <code>n=1L</code> argument so that it’s clear the default is 1, and their almost identical manual pages have been merged into one.</p></li>
<li><p>Rolling functions (<code><a href="../reference/froll.html">?froll</a></code>) coerce <code>logical</code> input to <code>numeric</code> (instead of failing) to mimic the behavior of <code>integer</code> input.</p></li>
<li><p>The warning message when using <code>strptime</code> in <code>j</code> has been improved, <a href="https://github.com/Rdatatable/data.table/issues/2068"><a href='https://github.com/Rdatatable/data.table/issues/2068'>#2068</a></a>. Thanks to <a href='https://github.com/tdhock'>@tdhock</a> for the report.</p></li>
<li><p>Added a note to <code><a href="../reference/setkey.html">?setkey</a></code> clarifying that <code>setkey</code> always uses C-locale sorting (as has been noted in <code><a href="../reference/setorder.html">?setorder</a></code>). Thanks <a href='https://github.com/JBreidaks'>@JBreidaks</a> for the report in <a href="https://github.com/Rdatatable/data.table/issues/2114"><a href='https://github.com/Rdatatable/data.table/issues/2114'>#2114</a></a>.</p></li>
<li><p><code><a href="../reference/IDateTime.html">hour()</a></code>/<code><a href="../reference/IDateTime.html">minute()</a></code>/<code><a href="../reference/IDateTime.html">second()</a></code> are much faster for <code>ITime</code> input, <a href="https://github.com/Rdatatable/data.table/issues/3158"><a href='https://github.com/Rdatatable/data.table/issues/3518'>#3518</a></a>.</p></li>
<li><p>New alias <code>setalloccol</code> for <code>alloc.col</code>, <a href="https://github.com/Rdatatable/data.table/issues/3475"><a href='https://github.com/Rdatatable/data.table/issues/3475'>#3475</a></a>. For consistency with <code>set*</code> prefixes for functions that operate in-place (like <code>setkey</code>, <code>setorder</code>, etc.). <code>alloc.col</code> is not going to be deprecated but we recommend using <code>setalloccol</code>.</p></li>
<li><p><code>dcast</code> no longer emits a message when <code>value.var</code> is missing but <code>fun.aggregate</code> is explicitly set to <code>length</code> (since <code>value.var</code> is arbitrary in this case), <a href="https://github.com/Rdatatable/data.table/issues/2980"><a href='https://github.com/Rdatatable/data.table/issues/2980'>#2980</a></a>.</p></li>
<li><p>Optimized <code>mean</code> of <code>integer</code> columns no longer warns about a coercion to numeric, <a href="https://github.com/Rdatatable/data.table/issues/986"><a href='https://github.com/Rdatatable/data.table/issues/986'>#986</a></a>. Thanks <a href='https://github.com/dgrtwo'>@dgrtwo</a> for his <a href="https://youtu.be/AmE4LXPQErM?t=175">YouTube tutorial at 3:01</a> where the warning occurs.</p></li>
<li><p>Using <code>first</code> and <code>last</code> function on <code>POSIXct</code> object no longer loads <code>xts</code> namespace, <a href="https://github.com/Rdatatable/data.table/issues/3857"><a href='https://github.com/Rdatatable/data.table/issues/3857'>#3857</a></a>. <code>first</code> on empty <code>data.table</code> returns empty <code>data.table</code> now <a href="https://github.com/Rdatatable/data.table/issues/3858"><a href='https://github.com/Rdatatable/data.table/issues/3858'>#3858</a></a>.</p></li>
<li><p>Added some clarifying details about what happens when a shell command is used in <code>fread</code>, <a href="https://github.com/Rdatatable/data.table/issues/3877"><a href='https://github.com/Rdatatable/data.table/issues/3877'>#3877</a></a>. Thanks Brian for the StackOverflow question which highlighted the lack of explanation here.</p></li>
<li>
<p>We continue to encourage packages to <code>Import</code> rather than <code>Depend</code> on <code>data.table</code>, <a href="https://github.com/Rdatatable/data.table/issues/3076"><a href='https://github.com/Rdatatable/data.table/issues/3076'>#3076</a></a>. To prevent the growth rate in new packages using <code>Depend</code>, we have requested that CRAN apply a small patch we provided to prevent new submissions using <code>Depend</code>. If this is accepted, the error under <code>--as-cran</code> will be as follows. The existing 73 packages using <code>Depend</code> will continue to pass OK until they next update, at which point they will be required to change from <code>Depend</code> to <code>Import</code>.</p>
<pre><code>R CMD check &lt;pkg&gt; --as-cran
...
* checking package dependencies ... ERROR

data.table should be in Imports not Depends. Please contact its
maintainer for more information.</code></pre>
</li>
</ol>
</div>
</div>
    <div id="data-table-v1-12-2-07-apr-2019" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-12-2-07-apr-2019" class="anchor"></a><small> 2019-04-07 </small>data.table <a href="https://github.com/Rdatatable/data.table/milestone/14?closed=1">v1.12.2</a> (07 Apr 2019)</h1>
<div id="new-features-1" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-1" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li><p><code>:=</code> no longer recycles length&gt;1 RHS vectors. There was a warning when recycling left a remainder but no warning when the LHS length was an exact multiple of the RHS length (the same behaviour as base R). Consistent feedback for several years has been that recycling is more often a bug. In rare cases where you need to recycle a length&gt;1 vector, please use <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code> explicitly. Single values are still recycled silently as before. Early warning was given in <a href="https://twitter.com/MattDowle/status/1088544083499311104">this tweet</a>. The 774 CRAN and Bioconductor packages using <code>data.table</code> were tested and the maintainers of the 16 packages affected (2%) were consulted before going ahead, <a href="https://github.com/Rdatatable/data.table/pull/3310"><a href='https://github.com/Rdatatable/data.table/issues/3310'>#3310</a></a>. Upon agreement we went ahead. Many thanks to all those maintainers for already updating on CRAN, <a href="https://github.com/Rdatatable/data.table/pull/3347"><a href='https://github.com/Rdatatable/data.table/issues/3347'>#3347</a></a>.</p></li>
<li><p><code>foverlaps</code> now supports <code>type="equal"</code>, <a href="https://github.com/Rdatatable/data.table/issues/3416"><a href='https://github.com/Rdatatable/data.table/issues/3416'>#3416</a></a> and part of <a href="https://github.com/Rdatatable/data.table/issues/3002"><a href='https://github.com/Rdatatable/data.table/issues/3002'>#3002</a></a>.</p></li>
<li><p>The number of logical CPUs used by default has been reduced from 100% to 50%. The previous 100% default was reported to cause significant slow downs when other non-trivial processes were also running, <a href="https://github.com/Rdatatable/data.table/issues/3395"><a href='https://github.com/Rdatatable/data.table/issues/3395'>#3395</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3298"><a href='https://github.com/Rdatatable/data.table/issues/3298'>#3298</a></a>. Two new optional environment variables (<code>R_DATATABLE_NUM_PROCS_PERCENT</code> &amp; <code>R_DATATABLE_NUM_THREADS</code>) control this default. <code><a href="../reference/openmp-utils.html">setDTthreads()</a></code> gains <code>percent=</code> and <code><a href="../reference/openmp-utils.html">?setDTthreads</a></code> has been significantly revised. The output of <code><a href="../reference/openmp-utils.html">getDTthreads(verbose=TRUE)</a></code> has been expanded. The environment variable <code>OMP_THREAD_LIMIT</code> is now respected (<a href="https://github.com/Rdatatable/data.table/issues/3300"><a href='https://github.com/Rdatatable/data.table/issues/3300'>#3300</a></a>) in addition to <code>OMP_NUM_THREADS</code> as before.</p></li>
<li><p><code>rbind</code> and <code>rbindlist</code> now retain the position of duplicate column names rather than grouping them together <a href="https://github.com/Rdatatable/data.table/issues/3373"><a href='https://github.com/Rdatatable/data.table/issues/3373'>#3373</a></a>, fill length 0 columns (including NULL) with NA with warning <a href="https://github.com/Rdatatable/data.table/issues/1871"><a href='https://github.com/Rdatatable/data.table/issues/1871'>#1871</a></a>, and recycle length-1 columns <a href="https://github.com/Rdatatable/data.table/issues/524"><a href='https://github.com/Rdatatable/data.table/issues/524'>#524</a></a>. Thanks to Kun Ren for the requests which arose when parsing JSON.</p></li>
<li>
<p><code>rbindlist</code>’s <code>use.names=</code> default has changed from <code>FALSE</code> to <code>"check"</code>. This emits a message if the column names of each item are not identical and then proceeds as if <code>use.names=FALSE</code> for backwards compatibility; i.e., bind by column position not by column name. The <code>rbind</code> method for <code>data.table</code> already sets <code>use.names=TRUE</code> so this change affects <code>rbindlist</code> only and not <code>rbind.data.table</code>. To stack differently named columns together silently (the previous default behavior of <code>rbindlist</code>), it is now necessary to specify <code>use.names=FALSE</code> for clarity to readers of your code. Thanks to Clayton Stanley who first raised the issue <a href="http://lists.r-forge.r-project.org/pipermail/datatable-help/2014-April/002480.html">here</a>. To aid pinpointing the calls to <code>rbindlist</code> that need attention, the message can be turned to error using <code><a href="https://rdrr.io/r/base/options.html">options(datatable.rbindlist.check="error")</a></code>. This option also accepts <code>"warning"</code>, <code>"message"</code> and <code>"none"</code>. In this release the message is suppressed for default column names (<code>"V[0-9]+"</code>); the next release will emit the message for those too. In 6 months the default will be upgraded from message to warning. There are two slightly different messages. They are helpful, include context and point to this news item :</p>
<pre><code>Column %d ['%s'] of item %d is missing in item %d. Use fill=TRUE to fill with
  NA (NULL for list columns), or use.names=FALSE to ignore column names.
  See news item 5 in v1.12.2 for options to control this message.

Column %d ['%s'] of item %d appears in position %d in item %d. Set use.names=TRUE
  to match by column name, or use.names=FALSE to ignore column names.
  See news item 5 in v1.12.2 for options to control this message.</code></pre>
</li>
<li><p><code>fread</code> gains <code>keepLeadingZeros</code>, <a href="https://github.com/Rdatatable/data.table/issues/2999"><a href='https://github.com/Rdatatable/data.table/issues/2999'>#2999</a></a>. By default <code>FALSE</code> so that, as before, a field containing <code>001</code> is interpreted as the integer 1, otherwise the character string <code>"001"</code>. The default may be changed using <code><a href="https://rdrr.io/r/base/options.html">options(datatable.keepLeadingZeros=TRUE)</a></code>. Many thanks to <a href='https://github.com/marc-outins'>@marc-outins</a> for the PR.</p></li>
</ol>
</div>
<div id="bug-fixes-2" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-2" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p><code><a href="../reference/rbindlist.html">rbindlist()</a></code> of a malformed factor which is missing a levels attribute is now a helpful error rather than a cryptic error about <code>STRING_ELT</code>, <a href="https://github.com/Rdatatable/data.table/issues/3315"><a href='https://github.com/Rdatatable/data.table/issues/3315'>#3315</a></a>. Thanks to Michael Chirico for reporting.</p></li>
<li><p>Forgetting <code>type=</code> in <code><a href="../reference/shift.html">shift(val, "lead")</a></code> would segfault, <a href="https://github.com/Rdatatable/data.table/issues/3354"><a href='https://github.com/Rdatatable/data.table/issues/3354'>#3354</a></a>. A helpful error is now produced to indicate <code>"lead"</code> is being passed to <code>n=</code> rather than the intended <code>type=</code> argument. Thanks to <a href='https://github.com/SymbolixAU'>@SymbolixAU</a> for reporting.</p></li>
<li><p>The default print output (top 5 and bottom 5 rows) when ncol&gt;255 could display the columns in the wrong order, <a href="https://github.com/Rdatatable/data.table/issues/3306"><a href='https://github.com/Rdatatable/data.table/issues/3306'>#3306</a></a>. Thanks to Kun Ren for reporting.</p></li>
<li><p>Grouping by unusual column names such as <code>by='string_with_\\'</code> and <code>keyby="x y"</code> could fail, <a href="https://github.com/Rdatatable/data.table/issues/3319"><a href='https://github.com/Rdatatable/data.table/issues/3319'>#3319</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3378"><a href='https://github.com/Rdatatable/data.table/issues/3378'>#3378</a></a>. Thanks to <a href='https://github.com/HughParsonage'>@HughParsonage</a> for reporting and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the fixes.</p></li>
<li><p><code><a href="../reference/foverlaps.html">foverlaps()</a></code> could return incorrect results for <code>POSIXct &lt;= 1970-01-01</code>, <a href="https://github.com/Rdatatable/data.table/issues/3349"><a href='https://github.com/Rdatatable/data.table/issues/3349'>#3349</a></a>. Thanks to <a href='https://github.com/lux5'>@lux5</a> for reporting.</p></li>
<li><p><code>dcast.data.table</code> now handles functions passed to <code>fun.aggregate=</code> via a variable; e.g., <code>funs &lt;- list(sum, mean); dcast(..., fun.aggregate=funs</code>, <a href="https://github.com/Rdatatable/data.table/issues/1974"><a href='https://github.com/Rdatatable/data.table/issues/1974'>#1974</a></a> <a href="https://github.com/Rdatatable/data.table/issues/1369"><a href='https://github.com/Rdatatable/data.table/issues/1369'>#1369</a></a> <a href="https://github.com/Rdatatable/data.table/issues/2064"><a href='https://github.com/Rdatatable/data.table/issues/2064'>#2064</a></a> <a href="https://github.com/Rdatatable/data.table/issues/2949"><a href='https://github.com/Rdatatable/data.table/issues/2949'>#2949</a></a>. Thanks to <a href='https://github.com/sunbee'>@sunbee</a>, <a href='https://github.com/Ping2016'>@Ping2016</a>, <a href='https://github.com/smidelius'>@smidelius</a> and <a href='https://github.com/d0rg0ld'>@d0rg0ld</a> for reporting.</p></li>
<li><p>Some non-equijoin cases could segfault, <a href="https://github.com/Rdatatable/data.table/issues/3401"><a href='https://github.com/Rdatatable/data.table/issues/3401'>#3401</a></a>. Thanks to <a href='https://github.com/Gayyam'>@Gayyam</a> for reporting.</p></li>
<li><p><code>dcast.data.table</code> could sort rows containing <code>NA</code> incorrectly, <a href="https://github.com/Rdatatable/data.table/issues/2202"><a href='https://github.com/Rdatatable/data.table/issues/2202'>#2202</a></a>. Thanks to <a href='https://github.com/Galileo-Galilei'>@Galileo-Galilei</a> for the report.</p></li>
<li><p>Sorting, grouping and finding unique values of a numeric column containing at most one finite value (such as <code><a href="https://rdrr.io/r/base/c.html">c(Inf,0,-Inf)</a></code>) could return incorrect results, <a href="https://github.com/Rdatatable/data.table/issues/3372"><a href='https://github.com/Rdatatable/data.table/issues/3372'>#3372</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3381"><a href='https://github.com/Rdatatable/data.table/issues/3381'>#3381</a></a>; e.g., <code>data.table(A=c(Inf,0,-Inf), V=1:3)[,sum(V),by=A]</code> would treat the 3 rows as one group. This was a regression in 1.12.0. Thanks to Nicolas Ampuero for reporting.</p></li>
<li><p><code>:=</code> with quoted expression and dot alias now works as expected, <a href="https://github.com/Rdatatable/data.table/pull/3425"><a href='https://github.com/Rdatatable/data.table/issues/3425'>#3425</a></a>. Thanks to <a href='https://github.com/franknarf1'>@franknarf1</a> for raising and <a href='https://github.com/jangorecki'>@jangorecki</a> for the PR.</p></li>
<li><p>A join’s result could be incorrectly keyed when a single nomatch occurred at the very beginning while all other values matched, <a href="https://github.com/Rdatatable/data.table/issues/3441"><a href='https://github.com/Rdatatable/data.table/issues/3441'>#3441</a></a>. The incorrect key would cause incorrect results in subsequent queries. Thanks to <a href='https://github.com/symbalex'>@symbalex</a> for reporting and <a href='https://github.com/franknarf1'>@franknarf1</a> for pinpointing the root cause.</p></li>
<li><p><code>rbind</code> and <code><a href="../reference/rbindlist.html">rbindlist(..., use.names=TRUE)</a></code> with over 255 columns could return the columns in a random order, <a href="https://github.com/Rdatatable/data.table/issues/3373"><a href='https://github.com/Rdatatable/data.table/issues/3373'>#3373</a></a>. The contents and name of each column was correct but the order that the columns appeared in the result might not have matched the original input.</p></li>
<li><p><code>rbind</code> and <code>rbindlist</code> now combine <code>integer64</code> columns together with non-<code>integer64</code> columns correctly <a href="https://github.com/Rdatatable/data.table/issues/1349"><a href='https://github.com/Rdatatable/data.table/issues/1349'>#1349</a></a>, and support <code>raw</code> columns <a href="https://github.com/Rdatatable/data.table/issues/2819"><a href='https://github.com/Rdatatable/data.table/issues/2819'>#2819</a></a>.</p></li>
<li><p><code>NULL</code> columns are caught and error appropriately rather than segfault in some cases, <a href="https://github.com/Rdatatable/data.table/issues/2303"><a href='https://github.com/Rdatatable/data.table/issues/2303'>#2303</a></a> <a href="https://github.com/Rdatatable/data.table/issues/2305"><a href='https://github.com/Rdatatable/data.table/issues/2305'>#2305</a></a>. Thanks to Hugh Parsonage and <a href='https://github.com/franknarf1'>@franknarf1</a> for reporting.</p></li>
<li><p><code>melt</code> would error with ‘factor malformed’ or segfault in the presence of duplicate column names, <a href="https://github.com/Rdatatable/data.table/issues/1754"><a href='https://github.com/Rdatatable/data.table/issues/1754'>#1754</a></a>. Many thanks to <a href='https://github.com/franknarf1'>@franknarf1</a>, William Marble, wligtenberg and Toby Dylan Hocking for reproducible examples. All examples have been added to the test suite.</p></li>
<li><p>Removing a column from a null (0-column) data.table is now a (standard and simpler) warning rather than error, <a href="https://github.com/Rdatatable/data.table/issues/2335"><a href='https://github.com/Rdatatable/data.table/issues/2335'>#2335</a></a>. It is no longer an error to add a column to a null (0-column) data.table.</p></li>
<li><p>Non-UTF8 strings were not always sorted correctly on Windows (a regression in v1.12.0), <a href="https://github.com/Rdatatable/data.table/issues/3397"><a href='https://github.com/Rdatatable/data.table/issues/3397'>#3397</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3451"><a href='https://github.com/Rdatatable/data.table/issues/3451'>#3451</a></a>. Many thanks to <a href='https://github.com/shrektan'>@shrektan</a> for reporting and fixing.</p></li>
<li><p><code>cbind</code> with a null (0-column) <code>data.table</code> now works as expected, <a href="https://github.com/Rdatatable/data.table/issues/3445"><a href='https://github.com/Rdatatable/data.table/issues/3445'>#3445</a></a>. Thanks to <a href='https://github.com/mb706'>@mb706</a> for reporting.</p></li>
<li><p>Subsetting does a better job of catching a malformed <code>data.table</code> with error rather than segfault. A column may not be NULL, nor may a column be an object which has columns (such as a <code>data.frame</code> or <code>matrix</code>). Thanks to a comment and reproducible example in <a href="https://github.com/Rdatatable/data.table/issues/3369"><a href='https://github.com/Rdatatable/data.table/issues/3369'>#3369</a></a> from Drew Abbot which demonstrated the issue which arose from parsing JSON. The next release will enable <code>as.data.table</code> to unpack columns which are <code>data.frame</code> to support this use case.</p></li>
</ol>
</div>
<div id="notes-2" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-2" class="anchor"></a>NOTES</h2>
<ol>
<li><p>When upgrading to 1.12.0 some Windows users might have seen <code>CdllVersion not found</code> in some circumstances. We found a way to catch that so the <a href="https://twitter.com/MattDowle/status/1084528873549705217">helpful message</a> now occurs for those upgrading from versions prior to 1.12.0 too, as well as those upgrading from 1.12.0 to a later version. See item 1 in notes section of 1.12.0 below for more background.</p></li>
<li><p>v1.12.0 checked itself on loading using <code><a href="https://rdrr.io/r/tools/checkMD5sums.html">tools::checkMD5sums("data.table")</a></code> but this check failed under the <code>packrat</code> package manager on Windows because <code>packrat</code> appears to modify the DESCRIPTION file of packages it has snapshot, <a href="https://github.com/Rdatatable/data.table/issues/3329"><a href='https://github.com/Rdatatable/data.table/issues/3329'>#3329</a></a>. This check is now removed. The <code>CdllVersion</code> check was introduced after the <code>checkMD5sums()</code> attempt and is better; e.g., reliable on all platforms.</p></li>
<li><p>As promised in new feature 6 of v1.11.6 Sep 2018 (see below in this news file), the <code>datatable.CJ.names</code> option’s default is now <code>TRUE</code>. In v1.13.0 it will be removed.</p></li>
<li><p>Travis CI gains OSX using homebrew llvm for OpenMP support, <a href="https://github.com/Rdatatable/data.table/issues/3326"><a href='https://github.com/Rdatatable/data.table/issues/3326'>#3326</a></a>. Thanks <a href='https://github.com/marcusklik'>@marcusklik</a> for the PR.</p></li>
<li><p>Calling <code>data.table:::print.data.table()</code> directly (i.e. bypassing method dispatch by using 3 colons) and passing it a 0-column <code>data.frame</code> (not <code>data.table</code>) now works, <a href="https://github.com/Rdatatable/data.table/pull/3363"><a href='https://github.com/Rdatatable/data.table/issues/3363'>#3363</a></a>. Thanks <a href='https://github.com/heavywatal'>@heavywatal</a> for the PR.</p></li>
<li><p>v1.12.0 did not compile on Solaris 10 using Oracle Developer Studio 12.6, <a href="https://github.com/Rdatatable/data.table/issues/3285"><a href='https://github.com/Rdatatable/data.table/issues/3285'>#3285</a></a>. Many thanks to Prof Ripley for providing and testing a patch. For future reference and other package developers, a <code>const</code> variable should not be passed to OpenMP’s <code>num_threads()</code> directive otherwise <code>left operand must be modifiable lvalue</code> occurs. This appears to be a compiler bug which is why the specific versions are mentioned in this note.</p></li>
<li><p><code>foverlaps</code> provides clearer error messages w.r.t. factor and POSIXct interval columns, <a href="https://github.com/Rdatatable/data.table/issues/2645"><a href='https://github.com/Rdatatable/data.table/issues/2645'>#2645</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3007"><a href='https://github.com/Rdatatable/data.table/issues/3007'>#3007</a></a> <a href="https://github.com/Rdatatable/data.table/issues/1143"><a href='https://github.com/Rdatatable/data.table/issues/1143'>#1143</a></a>. Thanks to <a href='https://github.com/sritchie73'>@sritchie73</a>, <a href='https://github.com/msummersgill'>@msummersgill</a> and <a href='https://github.com/DavidArenburg'>@DavidArenburg</a> for the reports.</p></li>
<li>
<p><code><a href="../reference/duplicated.html">unique(DT)</a></code> checks up-front the types of all the columns and will fail if any column is type <code>list</code> even though those <code>list</code> columns may not be needed to establish uniqueness. Use <code><a href="../reference/duplicated.html">unique(DT, by=...)</a></code> to specify columns that are not type <code>list</code>. v1.11.8 and before would also correctly fail with the same error, but not when uniqueness had been established in prior columns: it would stop early, not look at the <code>list</code> column and return the correct result. Checking up-front was necessary for some internal optimizations and it’s probably best to be explicit anyway. Thanks to James Lamb for reporting, <a href="https://github.com/Rdatatable/data.table/issues/3332"><a href='https://github.com/Rdatatable/data.table/issues/3332'>#3332</a></a>. The error message has been embellished :</p>
<pre><code>Column 2 of by= (2) is type 'list', not yet supported. Please use the by= argument to specify
columns with types that are supported.</code></pre>
</li>
<li><p>Reminder that note 11 in v1.11.0 (May 2018) warned that <code><a href="../reference/set2key.html">set2key()</a></code> and <code><a href="../reference/set2key.html">key2()</a></code> will be removed in May 2019. They have been warning since v1.9.8 (Nov 2016) and their warnings were upgraded to errors in v1.11.0 (May 2018). When they were introduced in version 1.9.4 (Oct 2014) they were marked as ‘experimental’.</p></li>
<li><p>The <code>key(DT)&lt;-</code> form of <code><a href="../reference/setkey.html">setkey()</a></code> has been warning since at least 2012 to use <code><a href="../reference/setkey.html">setkey()</a></code>. The warning is now stronger: <code>key(x)&lt;-value is deprecated and not supported. Please change to use setkey().</code>. This warning will be upgraded to error in one year.</p></li>
</ol>
</div>
</div>
    <div id="data-table-v1-12-0-13-jan-2019" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-12-0-13-jan-2019" class="anchor"></a>data.table v1.12.0 (13 Jan 2019)<small> 2019-01-13 </small>
</h1>
<div id="new-features-2" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-2" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li><p><code><a href="../reference/openmp-utils.html">setDTthreads()</a></code> gains <code>restore_after_fork=</code>, <a href="https://github.com/Rdatatable/data.table/issues/2885"><a href='https://github.com/Rdatatable/data.table/issues/2885'>#2885</a></a>. The default <code>NULL</code> leaves the internal option unchanged which by default is <code>TRUE</code>. <code>data.table</code> has always switched to single-threaded mode on fork. It used to restore multithreading after a fork too but problems were reported on Mac and Intel OpenMP library (see 1.10.4 notes below). We are now trying again thanks to suggestions and success reported by Kun Ren and Mark Klik in package <code>fst</code>. If you experience problems with multithreading after a fork, please restart R and call <code><a href="../reference/openmp-utils.html">setDTthreads(restore_after_fork=FALSE)</a></code>.</p></li>
<li><p>Subsetting, ordering and grouping now use more parallelism. See benchmarks <a href="https://h2oai.github.io/db-benchmark/">here</a> and Matt Dowle’s presentation in October 2018 on YouTube <a href="https://youtu.be/Ddr8N9STSuI">here</a>. These internal changes gave rise to 4 regressions which were found before release thanks to Kun Ren, <a href="https://github.com/Rdatatable/data.table/issues/3211"><a href='https://github.com/Rdatatable/data.table/issues/3211'>#3211</a></a>. He kindly volunteers to ‘go-first’ and runs data.table through his production systems before release. We are looking for a ‘go-second’ volunteer please. A request to test before release was tweeted on 17 Dec <a href="https://twitter.com/MattDowle/status/1074746218645938176">here</a>. As usual, all CRAN and Bioconductor packages using data.table (currently 750) have been tested against this release, <a href="https://github.com/Rdatatable/data.table/issues/3233"><a href='https://github.com/Rdatatable/data.table/issues/3233'>#3233</a></a>. There are now 8,000 tests in 13,000 lines of test code; more lines of test code than there is code. Overall coverage has increased to 94% thanks to Michael Chirico.</p></li>
<li><p>New <code>frollmean</code> has been added by Jan Gorecki to calculate <em>rolling mean</em>, see <code><a href="../reference/froll.html">?froll</a></code> for documentation. Function name and arguments are experimental. Related to <a href="https://github.com/Rdatatable/data.table/issues/2778"><a href='https://github.com/Rdatatable/data.table/issues/2778'>#2778</a></a> (and <a href="https://github.com/Rdatatable/data.table/issues/624"><a href='https://github.com/Rdatatable/data.table/issues/624'>#624</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/626"><a href='https://github.com/Rdatatable/data.table/issues/626'>#626</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/1855"><a href='https://github.com/Rdatatable/data.table/issues/1855'>#1855</a></a>). Other rolling statistics will follow.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code> can now read a remote compressed file in one step; <code><a href="../reference/fread.html">fread("https://domain.org/file.csv.bz2")</a></code>. The <code>file=</code> argument now supports <code>.gz</code> and <code>.bz2</code> too; i.e. <code><a href="../reference/fread.html">fread(file="file.csv.gz")</a></code> works now where only <code><a href="../reference/fread.html">fread("file.csv.gz")</a></code> worked in 1.11.8.</p></li>
<li><p><code>nomatch=NULL</code> now does the same as <code>nomatch=0L</code> in both <code>DT[...]</code> and <code><a href="../reference/foverlaps.html">foverlaps()</a></code>; i.e. discards missing values silently (inner join). The default is still <code>nomatch=NA</code> (outer join) for statistical safety so that missing values are retained by default. After several years have elapsed, we will start to deprecate <code>0L</code>; please start using <code>NULL</code>. In future <code>nomatch=.(0)</code> (note that <code>.()</code> creates a <code>list</code> type and is different to <code>nomatch=0</code>) will fill with <code>0</code> to save replacing <code>NA</code> with <code>0</code> afterwards, <a href="https://github.com/Rdatatable/data.table/issues/857"><a href='https://github.com/Rdatatable/data.table/issues/857'>#857</a></a>.</p></li>
<li><p><code><a href="../reference/setattr.html">setnames()</a></code> gains <code>skip_absent</code> to skip names in <code>old</code> that aren’t present, <a href="https://github.com/Rdatatable/data.table/issues/3030"><a href='https://github.com/Rdatatable/data.table/issues/3030'>#3030</a></a>. By default <code>FALSE</code> so that it is still an error, as before, to attempt to change a column name that is not present. Thanks to <a href='https://github.com/MusTheDataGuy'>@MusTheDataGuy</a> for the suggestion and the PR.</p></li>
<li><p><code>NA</code> in <code><a href="../reference/between.html">between()</a></code> and <code><a href="../reference/between.html">%between%</a></code>’s <code>lower</code> and <code>upper</code> are now taken as missing bounds and return <code>TRUE</code> rather than <code>NA</code>. This is now documented.</p></li>
<li>
<p><code><a href="../reference/shift.html">shift()</a></code> now interprets negative values of <code>n</code> to mean the opposite <code>type=</code>, <a href="https://github.com/Rdatatable/data.table/issues/1708"><a href='https://github.com/Rdatatable/data.table/issues/1708'>#1708</a></a>. When <code>give.names=TRUE</code> the result is named using a positive <code>n</code> with the appropriate <code>type=</code>. Alternatively, a new <code>type="shift"</code> names the result using a signed <code>n</code> and constant type.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/shift.html">shift</a></span>(x, <span class="dt">n=</span><span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">give.names=</span><span class="ot">TRUE</span>)                =<span class="er">&gt;</span><span class="st">  "_lead_5"</span> ... <span class="st">"_lag_5"</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="../reference/shift.html">shift</a></span>(x, <span class="dt">n=</span><span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">type=</span><span class="st">"shift"</span>, <span class="dt">give.names=</span><span class="ot">TRUE</span>)  =<span class="er">&gt;</span><span class="st">  "_shift_-5"</span> ... <span class="st">"_shift_5"</span></a></code></pre></div>
</li>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code> now accepts <code>matrix</code>, <a href="https://github.com/Rdatatable/data.table/issues/2613"><a href='https://github.com/Rdatatable/data.table/issues/2613'>#2613</a></a>. Thanks to Michael Chirico for the suggestion and Felipe Parages for implementing. For now matrix input is converted to data.table (which can be costly) before writing.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code> and <code><a href="../reference/fwrite.html">fwrite()</a></code> can now handle file names in native and UTF-8 encoding, <a href="https://github.com/Rdatatable/data.table/issues/3078"><a href='https://github.com/Rdatatable/data.table/issues/3078'>#3078</a></a>. Thanks to Daniel Possenriede (<a href='https://github.com/dpprdan'>@dpprdan</a>) for reporting and fixing.</p></li>
<li>
<p><code>DT[i]</code> and <code>DT[i,cols]</code> now call internal parallel subsetting code, <a href="https://github.com/Rdatatable/data.table/issues/2951"><a href='https://github.com/Rdatatable/data.table/issues/2951'>#2951</a></a>. Subsetting is significantly faster (as are many other operations) with factor columns rather than character.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">N =<span class="st"> </span><span class="fl">2e8</span>                           <span class="co"># 4GB data on 4-core CPU with 16GB RAM</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">ID =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(LETTERS,N,<span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                <span class="dt">V1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">5</span>,N,<span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">                <span class="dt">V2 =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(N))</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">w =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(DT<span class="op">$</span>V1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>)              <span class="co">#  select 40% of rows</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                                  <span class="co">#  v1.12.0   v1.11.8</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(DT[w])                <span class="co">#     0.8s      2.6s</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">DT[, ID <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(ID)]</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(DT[w])                <span class="co">#     0.4s      2.3s</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(DT[w, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ID"</span>,<span class="st">"V2"</span>)])  <span class="co">#     0.3s      1.9s</span></a></code></pre></div>
</li>
<li><p><code>DT[..., .SDcols=]</code> now accepts <code><a href="../reference/patterns.html">patterns()</a></code>; e.g. <code>DT[..., .SDcols=patterns("^V")]</code>, for filtering columns according to a pattern (as in <code>melt.data.table</code>), <a href="https://github.com/Rdatatable/data.table/issues/1878"><a href='https://github.com/Rdatatable/data.table/issues/1878'>#1878</a></a>. Thanks to many people for pushing for this and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for ultimately filing the PR. See <code><a href="../reference/data.table.html">?data.table</a></code> for full details and examples.</p></li>
<li><p><code>split</code> data.table method will now preserve attributes, closes <a href="https://github.com/Rdatatable/data.table/issues/2047"><a href='https://github.com/Rdatatable/data.table/issues/2047'>#2047</a></a>. Thanks to <a href='https://github.com/caneff'>@caneff</a> for reporting.</p></li>
<li>
<p><code>DT[i,j]</code> now retains user-defined and inherited attributes, <a href="https://github.com/Rdatatable/data.table/issues/995"><a href='https://github.com/Rdatatable/data.table/issues/995'>#995</a></a>; e.g.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(datasets<span class="op">::</span>BOD,<span class="st">"reference"</span>)                     <span class="co"># "A1.4, p. 270"</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="kw"><a href="../reference/as.data.table.html">as.data.table</a></span>(datasets<span class="op">::</span>BOD)[<span class="dv">2</span>],<span class="st">"reference"</span>)   <span class="co"># was NULL now "A1.4, p. 270"</span></a></code></pre></div>
<p>If a superclass defines attributes that may not be valid after a <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> subset then the superclass should implement its own <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> method to manage those after calling <code><a href="https://rdrr.io/r/base/UseMethod.html">NextMethod()</a></code>.</p>
</li>
</ol>
</div>
<div id="bug-fixes-3" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-3" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p>Providing an <code>i</code> subset expression when attempting to delete a column correctly failed with helpful error, but when the column was missing too created a new column full of <code>NULL</code> values, <a href="https://github.com/Rdatatable/data.table/issues/3089"><a href='https://github.com/Rdatatable/data.table/issues/3089'>#3089</a></a>. Thanks to Michael Chirico for reporting.</p></li>
<li><p>Column names that look like expressions (e.g. <code>"a&lt;=colB"</code>) caused an error when used in <code>on=</code> even when wrapped with backticks, <a href="https://github.com/Rdatatable/data.table/issues/3092"><a href='https://github.com/Rdatatable/data.table/issues/3092'>#3092</a></a>. Additionally, <code>on=</code> now supports white spaces around operators; e.g. <code>on = "colA == colB"</code>. Thanks to <a href='https://github.com/mt1022'>@mt1022</a> for reporting and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing.</p></li>
<li><p>Unmatched <code>patterns</code> in <code>measure.vars</code> fail early and with feedback, <a href="https://github.com/Rdatatable/data.table/issues/3106"><a href='https://github.com/Rdatatable/data.table/issues/3106'>#3106</a></a>.</p></li>
<li><p><code><a href="../reference/fread.html">fread(..., skip=)</a></code> now skips non-standard <code>\r</code> and <code>\n\r</code> line endings properly again, <a href="https://github.com/Rdatatable/data.table/issues/3006"><a href='https://github.com/Rdatatable/data.table/issues/3006'>#3006</a></a>. Standard line endings (<code>\n</code> Linux/Mac and <code>\r\n</code> Windows) were skipped ok. Thanks to <a href='https://github.com/brattono'>@brattono</a> and <a href='https://github.com/tbrycekelly'>@tbrycekelly</a> for providing reproducible examples, and <a href='https://github.com/st-pasha'>@st-pasha</a> for fixing.</p></li>
<li><p><code><a href="../reference/fread.html">fread(..., colClasses=)</a></code> could return a corrupted result when a lower type was requested for one or more columns (e.g. reading “3.14” as integer), <a href="https://github.com/Rdatatable/data.table/issues/2922"><a href='https://github.com/Rdatatable/data.table/issues/2922'>#2922</a></a> <a href="https://github.com/Rdatatable/data.table/issues/2863"><a href='https://github.com/Rdatatable/data.table/issues/2863'>#2863</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3143"><a href='https://github.com/Rdatatable/data.table/issues/3143'>#3143</a></a>. It now ignores the request as documented and the helpful message in verbose mode is upgraded to warning. In future, coercing to a lower type might be supported (with warning if any accuracy is lost). <code>"NULL"</code> is recognized again in both vector and list mode; e.g. <code>colClasses=c("integer","NULL","integer")</code> and <code>colClasses=list(NULL=2, integer=10:40)</code>. Thanks to Arun Srinivasan, Kun Ren, Henri Ståhl and <a href='https://github.com/kszela24'>@kszela24</a> for reporting.</p></li>
<li><p><code><a href="../reference/groupingsets.html">cube()</a></code> will now produce expected order of results, <a href="https://github.com/Rdatatable/data.table/issues/3179"><a href='https://github.com/Rdatatable/data.table/issues/3179'>#3179</a></a>. Thanks to <a href='https://github.com/Henrik-P'>@Henrik-P</a> for reporting.</p></li>
<li><p><code><a href="../reference/groupingsets.html">groupingsets()</a></code> groups by empty column set and constant value in <code>j</code>, <a href="https://github.com/Rdatatable/data.table/issues/3173"><a href='https://github.com/Rdatatable/data.table/issues/3173'>#3173</a></a>.</p></li>
<li><p><code><a href="../reference/split.html">split.data.table()</a></code> failed if <code>DT</code> had a factor column named <code>"x"</code>, <a href="https://github.com/Rdatatable/data.table/issues/3151"><a href='https://github.com/Rdatatable/data.table/issues/3151'>#3151</a></a>. Thanks to <a href='https://github.com/tdeenes'>@tdeenes</a> for reporting and fixing.</p></li>
<li><p><code>fsetequal</code> now handles properly datasets having last column a character, closes <a href="https://github.com/Rdatatable/data.table/issues/2318"><a href='https://github.com/Rdatatable/data.table/issues/2318'>#2318</a></a>. Thanks to <a href='https://github.com/pschil'>@pschil</a> and <a href='https://github.com/franknarf1'>@franknarf1</a> for reporting.</p></li>
<li><p><code>DT[..., .SDcols=integer(0L)]</code> could fail, <a href="https://github.com/Rdatatable/data.table/issues/3185"><a href='https://github.com/Rdatatable/data.table/issues/3185'>#3185</a></a>. An empty <code>data.table</code> is now returned correctly.</p></li>
<li><p><code>as.data.table.default</code> method will now always copy its input, closes <a href="https://github.com/Rdatatable/data.table/issues/3230"><a href='https://github.com/Rdatatable/data.table/issues/3230'>#3230</a></a>. Thanks to <a href='https://github.com/NikdAK'>@NikdAK</a> for reporting.</p></li>
<li><p><code>DT[..., .SDcols=integer()]</code> failed with <code>.SDcols is numeric but has both +ve and -ve indices</code>, <a href="https://github.com/Rdatatable/data.table/issues/1789"><a href='https://github.com/Rdatatable/data.table/issues/1789'>#1789</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/3185"><a href='https://github.com/Rdatatable/data.table/issues/3185'>#3185</a></a>. It now functions as <code>.SDcols=character()</code> has done and creates an empty <code>.SD</code>. Thanks to Gabor Grothendieck and Hugh Parsonage for reporting. A related issue with empty <code>.SDcols</code> was fixed in development before release thanks to Kun Ren’s testing, <a href="https://github.com/Rdatatable/data.table/issues/3211"><a href='https://github.com/Rdatatable/data.table/issues/3211'>#3211</a></a>.</p></li>
<li><p>Multithreaded stability should be much improved with R 3.5+. Many thanks to Luke Tierney for pinpointing a memory issue with package <code>constellation</code> caused by <code>data.table</code> and his advice, <a href="https://github.com/Rdatatable/data.table/issues/3165"><a href='https://github.com/Rdatatable/data.table/issues/3165'>#3165</a></a>. Luke also added an extra check to R-devel when compiled with <code>--enable-strict-barrier</code>. The test suite is run through latest daily R-devel after every commit as usual, but now with <code>--enable-strict-barrier</code> on too via GitLab Pipelines (“Extra” badge at the top of the data.table <a href="http://r-datatable.com">homepage</a>) thanks to Jan Gorecki.</p></li>
<li><p>Fixed an edge-case bug of platform-dependent output of <code><a href="https://rdrr.io/r/base/strtoi.html">strtoi("", base = 2L)</a></code> on which <code>groupingsets</code> had relied, <a href="https://github.com/Rdatatable/data.table/issues/3267"><a href='https://github.com/Rdatatable/data.table/issues/3267'>#3267</a></a>.</p></li>
</ol>
</div>
<div id="notes-3" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-3" class="anchor"></a>NOTES</h2>
<ol>
<li><p>When data.table loads it now checks its DLL version against the version of its R level code. This is to detect installation issues on Windows when i) the DLL is in use by another R session and ii) the CRAN source version &gt; CRAN binary binary which happens just after a new release (R prompts users to install from source until the CRAN binary is available). This situation can lead to a state where the package’s new R code calls old C code in the old DLL; <a href="https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17478">R<a href='https://github.com/Rdatatable/data.table/issues/17478'>#17478</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/3056"><a href='https://github.com/Rdatatable/data.table/issues/3056'>#3056</a></a>. This broken state can persist until, hopefully, you experience a strange error caused by the mismatch. Otherwise, wrong results may occur silently. This situation applies to any R package with compiled code not just data.table, is Windows-only, and is long-standing. It has only recently been understood as it typically only occurs during the few days after each new release until binaries are available on CRAN.</p></li>
<li><p>When <code>on=</code> is provided but not <code>i=</code>, a helpful error is now produced rather than silently ignoring <code>on=</code>. Thanks to Dirk Eddelbuettel for the idea.</p></li>
<li><p><code>.SDcols=</code> is more helpful when passed non-existent columns, <a href="https://github.com/Rdatatable/data.table/issues/3116"><a href='https://github.com/Rdatatable/data.table/issues/3116'>#3116</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/3118"><a href='https://github.com/Rdatatable/data.table/issues/3118'>#3118</a></a>. Thanks to Michael Chirico for the investigation and PR.</p></li>
<li><p><code><a href="../reference/update.dev.pkg.html">update.dev.pkg()</a></code> gains <code>type=</code> to specify if update should be made from binaries, sources or both. <a href="https://github.com/Rdatatable/data.table/issues/3148"><a href='https://github.com/Rdatatable/data.table/issues/3148'>#3148</a></a>. Thanks to Reino Bruner for the detailed suggestions.</p></li>
<li><p><code><a href="../reference/setDT.html">setDT()</a></code> improves feedback when passed a ragged list (i.e. where all columns in the list are not the same length), <a href="https://github.com/Rdatatable/data.table/issues/3121"><a href='https://github.com/Rdatatable/data.table/issues/3121'>#3121</a></a>. Thanks <a href='https://github.com/chuk-yong'>@chuk-yong</a> for highlighting.</p></li>
<li><p>The one and only usage of <code>UNPROTECT_PTR()</code> has been removed, <a href="https://github.com/Rdatatable/data.table/issues/3232"><a href='https://github.com/Rdatatable/data.table/issues/3232'>#3232</a></a>. Thanks to Tomas Kalibera’s investigation and advice here: <a href="https://developer.r-project.org/Blog/public/2018/12/10/unprotecting-by-value/index.html" class="uri">https://developer.r-project.org/Blog/public/2018/12/10/unprotecting-by-value/index.html</a></p></li>
</ol>
</div>
</div>
    <div id="data-table-v1-11-8-30-sep-2018" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-11-8-30-sep-2018" class="anchor"></a>data.table v1.11.8 (30 Sep 2018)<small> 2018-09-30 </small>
</h1>
<div id="new-features-3" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-3" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li>
<code><a href="../reference/fread.html">fread()</a></code> can now read <code>.gz</code> and <code>.bz2</code> files directly: <code><a href="../reference/fread.html">fread("file.csv.gz")</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/717"><a href='https://github.com/Rdatatable/data.table/issues/717'>#717</a></a> <a href="https://github.com/Rdatatable/data.table/issues/3058"><a href='https://github.com/Rdatatable/data.table/issues/3058'>#3058</a></a>. It uses <code>R.utils::decompressFile</code> to decompress to a <code><a href="https://rdrr.io/r/base/tempfile.html">tempfile()</a></code> which is then read by <code><a href="../reference/fread.html">fread()</a></code> in the usual way. For greater speed on large-RAM servers, it is recommended to use ramdisk for temporary files by setting <code>TMPDIR</code> to <code>/dev/shm</code> before starting R; see <code><a href="https://rdrr.io/r/base/tempfile.html">?tempdir</a></code>. The decompressed temporary file is removed as soon as <code>fread</code> completes even if there is an error reading the file. Reading a remote compressed file in one step will be supported in the next version; e.g. <code><a href="../reference/fread.html">fread("http://domain.org/file.csv.bz2")</a></code>.</li>
</ol>
</div>
<div id="bug-fixes-4" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-4" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p>Joining two keyed tables using <code>on=</code> to columns not forming a leading subset of <code><a href="../reference/setkey.html">key(i)</a></code> could result in an invalidly keyed result, <a href="https://github.com/Rdatatable/data.table/issues/3061"><a href='https://github.com/Rdatatable/data.table/issues/3061'>#3061</a></a>. Subsequent queries on the result could then return incorrect results. A warning <code>longer object length is not a multiple of shorter object length</code> could also occur. Thanks to <a href='https://github.com/renkun-ken'>@renkun-ken</a> for reporting and the PR.</p></li>
<li><p><code>keyby=</code> on columns for which an index exists now uses the index (new feature 7 in v1.11.6 below) but if an <code>i</code> subset is present in the same query then it could segfault, <a href="https://github.com/Rdatatable/data.table/issues/3062"><a href='https://github.com/Rdatatable/data.table/issues/3062'>#3062</a></a>. Again thanks to <a href='https://github.com/renkun-ken'>@renkun-ken</a> for reporting.</p></li>
<li><p>Assigning an out-of-range integer to an item in a factor column (a rare operation) correctly created an <code>NA</code> in that spot with warning, but now no longer also corrupts the variable being assigned, <a href="https://github.com/Rdatatable/data.table/issues/2984"><a href='https://github.com/Rdatatable/data.table/issues/2984'>#2984</a></a>. Thanks to <a href='https://github.com/radfordneal'>@radfordneal</a> for reporting and <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing. Assigning a string which is missing from the factor levels continues to automatically append the string to the factor levels.</p></li>
<li><p>Assigning a sequence to a column using base R methods (e.g. <code>DT[["foo"]] = 1:10</code>) could cause subsetting to fail with <code>Internal error in subset.c: column &lt;n&gt; is an ALTREP vector</code>, <a href="https://github.com/Rdatatable/data.table/issues/3051"><a href='https://github.com/Rdatatable/data.table/issues/3051'>#3051</a></a>. Thanks to Michel Lang for reporting.</p></li>
<li><p><code>as.data.table</code> <code>matrix</code> method now properly handles rownames for 0 column data.table output. Thanks <a href='https://github.com/mllg'>@mllg</a> for reporting. Closes <a href="https://github.com/Rdatatable/data.table/issues/3149"><a href='https://github.com/Rdatatable/data.table/issues/3149'>#3149</a></a>.</p></li>
</ol>
</div>
<div id="notes-4" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-4" class="anchor"></a>NOTES</h2>
<ol>
<li><p>The test suite now turns on R’s new <em>R_CHECK_LENGTH_1_LOGIC2</em> to catch when internal use of <code>&amp;&amp;</code> or <code>||</code> encounter arguments of length more than one. Thanks to Hugh Parsonage for implementing and fixing the problems caught by this.</p></li>
<li><p>Some namespace changes have been made with respect to melt, dcast and xts. No change is expected but if you do have any trouble, please file an issue.</p></li>
<li>
<p><code>split.data.table</code> was exported in v1.11.6 in addition to being registered using <code>S3method(split, data.table)</code>. The export has been removed again. It had been added because a user said they found it difficult to find, <a href="https://github.com/Rdatatable/data.table/issues/2920"><a href='https://github.com/Rdatatable/data.table/issues/2920'>#2920</a></a>. But S3 methods are not normally exported explicitly by packages. The proper way to access the <code>split.data.table</code> method is to call <code><a href="../reference/split.html">split(DT)</a></code> where <code>DT</code> is a <code>data.table</code>. The generic (<code><a href="https://rdrr.io/r/base/split.html">base::split</a></code> in this case) then dispatches to the <code>split.data.table</code> method. v1.11.6 was not on CRAN very long (1 week) so we think it’s better to revert this change quickly. To know what methods exist, R provides the <code><a href="https://rdrr.io/r/utils/methods.html">methods()</a></code> function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span>(split)               <span class="co"># all the methods for the split generic</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span>(<span class="dt">class=</span><span class="st">"data.table"</span>)  <span class="co"># all the generics that data.table has a method for (47 currently)</span></a></code></pre></div>
</li>
</ol>
</div>
</div>
    <div id="data-table-v1-11-6-19-sep-2018" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-11-6-19-sep-2018" class="anchor"></a>data.table v1.11.6 (19 Sep 2018)<small> 2018-09-19 </small>
</h1>
<div id="new-features-4" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-4" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li><p>For convenience when some of the files in <code>fnams</code> are empty in <code><a href="../reference/rbindlist.html">rbindlist(lapply(fnams,fread))</a></code>, <code>fread</code> now reads empty input as a null-data.table with warning rather than error, <a href="https://github.com/Rdatatable/data.table/issues/2898"><a href='https://github.com/Rdatatable/data.table/issues/2898'>#2898</a></a>. For consistency, <code><a href="../reference/fwrite.html">fwrite(data.table(NULL))</a></code> now creates an empty file and warns instead of error, too.</p></li>
<li><p><code><a href="../reference/setcolorder.html">setcolorder(DT)</a></code> without further arguments now defaults to moving the key columns to be first, <a href="https://github.com/Rdatatable/data.table/issues/2895"><a href='https://github.com/Rdatatable/data.table/issues/2895'>#2895</a></a>. Thanks to <a href='https://github.com/jsams'>@jsams</a> for the PR.</p></li>
<li><p>Attempting to subset on <code>col</code> when the column is actually called <code>Col</code> will still error, but the error message will helpfully suggest similarly-spelled columns, <a href="https://github.com/Rdatatable/data.table/issues/2887"><a href='https://github.com/Rdatatable/data.table/issues/2887'>#2887</a></a>. This is experimental, applies just to <code>i</code> currently, and we look forward to feedback. Thanks to Michael Chirico for the suggestion and PR.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code> has always accepted literal data; e.g. <code><a href="../reference/fread.html">fread("A,B\n1,2\n3,4")</a></code>. It now gains explicit <code>text=</code>; e.g. <code><a href="../reference/fread.html">fread(text="A,B\n1,2\n3,4")</a></code>. Unlike the first general purpose <code>input=</code> argument, the <code>text=</code> argument accepts multi-line input; e.g. <code><a href="../reference/fread.html">fread(text=c("A,B","1,2","3,4"))</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/1423"><a href='https://github.com/Rdatatable/data.table/issues/1423'>#1423</a></a>. Thanks to Douglas Clark for the request and Hugh Parsonage for the PR.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code> has always accepted system commands; e.g. <code><a href="../reference/fread.html">fread("grep blah file.txt")</a></code>. It now gains explicit <code>cmd=</code>; e.g. <code><a href="../reference/fread.html">fread(cmd="grep blah file.txt")</a></code>. Further, if and only if <code>input=</code> is a system command and a variable was used to hold that command (<code><a href="../reference/fread.html">fread(someCommand)</a></code> not <code><a href="../reference/fread.html">fread("grep blah file.txt")</a></code>) or a variable is used to construct it (<code><a href="../reference/fread.html">fread(paste("grep",variable,"file.txt"))</a></code>), a message is now printed suggesting <code>cmd=</code>. This is to inform all users that there is a potential security concern if you are i) creating apps, and ii) your app takes input from a public user who could be malicious, and iii) input from the malicious user (such as a filename) is passed by your app to <code><a href="../reference/fread.html">fread()</a></code>, and iv) your app in not running in a protected environment. If all 4 conditions hold then the malicious user could provide a system command instead of a filename which <code><a href="../reference/fread.html">fread()</a></code> would run, and that would be a problem too. If the app is not running in a protected environment (e.g. app is running as root) then this could do damage or obtain data you did not intend. Public facing apps should be running with limited operating system permission so that any breach from any source is contained. We agree with <a href="https://lkml.org/lkml/2017/11/21/356">Linus Torvald’s advice</a> on this which boils down to: “when addressing security concerns the first step is do no harm, just inform”. If you aren’t creating apps or apis that could have a malicious user then there is no risk but we can’t distinguish you so we have to inform everyone. Please change to <code><a href="../reference/fread.html">fread(cmd=...)</a></code> at your leisure. The new message can be suppressed with <code><a href="https://rdrr.io/r/base/options.html">options(datatable.fread.input.cmd.message=FALSE)</a></code>. Passing system commands to <code><a href="../reference/fread.html">fread()</a></code> continues to be recommended and encouraged and is widely used; e.g. via the techniques gathered together in the book <a href="https://www.datascienceatthecommandline.com/">Data Science at the Command Line</a>. A <code><a href="https://rdrr.io/r/base/warning.html">warning()</a></code> is too strong because best-practice for production systems is to set <code><a href="https://rdrr.io/r/base/options.html">options(warn=2)</a></code> to tolerate no warnings. Such production systems have no user input and so there is no security risk; we don’t want to do harm by breaking production systems via a <code><a href="https://rdrr.io/r/base/warning.html">warning()</a></code> which gets turned into an error by <code><a href="https://rdrr.io/r/base/options.html">options(warn=2)</a></code>. Now that we have informed all users, we request feedback. There are 3 options for future releases: i) remove the message, ii) leave the message in place, iii) upgrade the message to warning and then eventually error. The default choice is the middle one: leave the message in place.</p></li>
<li><p>New <code><a href="https://rdrr.io/r/base/options.html">options(datatable.CJ.names=TRUE)</a></code> changes <code><a href="../reference/J.html">CJ()</a></code> to auto-name its inputs exactly as <code><a href="../reference/data.table.html">data.table()</a></code> does, <a href="https://github.com/Rdatatable/data.table/issues/1596"><a href='https://github.com/Rdatatable/data.table/issues/1596'>#1596</a></a>. Thanks <a href='https://github.com/franknarf1'>@franknarf1</a> for the suggestion. Current default is <code>FALSE</code>; i.e. no change. The option’s default will be changed to <code>TRUE</code> in v1.12.0 and then eventually the option will be removed. Any code that depends on <code>CJ(x,y)$V1</code> will need to be changed to <code>CJ(x,y)$x</code> and is more akin to a bug fix due to the inconsistency with <code><a href="../reference/data.table.html">data.table()</a></code>.</p></li>
<li><p>If an appropriate index exists, <code>keyby=</code> will now use it. For example, given <code><a href="../reference/setkey.html">setindex(DT,colA,colB)</a></code>, both <code>DT[,j,keyby=colA]</code> (a leading subset of the index columns) and <code>DT[,j,keyby=.(colA,colB)]</code> will use the index, but not <code>DT[,j,keyby=.(colB,colA)]</code>. The option <code><a href="https://rdrr.io/r/base/options.html">options(datatable.use.index=FALSE)</a></code> will turn this feature off. Please always use <code>keyby=</code> unless you wish to retain the order of groups by first-appearance order (in which case use <code>by=</code>). Also, both <code>keyby=</code> and <code>by=</code> already used the key where possible but are now faster when using just the first column of the key. As usual, setting <code>verbose=TRUE</code> either per-query or globally using <code><a href="https://rdrr.io/r/base/options.html">options(datatable.verbose=TRUE)</a></code> will report what’s being done internally.</p></li>
</ol>
</div>
<div id="bug-fixes-5" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-5" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p><code>fread</code> now respects the order of columns passed to <code>select=</code> when column numbers are used, <a href="https://github.com/Rdatatable/data.table/issues/2986"><a href='https://github.com/Rdatatable/data.table/issues/2986'>#2986</a></a>. It already respected the order when column names are used. Thanks <a href='https://github.com/privefl'>@privefl</a> for raising the issue.</p></li>
<li><p><code>gmin</code> and <code>gmax</code> no longer fail on <em>ordered</em> factors, <a href="https://github.com/Rdatatable/data.table/issues/1947"><a href='https://github.com/Rdatatable/data.table/issues/1947'>#1947</a></a>. Thanks to <a href='https://github.com/mcieslik-mctp'>@mcieslik-mctp</a> for identifying and <a href='https://github.com/mbacou'>@mbacou</a> for the nudge.</p></li>
<li><p><code>as.ITime.character</code> now properly handles NA when attempting to detect the format of non-NA values in vector. Thanks <a href='https://github.com/polyjian'>@polyjian</a> for reporting, closes <a href="https://github.com/Rdatatable/data.table/issues/2940"><a href='https://github.com/Rdatatable/data.table/issues/2940'>#2940</a></a>.</p></li>
<li><p><code><a href="../reference/as.matrix.html">as.matrix(DT, rownames="id")</a></code> now works when <code>DT</code> has a single row, <a href="https://github.com/Rdatatable/data.table/issues/2930"><a href='https://github.com/Rdatatable/data.table/issues/2930'>#2930</a></a>. Thanks to <a href='https://github.com/malcook'>@malcook</a> for reporting and <a href='https://github.com/sritchie73'>@sritchie73</a> for fixing. The root cause was the dual meaning of the <code>rownames=</code> argument: i) a single column name/number (most common), or ii) rowname values length 1 for the single row. For clarity and safety, <code>rownames.value=</code> has been added. Old usage (i.e. <code>length(rownames)&gt;1</code>) continues to work for now but will issue a warning in a future release, and then error in a release after that.</p></li>
<li><p>Fixed regression in v1.11.0 (May 2018) caused by PR <a href="https://github.com/Rdatatable/data.table/pull/2389"><a href='https://github.com/Rdatatable/data.table/issues/2389'>#2389</a></a> which introduced partial key retainment on <code>:=</code> assigns. This broke the joining logic that assumed implicitly that assigning always drops keys completely. Consequently, join and subset results could be wrong when matching character to factor columns with existing keys, <a href="https://github.com/Rdatatable/data.table/issues/2881"><a href='https://github.com/Rdatatable/data.table/issues/2881'>#2881</a></a>. Thanks to <a href='https://github.com/ddong63'>@ddong63</a> for reporting and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing. Missing test added to ensure this doesn’t arise again.</p></li>
<li><p><code>as.IDate.numeric</code> no longer ignores “origin”, <a href="https://github.com/Rdatatable/data.table/issues/2880"><a href='https://github.com/Rdatatable/data.table/issues/2880'>#2880</a></a>. Thanks to David Arenburg for reporting and fixing.</p></li>
<li><p><code>as.ITime.times</code> was rounding fractional seconds while other methods were truncating, <a href="https://github.com/Rdatatable/data.table/issues/2870"><a href='https://github.com/Rdatatable/data.table/issues/2870'>#2870</a></a>. The <code>as.ITime</code> method gains <code>ms=</code> taking <code>"truncate"</code> (default), <code>"nearest"</code> and <code>"ceil"</code>. Thanks to <a href='https://github.com/rossholmberg'>@rossholmberg</a> for reporting and Michael Chirico for fixing.</p></li>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code> now writes POSIXct dates after 2038 correctly, <a href="https://github.com/Rdatatable/data.table/issues/2995"><a href='https://github.com/Rdatatable/data.table/issues/2995'>#2995</a></a>. Thanks to Manfred Zorn for reporting and Philippe Chataignon for the PR fixing it.</p></li>
<li><p><code>fsetequal</code> gains the <code>all</code> argument to make it consistent with the other set operator functions <code>funion</code>, <code>fsetdiff</code> and <code>fintersect</code> <a href="https://github.com/Rdatatable/data.table/issues/2968"><a href='https://github.com/Rdatatable/data.table/issues/2968'>#2968</a></a>. When <code>all = FALSE</code> <code>fsetequal</code> will treat rows as elements in a set when checking whether two <code>data.tables</code> are equal (i.e. duplicate rows will be ignored). For now the default value is <code>all = TRUE</code> for backwards compatibility, but this will be changed to <code>all = FALSE</code> in a future release to make it consistent with the other set operation functions. Thanks to <a href='https://github.com/franknarf1'>@franknarf1</a> for reporting and <a href='https://github.com/sritchie73'>@sritchie73</a> for fixing.</p></li>
<li><p><code>fintersect</code> failed on tables with a column called <code>y</code>, <a href="https://github.com/Rdatatable/data.table/issues/3034"><a href='https://github.com/Rdatatable/data.table/issues/3034'>#3034</a></a>. Thanks to Maxim Nazarov for reporting.</p></li>
<li><p>Compilation fails in AIX because NAN and INFINITY macros definition in AIX make them not constant literals, <a href="https://github.com/Rdatatable/data.table/pull/3043"><a href='https://github.com/Rdatatable/data.table/issues/3043'>#3043</a></a>. Thanks to Ayappan for reporting and fixing.</p></li>
<li><p>The introduction of altrep in R 3.5.0 caused some performance regressions of about 20% in some cases, <a href="https://github.com/Rdatatable/data.table/issues/2962"><a href='https://github.com/Rdatatable/data.table/issues/2962'>#2962</a></a>. Investigating this led to some improvements to grouping which are faster than before R 3.5.0 in some cases. Thanks to Nikolay S. for reporting. The work to accomodate altrep is not complete but it is better and it is highly recommended to upgrade to this update.</p></li>
<li><p>Fixed 7 memory faults thanks to CRAN’s <a href="https://github.com/kalibera/rchk"><code>rchk</code></a> tool by Tomas Kalibera, <a href="https://github.com/Rdatatable/data.table/pull/3033"><a href='https://github.com/Rdatatable/data.table/issues/3033'>#3033</a></a>.</p></li>
</ol>
</div>
<div id="notes-5" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-5" class="anchor"></a>NOTES</h2>
<ol>
<li>
<p>The type coercion warning message has been improved, <a href="https://github.com/Rdatatable/data.table/pull/2989"><a href='https://github.com/Rdatatable/data.table/issues/2989'>#2989</a></a>. Thanks to <a href='https://github.com/sarahbeeysian'>@sarahbeeysian</a> on <a href="https://twitter.com/sarahbeeysian/status/1021359529789775872">Twitter</a> for highlighting. For example, given the follow statements:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">DT[<span class="dv">2</span>, id<span class="op">:</span><span class="er">=</span><span class="st">"foo"</span>]</a></code></pre></div>
<p>the warning message has changed from :</p>
<pre><code>Coerced character RHS to integer to match the column's type. Either change the target column
['id'] to character first (by creating a new character vector length 3 (nrows of entire table) and
assign that; i.e. 'replace' column), or coerce RHS to integer (e.g. 1L, NA_[real|integer]_, as.*,
etc) to make your intent clear and for speed. Or, set the column type correctly up front when you
create the table and stick to it, please.</code></pre>
<p>to :</p>
<pre><code>Coerced character RHS to integer to match the type of the target column (column 1 named 'id'). If
the target column's type integer is correct, it's best for efficiency to avoid the coercion and
create the RHS as type integer. To achieve that consider the L postfix: typeof(0L) vs typeof(0),
and typeof(NA) vs typeof(NA_integer_) vs typeof(NA_real_). Wrapping the RHS with as.integer() will
avoid this warning but still perform the coercion. If the target column's type is not correct, it
is best to revisit where the DT was created and fix the column type there; e.g., by using
colClasses= in fread(). Otherwise, you can change the column type now by plonking a new column (of
the desired type) over the top of it; e.g. DT[, `id`:=as.character(`id`)]. If the RHS of := has
nrow(DT) elements then the assignment is called a column plonk and is the way to change a column's
type. Column types can be observed with sapply(DT,typeof).</code></pre>
<p>Further, if a coercion from double to integer is performed, fractional data such as 3.14 is now detected and the truncation to 3 is warned about if and only if truncation has occurred.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">v=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">DT[<span class="dv">2</span>, v<span class="op">:</span><span class="er">=</span><span class="fl">3.14</span>]</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">Warning message<span class="op">:</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="st">  </span>Coerced double RHS to integer to match the type of the target <span class="kw">column</span> (column <span class="dv">1</span> named <span class="st">'v'</span>). One</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">  or more RHS values contain fractions which have been lost; e.g. item <span class="dv">1</span> with value <span class="fl">3.140000</span> has</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">  been truncated to <span class="fl">3.</span></a></code></pre></div>
</li>
<li><p><code>split.data.table</code> method is now properly exported, <a href="https://github.com/Rdatatable/data.table/issues/2920"><a href='https://github.com/Rdatatable/data.table/issues/2920'>#2920</a></a>. But we don’t recommend it because <code>split</code> copies all the pieces into new memory.</p></li>
<li><p>Setting indices on columns which are part of the key will now create those indices.</p></li>
<li><p><code>hour</code>, <code>minute</code>, and <code>second</code> utility functions use integer arithmetic when the input is already (explicitly) UTC-based <code>POSIXct</code> for 4-10x speedup vs. using <code>as.POSIXlt</code>.</p></li>
<li><p>Error added for incorrect usage of <code><a href="../reference/between.html">%between%</a></code>, with some helpful diagnostic hints, <a href="https://github.com/Rdatatable/data.table/issues/3014"><a href='https://github.com/Rdatatable/data.table/issues/3014'>#3014</a></a>. Thanks <a href='https://github.com/peterlittlejohn'>@peterlittlejohn</a> for offering his user experience and providing the impetus.</p></li>
</ol>
</div>
</div>
    <div id="data-table-v1-11-4-27-may-2018" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-11-4-27-may-2018" class="anchor"></a>data.table v1.11.4 (27 May 2018)<small> 2018-05-27 </small>
</h1>
<ol>
<li><p>Empty RHS of <code>:=</code> is no longer an error when the <code>i</code> clause returns no rows to assign to anyway, <a href="https://github.com/Rdatatable/data.table/issues/2829"><a href='https://github.com/Rdatatable/data.table/issues/2829'>#2829</a></a>. Thanks to <a href='https://github.com/cguill95'>@cguill95</a> for reporting and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing.</p></li>
<li><p>Fixed runaway memory usage with R-devel (R &gt; 3.5.0), <a href="https://github.com/Rdatatable/data.table/pull/2882"><a href='https://github.com/Rdatatable/data.table/issues/2882'>#2882</a></a>. Thanks to many people but in particular to Trang Nguyen for making the breakthrough reproducible example, Paul Bailey for liaising, and Luke Tierney for then pinpointing the issue. It was caused by an interaction of two or more data.table threads operating on new compact vectors in the ALTREP framework, such as the sequence <code>1:n</code>. This interaction could result in R’s garbage collector turning off, and hence the memory explosion. Problems may occur in R 3.5.0 too but we were only able to reproduce in R &gt; 3.5.0. The R code in data.table’s implementation benefits from ALTREP (<code>for</code> loops in R no longer allocate their range vector input, for example) but are not so appropriate as data.table columns. Sequences such as <code>1:n</code> are common in test data but not very common in real-world datasets. Therefore, there is no need for data.table to support columns which are ALTREP compact sequences. The <code><a href="../reference/data.table.html">data.table()</a></code> function already expanded compact vectors (by happy accident) but <code><a href="../reference/setDT.html">setDT()</a></code> did not (it now does). If, somehow, a compact vector still reaches the internal parallel regions, a helpful error will now be generated. If this happens, please report it as a bug.</p></li>
<li><p>Tests 1590.3 &amp; 1590.4 now pass when users run <code><a href="../reference/test.data.table.html">test.data.table()</a></code> on Windows, <a href="https://github.com/Rdatatable/data.table/pull/2856"><a href='https://github.com/Rdatatable/data.table/issues/2856'>#2856</a></a>. Thanks to Avraham Adler for reporting. Those tests were passing on AppVeyor, win-builder and CRAN’s Windows because <code>R CMD check</code> sets <code>LC_COLLATE=C</code> as documented in R-exts$1.3.1, whereas by default on Windows <code>LC_COLLATE</code> is usually a regional Windows-1252 dialect such as <code>English_United States.1252</code>.</p></li>
<li><p>Around 1 billion very small groups (of size 1 or 2 rows) could result in <code>"Failed to realloc working memory"</code> even when plenty of memory is available, <a href="https://github.com/Rdatatable/data.table/issues/2777"><a href='https://github.com/Rdatatable/data.table/issues/2777'>#2777</a></a>. Thanks once again to <a href='https://github.com/jsams'>@jsams</a> for the detailed report as a follow up to bug fix 40 in v1.11.0.</p></li>
</ol>
</div>
    <div id="data-table-v1-11-2-08-may-2018" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-11-2-08-may-2018" class="anchor"></a>data.table v1.11.2 (08 May 2018)<small> 2018-05-08 </small>
</h1>
<ol>
<li><p><code><a href="../reference/test.data.table.html">test.data.table()</a></code> created/overwrote variable <code>x</code> in <code>.GlobalEnv</code>, <a href="https://github.com/Rdatatable/data.table/issues/2828"><a href='https://github.com/Rdatatable/data.table/issues/2828'>#2828</a></a>; i.e. a modification of user’s workspace which is not allowed. Thanks to <a href='https://github.com/etienne-s'>@etienne-s</a> for reporting.</p></li>
<li><p><code>as.chron</code> methods for <code>IDate</code> and <code>ITime</code> have been removed, <a href="https://github.com/Rdatatable/data.table/issues/2825"><a href='https://github.com/Rdatatable/data.table/issues/2825'>#2825</a></a>. <code>as.chron</code> still works since <code>IDate</code> inherits from <code>Date</code>. We are not sure why we had specific methods in the first place. It may have been from a time when <code>IDate</code> did not inherit from <code>Date</code>, perhaps. Note that we don’t use <code>chron</code> ourselves in our own work.</p></li>
<li><p>Fixed <code>SETLENGTH() cannot be applied to an ALTVEC object</code> starting in R-devel (R 3.6.0) on 1 May 2018, a few hours after 1.11.0 was accepted on CRAN, <a href="https://github.com/Rdatatable/data.table/issues/2820"><a href='https://github.com/Rdatatable/data.table/issues/2820'>#2820</a></a>. Many thanks to Luke Tierney for pinpointing the problem.</p></li>
<li><p>Fixed some rare memory faults in <code><a href="../reference/fread.html">fread()</a></code> and <code><a href="../reference/rbindlist.html">rbindlist()</a></code> found with <code><a href="https://rdrr.io/r/base/gctorture.html">gctorture2()</a></code> and <a href="https://github.com/kalibera/rchk"><code>rchk</code></a>, <a href="https://github.com/Rdatatable/data.table/issues/2841"><a href='https://github.com/Rdatatable/data.table/issues/2841'>#2841</a></a>.</p></li>
</ol>
</div>
    <div id="data-table-v1-11-0-01-may-2018" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-11-0-01-may-2018" class="anchor"></a>data.table v1.11.0 (01 May 2018)<small> 2018-05-01 </small>
</h1>
<div id="notice-of-intended-future-potential-breaking-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#notice-of-intended-future-potential-breaking-changes" class="anchor"></a>NOTICE OF INTENDED FUTURE POTENTIAL BREAKING CHANGES</h2>
<ol>
<li>
<p><code><a href="../reference/fread.html">fread()</a></code>’s <code>na.strings=</code> argument :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="st">"NA"</span>                                      <span class="co"># old default</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"datatable.na.strings"</span>, <span class="st">"NA"</span>)   <span class="co"># this release; i.e. the same; no change yet</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"datatable.na.strings"</span>, <span class="st">""</span>)     <span class="co"># future release</span></a></code></pre></div>
<p>This option controls how <code>,,</code> is read in character columns. It does not affect numeric columns which read <code>,,</code> as <code>NA</code> regardless. We would like <code>,,</code>=&gt;<code>NA</code> for consistency with numeric types, and <code>,"",</code>=&gt;empty string to be the standard default for <code>fwrite/fread</code> character columns so that <code>fread(fwrite(DT))==DT</code> without needing any change to any parameters. <code>fwrite</code> has never written <code>NA</code> as <code>"NA"</code> in case <code>"NA"</code> is a valid string in the data; e.g., 2 character id columns sometimes do. Instead, <code>fwrite</code> has always written <code>,,</code> by default for an <code>&lt;NA&gt;</code> in a character columns. The use of R’s <code><a href="https://rdrr.io/r/base/options.html">getOption()</a></code> allows users to move forward now, using <code><a href="https://rdrr.io/r/base/options.html">options(datatable.fread.na.strings="")</a></code>, or restore old behaviour when the default’s default is changed in future, using <code><a href="https://rdrr.io/r/base/options.html">options(datatable.fread.na.strings="NA")</a></code>.</p>
</li>
<li>
<p><code><a href="../reference/fread.html">fread()</a></code> and <code><a href="../reference/fwrite.html">fwrite()</a></code>’s <code>logical01=</code> argument :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">logical01 =<span class="st"> </span><span class="ot">FALSE</span>                         <span class="co"># old default</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"datatable.logical01"</span>, <span class="ot">FALSE</span>)   <span class="co"># this release; i.e. the same; no change yet</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/options.html">getOption</a></span>(<span class="st">"datatable.logical01"</span>, <span class="ot">TRUE</span>)    <span class="co"># future release</span></a></code></pre></div>
<p>This option controls whether a column of all 0’s and 1’s is read as <code>integer</code>, or <code>logical</code> directly to avoid needing to change the type afterwards to <code>logical</code> or use <code>colClasses</code>. <code>0/1</code> is smaller and faster than <code>"TRUE"/"FALSE"</code>, which can make a significant difference to space and time the more <code>logical</code> columns there are. When the default’s default changes to <code>TRUE</code> for <code>fread</code> we do not expect much impact since all arithmetic operators that are currently receiving 0’s and 1’s as type <code>integer</code> (think <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>) but instead could receive <code>logical</code>, would return exactly the same result on the 0’s and 1’s as <code>logical</code> type. However, code that is manipulating column types using <code>is.integer</code> or <code>is.logical</code> on <code>fread</code>’s result, could require change. It could be painful if <code>DT[(logical_column)]</code> (i.e. <code>DT[logical_column==TRUE]</code>) changed behaviour due to <code>logical_column</code> no longer being type <code>logical</code> but <code>integer</code>. But that is not the change proposed. The change is the other way around; i.e., a previously <code>integer</code> column holding only 0’s and 1’s would now be type <code>logical</code>. Since it’s that way around, we believe the scope for breakage is limited. We think a lot of code is converting 0/1 integer columns to logical anyway, either using <code>colClasses=</code> or afterwards with an assign. For <code>fwrite</code>, the level of breakage depends on the consumer of the output file. We believe <code>0/1</code> is a better more standard default choice to move to. See notes below about improvements to <code>fread</code>’s sampling for type guessing, and automatic rereading in the rare cases of out-of-sample type surprises.</p>
</li>
</ol>
<p>These options are meant for temporary use to aid your migration, <a href="https://github.com/Rdatatable/data.table/pull/2652"><a href='https://github.com/Rdatatable/data.table/issues/2652'>#2652</a></a>. You are not meant to set them to the old default and then not migrate your code that is dependent on the default. Either set the argument explicitly so your code is not dependent on the default, or change the code to cope with the new default. Over the next few years we will slowly start to remove these options, warning you if you are using them, and return to a simple default. See the history of NEWS and NEWS.0 for past migrations that have, generally speaking, been successfully managed in this way. For example, at the end of NOTES for this version (below in this file) is a note about the usage of <code>datatable.old.unique.by.key</code> now warning, as you were warned it would do over a year ago. When that change was introduced, the default was changed and that option provided an option to restore the old behaviour. These <code>fread</code>/<code>fwrite</code> changes are even more cautious and not even changing the default’s default yet. Giving you extra warning by way of this notice to move forward. And giving you a chance to object.</p>
</div>
<div id="new-features-5" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-5" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li>
<code><a href="../reference/fread.html">fread()</a></code>:
<ul>
<li>Efficiency savings at C level including <strong>parallelization</strong> announced <a href="https://github.com/Rdatatable/data.table/wiki/talks/BARUG_201704_ParallelFread.pdf">here</a>; e.g. a 9GB 2 column integer csv input is <strong>50s down to 12s</strong> to cold load on a 4 core laptop with 16GB RAM and SSD. Run <code>echo 3 &gt;/proc/sys/vm/drop_caches</code> first to measure cold load time. Subsequent load time (after file has been cached by OS on the first run) <strong>40s down to 6s</strong>.</li>
<li>The <a href="https://github.com/Rdatatable/data.table/wiki/Convenience-features-of-fread">fread for small data</a> page has been revised.</li>
<li>Memory maps lazily; e.g. reading just the first 10 rows with <code>nrow=10</code> is <strong>12s down to 0.01s</strong> from cold for the 9GB file. Large files close to your RAM limit may work more reliably too. The progress meter will commence sooner and more consistently.</li>
<li>
<code>fread</code> has always jumped to the middle and to the end of the file for a much improved column type guess. The sample size is increased from 100 rows at 10 jump jump points (1,000 rows) to 100 rows at 100 jumps points (10,000 row sample). In the rare case of there still being out-of-sample type exceptions, those columns are now <em>automatically reread</em> so you don’t have to use <code>colClasses</code> yourself.</li>
<li>Large number of columns support; e.g. <strong>12,000 columns</strong> tested.</li>
<li>
<strong>Quoting rules</strong> are more robust and flexible. See point 10 on the wiki page <a href="https://github.com/Rdatatable/data.table/wiki/Convenience-features-of-fread<a href='https://github.com/Rdatatable/data.table/issues/10'>#10</a>-automatic-quote-escape-method-detection-including-no-escape">here</a>.</li>
<li>Numeric data that has been quoted is now detected and read as numeric.</li>
<li>The ability to position <code>autostart</code> anywhere inside one of multiple tables in a single file is removed with warning. It used to search upwards from that line to find the start of the table based on a consistent number of columns. People appear to be using <code>skip="string"</code> or <code>skip=nrow</code> to find the header row exactly, which is retained and simpler. It was too difficult to retain search-upwards-autostart together with skipping/filling blank lines, filling incomplete rows and parallelization too. If there is any header info above the column names, it is still auto detected and auto skipped (particularly useful when loading a set of files where the column names start on different lines due to a varying height messy header).</li>
<li>
<code>dec=','</code> is now implemented directly so there is no dependency on locale. The options <code>datatable.fread.dec.experiment</code> and <code>datatable.fread.dec.locale</code> have been removed.</li>
<li>
<code>\\r\\r\\n</code> line endings are now handled such as produced by <code>base::download.file()</code> when it doubles up <code>\\r</code>. Other rare line endings (<code>\\r</code> and <code>\\n\\r</code>) are now more robust.</li>
<li>Mixed line endings are now handled; e.g. a file formed by concatenating a Unix file and a Windows file so that some lines end with <code>\\n</code> while others end with <code>\\r\\n</code>.</li>
<li>Improved automatic detection of whether the first row is column names by comparing the types of the fields on the first row against the column types ascertained by the 10,000 rows sample (or <code>colClasses</code> if provided). If a numeric column has a string value at the top, then column names are deemed present.</li>
<li>Detects GB-18030 and UTF-16 encodings and in verbose mode prints a message about BOM detection.</li>
<li>Detects and ignores trailing ^Z end-of-file control character sometimes created on MS DOS/Windows, <a href="https://github.com/Rdatatable/data.table/issues/1612"><a href='https://github.com/Rdatatable/data.table/issues/1612'>#1612</a></a>. Thanks to Gergely Daróczi for reporting and providing a file.</li>
<li>Added ability to recognize and parse hexadecimal floating point numbers, as used for example in Java. Thanks for <a href='https://github.com/scottstanfield'>@scottstanfield</a> <a href="https://github.com/Rdatatable/data.table/issues/2316"><a href='https://github.com/Rdatatable/data.table/issues/2316'>#2316</a></a> for the report.</li>
<li>Now handles floating-point NaN values in a wide variety of formats, including <code>NaN</code>, <code>sNaN</code>, <code>1.#QNAN</code>, <code>NaN1234</code>, <code>#NUM!</code> and others, <a href="https://github.com/Rdatatable/data.table/issues/1800"><a href='https://github.com/Rdatatable/data.table/issues/1800'>#1800</a></a>. Thanks to Jori Liesenborgs for highlighting and the PR.</li>
<li>If negative numbers are passed to <code>select=</code> the out-of-range error now suggests <code>drop=</code> instead, <a href="https://github.com/Rdatatable/data.table/issues/2423"><a href='https://github.com/Rdatatable/data.table/issues/2423'>#2423</a></a>. Thanks to Michael Chirico for the suggestion.</li>
<li>
<code>sep=NULL</code> or <code>sep=""</code> (i.e., no column separator) can now be used to specify single column input reliably like <code><a href="https://rdrr.io/r/base/readLines.html">base::readLines</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/1616"><a href='https://github.com/Rdatatable/data.table/issues/1616'>#1616</a></a>. <code>sep='\\n'</code> still works (even on Windows where line ending is actually <code>\\r\\n</code>) but <code>NULL</code> or <code>""</code> are now documented and recommended. Thanks to Dmitriy Selivanov for the pull request and many others for comments. As before, <code>sep=NA</code> is not valid; use the default <code>"auto"</code> for automatic separator detection. <code>sep='\\n'</code> is now deprecated and in future will start to warn when used.</li>
<li>Single-column input with blank lines is now valid and the blank lines are significant (representing <code>NA</code>). The blank lines are significant even at the very end, which may be surprising on first glance. The change is so that <code>fread(fwrite(DT))==DT</code> for single-column inputs containing <code>NA</code> which are written as blank. There is no change when <code>ncol&gt;1</code>; i.e., input stops with detailed warning at the first blank line, because a blank line when <code>ncol&gt;1</code> is invalid input due to no separators being present. Thanks to <a href='https://github.com/skanskan'>@skanskan</a>, Michael Chirico, <a href='https://github.com/franknarf1'>@franknarf1</a> and Pasha for the testing and discussions, <a href="https://github.com/Rdatatable/data.table/issues/2106"><a href='https://github.com/Rdatatable/data.table/issues/2106'>#2106</a></a>.</li>
<li>Too few column names are now auto filled with default column names, with warning, <a href="https://github.com/Rdatatable/data.table/issues/1625"><a href='https://github.com/Rdatatable/data.table/issues/1625'>#1625</a></a>. If there is just one missing column name it is guessed to be for the first column (row names or an index), otherwise the column names are filled at the end. Similarly, too many column names now automatically sets <code>fill=TRUE</code>, with warning.</li>
<li>
<code>skip=</code> and <code>nrow=</code> are more reliable and are no longer affected by invalid lines outside the range specified. Thanks to Ziyad Saeed and Kyle Chung for reporting, <a href="https://github.com/Rdatatable/data.table/issues/1267"><a href='https://github.com/Rdatatable/data.table/issues/1267'>#1267</a></a>.</li>
<li>Ram disk (<code>/dev/shm</code>) is no longer used for the output of system command input. Although faster when it worked, it was causing too many device full errors; e.g., <a href="https://github.com/Rdatatable/data.table/issues/1139"><a href='https://github.com/Rdatatable/data.table/issues/1139'>#1139</a></a> and <a href="https://github.com/sdparekh/zUMIs/issues/19">zUMIs/19</a>. Thanks to Kyle Chung for reporting. Standard <code><a href="https://rdrr.io/r/base/tempfile.html">tempdir()</a></code> is now used. If you wish to use ram disk, set TEMPDIR to <code>/dev/shm</code>; see <code><a href="https://rdrr.io/r/base/tempfile.html">?tempdir</a></code>.</li>
<li>Detecting whether a very long input string is a file name or data is now much faster, <a href="https://github.com/Rdatatable/data.table/issues/2531"><a href='https://github.com/Rdatatable/data.table/issues/2531'>#2531</a></a>. Many thanks to <a href='https://github.com/javrucebo'>@javrucebo</a> for the detailed report, benchmarks and suggestions.</li>
<li>A column of <code>TRUE/FALSE</code>s is ok, as well as <code>True/False</code>s and <code>true/false</code>s, but mixing styles (e.g. <code>TRUE/false</code>) is not and will be read as type <code>character</code>.</li>
<li>New argument <code>index</code> to compliment the existing <code>key</code> argument for applying secondary orderings out of the box for convenience, <a href="https://github.com/Rdatatable/data.table/issues/2633"><a href='https://github.com/Rdatatable/data.table/issues/2633'>#2633</a></a>.</li>
<li>A warning is now issued whenever incorrectly quoted fields have been detected and fixed using a non-standard quote rule. <code>fread</code> has always used these advanced rules but now it warns that it is using them. Most file writers correctly quote fields if the field contains the field separator, but a common error is not to also quote fields that contain a quote and then escape those quotes, particularly if that quote occurs at the start of the field. The ability to detect and fix such files is referred to as self-healing. Ambiguities are resolved using the knowledge that the number of columns is constant, and therefore this ability is not available when <code>fill=TRUE</code>. This feature can be improved in future by using column type consistency as well as the number of fields. For example:</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">txt =<span class="st"> 'A,B</span><span class="ch">\n</span><span class="st">1,hello</span><span class="ch">\n</span><span class="st">2,"howdy" said Joe</span><span class="ch">\n</span><span class="st">3,bonjour</span><span class="ch">\n</span><span class="st">'</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(txt)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co"># A,B</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co"># 1,hello</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co"># 2,"howdy" said Joe</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co"># 3,bonjour</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="kw"><a href="../reference/fread.html">fread</a></span>(txt)</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">       A                B</a>
<a class="sourceLine" id="cb26-9" data-line-number="9">   <span class="op">&lt;</span>int<span class="op">&gt;</span><span class="st">           </span><span class="er">&lt;</span>char<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="dv">1</span><span class="op">:</span><span class="st">     </span><span class="dv">1</span>            hello</a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="dv">2</span><span class="op">:</span><span class="st">     </span><span class="dv">2</span> <span class="st">"howdy"</span> said Joe</a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="dv">3</span><span class="op">:</span><span class="st">     </span><span class="dv">3</span>          bonjour</a>
<a class="sourceLine" id="cb26-13" data-line-number="13">Warning message<span class="op">:</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14">In <span class="kw"><a href="../reference/fread.html">fread</a></span>(txt) <span class="op">:</span><span class="st"> </span>Found and resolved improper quoting</a></code></pre></div>
<ul>
<li>Many thanks to <a href='https://github.com/yaakovfeldman'>@yaakovfeldman</a>, Guillermo Ponce, Arun Srinivasan, Hugh Parsonage, Mark Klik, Pasha Stetsenko, Mahyar K, Tom Crockett, <a href='https://github.com/cnoelke'>@cnoelke</a>, <a href='https://github.com/qinjs'>@qinjs</a>, <a href='https://github.com/etienne-s'>@etienne-s</a>, Mark Danese, Avraham Adler, <a href='https://github.com/franknarf1'>@franknarf1</a>, <a href='https://github.com/MichaelChirico'>@MichaelChirico</a>, <a href='https://github.com/tdhock'>@tdhock</a>, Luke Tierney, Ananda Mahto, <a href='https://github.com/memoryfull'>@memoryfull</a>, <a href='https://github.com/brandenkmurray'>@brandenkmurray</a> for testing dev and reporting these regressions before release to CRAN: <a href='https://github.com/Rdatatable/data.table/issues/1464'>#1464</a>, <a href='https://github.com/Rdatatable/data.table/issues/1671'>#1671</a>, <a href='https://github.com/Rdatatable/data.table/issues/1888'>#1888</a>, <a href='https://github.com/Rdatatable/data.table/issues/1895'>#1895</a>, <a href='https://github.com/Rdatatable/data.table/issues/2070'>#2070</a>, <a href='https://github.com/Rdatatable/data.table/issues/2073'>#2073</a>, <a href='https://github.com/Rdatatable/data.table/issues/2087'>#2087</a>, <a href='https://github.com/Rdatatable/data.table/issues/2091'>#2091</a>, <a href='https://github.com/Rdatatable/data.table/issues/2092'>#2092</a>, <a href='https://github.com/Rdatatable/data.table/issues/2107'>#2107</a>, <a href='https://github.com/Rdatatable/data.table/issues/2118'>#2118</a>, <a href='https://github.com/Rdatatable/data.table/issues/2123'>#2123</a>, <a href='https://github.com/Rdatatable/data.table/issues/2167'>#2167</a>, <a href='https://github.com/Rdatatable/data.table/issues/2194'>#2194</a>, <a href='https://github.com/Rdatatable/data.table/issues/2196'>#2196</a>, <a href='https://github.com/Rdatatable/data.table/issues/2201'>#2201</a>, <a href='https://github.com/Rdatatable/data.table/issues/2222'>#2222</a>, <a href='https://github.com/Rdatatable/data.table/issues/2228'>#2228</a>, <a href='https://github.com/Rdatatable/data.table/issues/2238'>#2238</a>, <a href='https://github.com/Rdatatable/data.table/issues/2246'>#2246</a>, <a href='https://github.com/Rdatatable/data.table/issues/2251'>#2251</a>, <a href='https://github.com/Rdatatable/data.table/issues/2265'>#2265</a>, <a href='https://github.com/Rdatatable/data.table/issues/2267'>#2267</a>, <a href='https://github.com/Rdatatable/data.table/issues/2285'>#2285</a>, <a href='https://github.com/Rdatatable/data.table/issues/2287'>#2287</a>, <a href='https://github.com/Rdatatable/data.table/issues/2299'>#2299</a>, <a href='https://github.com/Rdatatable/data.table/issues/2322'>#2322</a>, <a href='https://github.com/Rdatatable/data.table/issues/2347'>#2347</a>, <a href='https://github.com/Rdatatable/data.table/issues/2352'>#2352</a>, <a href='https://github.com/Rdatatable/data.table/issues/2370'>#2370</a>, <a href='https://github.com/Rdatatable/data.table/issues/2371'>#2371</a>, <a href='https://github.com/Rdatatable/data.table/issues/2395'>#2395</a>, <a href='https://github.com/Rdatatable/data.table/issues/2404'>#2404</a>, <a href='https://github.com/Rdatatable/data.table/issues/2446'>#2446</a>, <a href='https://github.com/Rdatatable/data.table/issues/2453'>#2453</a>, <a href='https://github.com/Rdatatable/data.table/issues/2457'>#2457</a>, <a href='https://github.com/Rdatatable/data.table/issues/2464'>#2464</a>, <a href='https://github.com/Rdatatable/data.table/issues/2481'>#2481</a>, <a href='https://github.com/Rdatatable/data.table/issues/2499'>#2499</a>, <a href='https://github.com/Rdatatable/data.table/issues/2512'>#2512</a>, <a href='https://github.com/Rdatatable/data.table/issues/2515'>#2515</a>, <a href='https://github.com/Rdatatable/data.table/issues/2516'>#2516</a>, <a href='https://github.com/Rdatatable/data.table/issues/2518'>#2518</a>, <a href='https://github.com/Rdatatable/data.table/issues/2520'>#2520</a>, <a href='https://github.com/Rdatatable/data.table/issues/2523'>#2523</a>, <a href='https://github.com/Rdatatable/data.table/issues/2526'>#2526</a>, <a href='https://github.com/Rdatatable/data.table/issues/2535'>#2535</a>, <a href='https://github.com/Rdatatable/data.table/issues/2542'>#2542</a>, <a href='https://github.com/Rdatatable/data.table/issues/2548'>#2548</a>, <a href='https://github.com/Rdatatable/data.table/issues/2561'>#2561</a>, <a href='https://github.com/Rdatatable/data.table/issues/2600'>#2600</a>, <a href='https://github.com/Rdatatable/data.table/issues/2625'>#2625</a>, <a href='https://github.com/Rdatatable/data.table/issues/2666'>#2666</a>, <a href='https://github.com/Rdatatable/data.table/issues/2697'>#2697</a>, <a href='https://github.com/Rdatatable/data.table/issues/2735'>#2735</a>, <a href='https://github.com/Rdatatable/data.table/issues/2744'>#2744</a>.</li>
</ul>
</li>
<li>
<code><a href="../reference/fwrite.html">fwrite()</a></code>:
<ul>
<li>empty strings are now always quoted (<code>,"",</code>) to distinguish them from <code>NA</code> which by default is still empty (<code>,,</code>) but can be changed using <code>na=</code> as before. If <code>na=</code> is provided and <code>quote=</code> is the default <code>'auto'</code> then <code>quote=</code> is set to <code>TRUE</code> so that if the <code>na=</code> value occurs in the data, it can be distinguished from <code>NA</code>. Thanks to Ethan Welty for the request <a href="https://github.com/Rdatatable/data.table/issues/2214"><a href='https://github.com/Rdatatable/data.table/issues/2214'>#2214</a></a> and Pasha for the code change and tests, <a href="https://github.com/Rdatatable/data.table/issues/2215"><a href='https://github.com/Rdatatable/data.table/issues/2215'>#2215</a></a>.</li>
<li>
<code>logical01</code> has been added and the old name <code>logicalAsInt</code> retained. Pease move to the new name when convenient for you. The old argument name (<code>logicalAsInt</code>) will slowly be deprecated over the next few years. The default is unchanged: <code>FALSE</code>, so <code>logical</code> is still written as <code>"TRUE"</code>/<code>"FALSE"</code> in full by default. We intend to change the default’s default in future to <code>TRUE</code>; see the notice at the top of these release notes.</li>
</ul>
</li>
<li><p>Added helpful message when subsetting by a logical column without wrapping it in parentheses, <a href="https://github.com/Rdatatable/data.table/issues/1844"><a href='https://github.com/Rdatatable/data.table/issues/1844'>#1844</a></a>. Thanks <a href='https://github.com/dracodoc'>@dracodoc</a> for the suggestion and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the PR.</p></li>
<li><p><code>tables</code> gains <code>index</code> argument for supplementary metadata about <code>data.table</code>s in memory (or any optionally specified environment), part of <a href="https://github.com/Rdatatable/data.table/issues/1648"><a href='https://github.com/Rdatatable/data.table/issues/1648'>#1648</a></a>. Thanks due variously to <a href='https://github.com/jangorecki'>@jangorecki</a>, <a href='https://github.com/rsaporta'>@rsaporta</a>, <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for ideas and work towards PR.</p></li>
<li><p>Improved auto-detection of <code>character</code> inputs’ formats to <code>as.ITime</code> to mirror the logic in <code>as.POSIXlt.character</code>, <a href="https://github.com/Rdatatable/data.table/issues/1383"><a href='https://github.com/Rdatatable/data.table/issues/1383'>#1383</a></a> Thanks <a href='https://github.com/franknarf1'>@franknarf1</a> for identifying a discrepancy and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for investigating.</p></li>
<li><p><code><a href="../reference/setcolorder.html">setcolorder()</a></code> now accepts less than <code><a href="https://rdrr.io/r/base/nrow.html">ncol(DT)</a></code> columns to be moved to the front, <a href="https://github.com/Rdatatable/data.table/issues/592"><a href='https://github.com/Rdatatable/data.table/issues/592'>#592</a></a>. Thanks <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the PR. This also incidentally fixed <a href="https://github.com/Rdatatable/data.table/issues/2007"><a href='https://github.com/Rdatatable/data.table/issues/2007'>#2007</a></a> whereby explicitly setting <code>select = NULL</code> in <code>fread</code> errored; thanks to <a href='https://github.com/rcapell'>@rcapell</a> for reporting that and <a href='https://github.com/dselivanov'>@dselivanov</a> and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for investigating and providing a new test.</p></li>
<li><p>Three new <em>Grouping Sets</em> functions: <code>rollup</code>, <code>cube</code> and <code>groupingsets</code>, <a href="https://github.com/Rdatatable/data.table/issues/1377"><a href='https://github.com/Rdatatable/data.table/issues/1377'>#1377</a></a>. Allows to aggregation on various grouping levels at once producing sub-totals and grand total.</p></li>
<li><p><code><a href="../reference/as.data.table.html">as.data.table()</a></code> gains new method for <code>array</code>s to return a useful data.table, <a href="https://github.com/Rdatatable/data.table/issues/1418"><a href='https://github.com/Rdatatable/data.table/issues/1418'>#1418</a></a>.</p></li>
<li>
<p><code><a href="../reference/print.data.table.html">print.data.table()</a></code> (all via master issue <a href="https://github.com/Rdatatable/data.table/issues/1523"><a href='https://github.com/Rdatatable/data.table/issues/1523'>#1523</a></a>):</p>
<ul>
<li><p>gains <code>print.keys</code> argument, <code>FALSE</code> by default, which displays the keys and/or indices (secondary keys) of a <code>data.table</code>. Thanks <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the PR, Yike Lu for the suggestion and Arun for honing that idea to its present form.</p></li>
<li><p>gains <code>col.names</code> argument, <code>"auto"</code> by default, which toggles which registers of column names to include in printed output. <code>"top"</code> forces <code>data.frame</code>-like behavior where column names are only ever included at the top of the output, as opposed to the default behavior which appends the column names below the output as well for longer (&gt;20 rows) tables. <code>"none"</code> shuts down column name printing altogether. Thanks <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the PR, Oleg Bondar for the suggestion, and Arun for guiding commentary.</p></li>
<li><p>list columns would print the first 6 items in each cell followed by a comma if there are more than 6 in that cell. Now it ends “,…” to make it clearer, part of <a href="https://github.com/Rdatatable/data.table/issues/1523"><a href='https://github.com/Rdatatable/data.table/issues/1523'>#1523</a></a>. Thanks to <a href='https://github.com/franknarf1'>@franknarf1</a> for drawing attention to an issue raised on Stack Overflow by <a href='https://github.com/TMOTTM'>@TMOTTM</a> <a href="https://stackoverflow.com/q/47679701">here</a>.</p></li>
</ul>
</li>
<li><p><code>setkeyv</code> accelerated if key already exists <a href="https://github.com/Rdatatable/data.table/issues/2331"><a href='https://github.com/Rdatatable/data.table/issues/2331'>#2331</a></a>. Thanks to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for the PR.</p></li>
<li><p>Keys and indexes are now partially retained up to the key column assigned to with ‘:=’ <a href="https://github.com/Rdatatable/data.table/issues/2372"><a href='https://github.com/Rdatatable/data.table/issues/2372'>#2372</a></a>. They used to be dropped completely if any one of the columns was affected by <code>:=</code>. Tanks to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for the PR.</p></li>
<li><p>Faster <code>as.IDate</code> and <code>as.ITime</code> methods for <code>POSIXct</code> and <code>numeric</code>, <a href="https://github.com/Rdatatable/data.table/issues/1392"><a href='https://github.com/Rdatatable/data.table/issues/1392'>#1392</a></a>. Thanks to Jan Gorecki for the PR.</p></li>
<li><p><code><a href="../reference/duplicated.html">unique(DT)</a></code> now returns <code>DT</code> early when there are no duplicates to save RAM, <a href="https://github.com/Rdatatable/data.table/issues/2013"><a href='https://github.com/Rdatatable/data.table/issues/2013'>#2013</a></a>. Thanks to Michael Chirico for the PR, and thanks to <a href='https://github.com/mgahan'>@mgahan</a> for pointing out a reversion in <code>na.omit.data.table</code> before release, <a href="https://github.com/Rdatatable/data.table/issues/2660#issuecomment-371027948"><a href='https://github.com/Rdatatable/data.table/issues/2660'>#2660</a></a>.</p></li>
<li>
<p><code><a href="../reference/duplicated.html">uniqueN()</a></code> is now faster on logical vectors. Thanks to Hugh Parsonage for <a href="https://github.com/Rdatatable/data.table/pull/2648">PR<a href='https://github.com/Rdatatable/data.table/issues/2648'>#2648</a></a>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">N =<span class="st"> </span><span class="fl">1e9</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">                                   <span class="co">#   was      now</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">NA</span>,<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">TRUE</span>,N))   <span class="co">#</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="kw"><a href="../reference/duplicated.html">uniqueN</a></span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>                    <span class="co">#  5.4s    0.00s</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="ot">TRUE</span>,<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">FALSE</span>,N), <span class="ot">NA</span>)       <span class="co">#</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="kw"><a href="../reference/duplicated.html">uniqueN</a></span>(x,<span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>         <span class="co">#  5.4s    0.00s</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7">x =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="ot">TRUE</span>,N),<span class="ot">FALSE</span>,<span class="ot">NA</span>)        <span class="co">#</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="kw"><a href="../reference/duplicated.html">uniqueN</a></span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>                    <span class="co">#  6.7s    0.38s</span></a></code></pre></div>
</li>
<li><p>Subsetting optimization with keys and indices is now possible for compound queries like <code>DT[a==1 &amp; b==2]</code>, <a href="https://github.com/Rdatatable/data.table/issues/2472"><a href='https://github.com/Rdatatable/data.table/issues/2472'>#2472</a></a>. Thanks to <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for reporting and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for the implementation.</p></li>
<li><p><code>melt.data.table</code> now offers friendlier functionality for providing <code>value.name</code> for <code>list</code> input to <code>measure.vars</code>, <a href="https://github.com/Rdatatable/data.table/issues/1547"><a href='https://github.com/Rdatatable/data.table/issues/1547'>#1547</a></a>. Thanks <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> and <a href='https://github.com/franknarf1'>@franknarf1</a> for the suggestion and use cases, <a href='https://github.com/jangorecki'>@jangorecki</a> and <a href='https://github.com/mrdwab'>@mrdwab</a> for implementation feedback, and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for ultimate implementation.</p></li>
<li><p><code>update.dev.pkg</code> is new function to update package from development repository, it will download package sources only when newer commit is available in repository. <code><a href="../reference/update.dev.pkg.html">data.table::update.dev.pkg()</a></code> defaults updates <code>data.table</code>, but any package can be used.</p></li>
<li>
<p>Item 1 in NEWS for <a href="https://github.com/Rdatatable/data.table/blob/master/NEWS.md#changes-in-v1102--on-cran-31-jan-2017">v1.10.2</a> on CRAN in Jan 2017 included :</p>
<blockquote>
<p>When j is a symbol prefixed with <code>..</code> it will be looked up in calling scope and its value taken to be column names or numbers. When you see the <code>..</code> prefix think one-level-up, like the directory <code>..</code> in all operating systems means the parent directory. In future the <code>..</code> prefix could be made to work on all symbols apearing anywhere inside <code>DT[...]</code>.</p>
</blockquote>
<p>The response has been positive (<a href="https://twitter.com/MattDowle/status/967290562725359617">this tweet</a> and <a href="https://github.com/Rdatatable/data.table/issues/2655">FR<a href='https://github.com/Rdatatable/data.table/issues/2655'>#2655</a></a>) and so this prefix is now expanded to all symbols appearing in <code>j=</code> as a first step; e.g.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">cols =<span class="st"> "colB"</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">DT[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(..cols, <span class="st">"colC"</span>)]   <span class="co"># same as DT[, .(colB,colC)]</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3">DT[, <span class="op">-</span>..cols]             <span class="co"># all columns other than colB</span></a></code></pre></div>
<p>Thus, <code>with=</code> should no longer be needed in any cases. Please change to using the <code>..</code> prefix and over the next few years we will start to formally deprecate and remove the <code>with=</code> parameter. If this is well received, the <code>..</code> prefix could be expanded to symbols appearing in <code>i=</code> and <code>by=</code>, too. Note that column names should not now start with <code>..</code>. If a symbol <code>..var</code> is used in <code>j=</code> but <code>..var</code> exists as a column name, the column still takes precedence, for backwards compatibility. Over the next few years, data.table will start issuing warnings/errors when it sees column names starting with <code>..</code>. This affects one CRAN package out of 475 using data.table, so we do not believe this restriction to be unreasonable. Our main focus here which we believe <code>..</code> achieves is to resolve the more common ambiguity when <code>var</code> is in calling scope and <code>var</code> is a column name too. Further, we have not forgotten that in the past we recommended prefixing the variable in calling scope with <code>..</code> yourself. If you did that and <code>..var</code> exists in calling scope, that still works, provided neither <code>var</code> exists in calling scope nor <code>..var</code> exists as a column name. Please now remove the <code>..</code> prefix on <code>..var</code> in calling scope to tidy this up. In future data.table will start to warn/error on such usage.</p>
</li>
<li><p><code>setindexv</code> can now assign multiple (separate) indices by accepting a <code>list</code> in the <code>cols</code> argument.</p></li>
<li><p><code>as.matrix.data.table</code> method now has an additional <code>rownames</code> argument allowing for a single column to be used as the <code>rownames</code> after conversion to a <code>matrix</code>. Thanks to <a href='https://github.com/sritchie73'>@sritchie73</a> for the suggestion, use cases, <a href="https://github.com/Rdatatable/data.table/issues/2692"><a href='https://github.com/Rdatatable/data.table/issues/2692'>#2692</a></a> and implementation <a href="https://github.com/Rdatatable/data.table/pull/2702">PR<a href='https://github.com/Rdatatable/data.table/issues/2702'>#2702</a></a> and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for additional use cases.</p></li>
</ol>
</div>
<div id="bug-fixes-6" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-6" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p>The new quote rules handles this single field <code>"Our Stock Screen Delivers an Israeli Software Company (MNDO, CTCH)&lt;\/a&gt; SmallCapInvestor.com - Thu, May 19, 2011 10:02 AM EDT&lt;\/cite&gt;&lt;\/div&gt;Yesterday in \""Google, But for Finding  Great Stocks\"", I discussed the value of stock screeners as a powerful tool"</code>, <a href="https://github.com/Rdatatable/data.table/issues/2051"><a href='https://github.com/Rdatatable/data.table/issues/2051'>#2051</a></a>. Thanks to <a href='https://github.com/scarrascoso'>@scarrascoso</a> for reporting. Example file added to test suite.</p></li>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code> creates a file with permissions that now play correctly with <code><a href="https://rdrr.io/r/base/files2.html">Sys.umask()</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/2049"><a href='https://github.com/Rdatatable/data.table/issues/2049'>#2049</a></a>. Thanks to <a href='https://github.com/gnguy'>@gnguy</a> for reporting.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code> no longer holds an open lock on the file when a line outside the large sample has too many fields and generates an error, <a href="https://github.com/Rdatatable/data.table/issues/2044"><a href='https://github.com/Rdatatable/data.table/issues/2044'>#2044</a></a>. Thanks to Hugh Parsonage for reporting.</p></li>
<li><p>Setting <code>j = {}</code> no longer results in an error, <a href="https://github.com/Rdatatable/data.table/issues/2142"><a href='https://github.com/Rdatatable/data.table/issues/2142'>#2142</a></a>. Thanks Michael Chirico for the pull request.</p></li>
<li><p>Segfault in <code><a href="../reference/rbindlist.html">rbindlist()</a></code> when one or more items are empty, <a href="https://github.com/Rdatatable/data.table/issues/2019"><a href='https://github.com/Rdatatable/data.table/issues/2019'>#2019</a></a>. Thanks Michael Lang for the pull request. Another segfault if the result would be more than 2bn rows, thanks to <a href='https://github.com/jsams'>@jsams</a>’s comment in <a href="https://github.com/Rdatatable/data.table/issues/2340#issuecomment-331505494"><a href='https://github.com/Rdatatable/data.table/issues/2340'>#2340</a></a>.</p></li>
<li><p>Error printing 0-length <code>ITime</code> and <code>NA</code> objects, <a href="https://github.com/Rdatatable/data.table/issues/2032"><a href='https://github.com/Rdatatable/data.table/issues/2032'>#2032</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/2171"><a href='https://github.com/Rdatatable/data.table/issues/2171'>#2171</a></a>. Thanks Michael Chirico for the pull requests and <a href='https://github.com/franknarf1'>@franknarf1</a> for pointing out a shortcoming of the initial fix.</p></li>
<li><p><code>as.IDate.POSIXct</code> error with <code>NULL</code> timezone, <a href="https://github.com/Rdatatable/data.table/issues/1973"><a href='https://github.com/Rdatatable/data.table/issues/1973'>#1973</a></a>. Thanks <a href='https://github.com/lbilli'>@lbilli</a> for reporting and Michael Chirico for the pull request.</p></li>
<li><p>Printing a null <code>data.table</code> with <code>print</code> no longer visibly outputs <code>NULL</code>, <a href="https://github.com/Rdatatable/data.table/issues/1852"><a href='https://github.com/Rdatatable/data.table/issues/1852'>#1852</a></a>. Thanks <a href='https://github.com/aaronmcdaid'>@aaronmcdaid</a> for spotting and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the PR.</p></li>
<li><p><code>data.table</code> now works with Shiny Reactivity / Flexdashboard. The error was typically something like <code>col not found</code> in <code>DT[col==val]</code>. Thanks to Dirk Eddelbuettel leading Matt through reproducible steps and <a href='https://github.com/sergeganakou'>@sergeganakou</a> and Richard White for reporting. Closes <a href="https://github.com/Rdatatable/data.table/issues/2001"><a href='https://github.com/Rdatatable/data.table/issues/2001'>#2001</a></a> and <a href="https://github.com/rstudio/shiny/issues/1696">shiny/<a href='https://github.com/Rdatatable/data.table/issues/1696'>#1696</a></a>.</p></li>
<li><p>The <code>as.IDate.POSIXct</code> method passed <code>tzone</code> along but was not exported. So <code>tzone</code> is now taken into account by <code>as.IDate</code> too as well as <code>IDateTime</code>, <a href="https://github.com/Rdatatable/data.table/issues/977"><a href='https://github.com/Rdatatable/data.table/issues/977'>#977</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/1498"><a href='https://github.com/Rdatatable/data.table/issues/1498'>#1498</a></a>. Tests added.</p></li>
<li><p>Named logical vector now select rows as expected from single row data.table. Thanks to <a href='https://github.com/skranz'>@skranz</a> for reporting. Closes <a href="https://github.com/Rdatatable/data.table/issues/2152"><a href='https://github.com/Rdatatable/data.table/issues/2152'>#2152</a></a>.</p></li>
<li><p><code><a href="../reference/fread.html">fread()</a></code>’s rare <code>Internal error: Sampling jump point 10 is before the last jump ended</code> has been fixed, <a href="https://github.com/Rdatatable/data.table/issues/2157"><a href='https://github.com/Rdatatable/data.table/issues/2157'>#2157</a></a>. Thanks to Frank Erickson and Artem Klevtsov for reporting with example files which are now added to the test suite.</p></li>
<li><p><code><a href="../reference/J.html">CJ()</a></code> no longer loses attribute information, <a href="https://github.com/Rdatatable/data.table/issues/2029"><a href='https://github.com/Rdatatable/data.table/issues/2029'>#2029</a></a>. Thanks to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> and <a href='https://github.com/royalts'>@royalts</a> for the pull request.</p></li>
<li><p><code>split.data.table</code> respects <code>factor</code> ordering in <code>by</code> argument, <a href="https://github.com/Rdatatable/data.table/issues/2082"><a href='https://github.com/Rdatatable/data.table/issues/2082'>#2082</a></a>. Thanks to <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for identifying and fixing the issue.</p></li>
<li><p><code>.SD</code> would incorrectly include symbol on lhs of <code>:=</code> when <code>.SDcols</code> is specified and <code><a href="https://rdrr.io/r/base/get.html">get()</a></code> appears in <code>j</code>. Thanks <a href='https://github.com/renkun-ken'>@renkun-ken</a> for reporting and the PR, and <a href='https://github.com/ProfFancyPants'>@ProfFancyPants</a> for reporing a regression introduced in the PR. Closes <a href="https://github.com/Rdatatable/data.table/issues/2326"><a href='https://github.com/Rdatatable/data.table/issues/2326'>#2326</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/2338"><a href='https://github.com/Rdatatable/data.table/issues/2338'>#2338</a></a>.</p></li>
<li><p>Integer values that are too large to fit in <code>int64</code> will now be read as strings <a href="https://github.com/Rdatatable/data.table/issues/2250"><a href='https://github.com/Rdatatable/data.table/issues/2250'>#2250</a></a>.</p></li>
<li><p>Internal-only <code>.shallow</code> now retains keys correctly, <a href="https://github.com/Rdatatable/data.table/issues/2336"><a href='https://github.com/Rdatatable/data.table/issues/2336'>#2336</a></a>. Thanks to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for reporting, fixing (<a href="https://github.com/Rdatatable/data.table/pull/2337">PR <a href='https://github.com/Rdatatable/data.table/issues/2337'>#2337</a></a>) and adding 37 tests. This much advances the journey towards exporting <code>shallow()</code>, <a href="https://github.com/Rdatatable/data.table/issues/2323"><a href='https://github.com/Rdatatable/data.table/issues/2323'>#2323</a></a>.</p></li>
<li><p><code>isoweek</code> calculation is correct regardless of local timezone setting (<code><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone()</a></code>), <a href="https://github.com/Rdatatable/data.table/issues/2407"><a href='https://github.com/Rdatatable/data.table/issues/2407'>#2407</a></a>. Thanks to <a href='https://github.com/MoebiusAV'>@MoebiusAV</a> and <a href='https://github.com/SimonCoulombe'>@SimonCoulombe</a> for reporting and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for fixing.</p></li>
<li><p>Fixed <code>as.xts.data.table</code> to support all xts supported time based index clasess <a href="https://github.com/Rdatatable/data.table/issues/2408"><a href='https://github.com/Rdatatable/data.table/issues/2408'>#2408</a></a>. Thanks to <a href='https://github.com/ebs238'>@ebs238</a> for reporting and for the PR.</p></li>
<li><p>A memory leak when a very small number such as <code>0.58E-2141</code> is bumped to type <code>character</code> is resolved, <a href="https://github.com/Rdatatable/data.table/issues/918"><a href='https://github.com/Rdatatable/data.table/issues/918'>#918</a></a>.</p></li>
<li><p>The edge case <code><a href="../reference/setattr.html">setnames(data.table(), character(0))</a></code> now works rather than error, <a href="https://github.com/Rdatatable/data.table/issues/2452"><a href='https://github.com/Rdatatable/data.table/issues/2452'>#2452</a></a>.</p></li>
<li><p>Order of rows returned in non-equi joins were incorrect in certain scenarios as reported under <a href="https://github.com/Rdatatable/data.table/issues/1991"><a href='https://github.com/Rdatatable/data.table/issues/1991'>#1991</a></a>. This is now fixed. Thanks to <a href='https://github.com/Henrik-P'>@Henrik-P</a> for reporting.</p></li>
<li><p>Non-equi joins work as expected when <code>x</code> in <code>x[i, on=...]</code> is a 0-row data.table. Closes <a href="https://github.com/Rdatatable/data.table/issues/1986"><a href='https://github.com/Rdatatable/data.table/issues/1986'>#1986</a></a>.</p></li>
<li><p>Non-equi joins along with <code>by=.EACHI</code> returned incorrect result in some rare cases as reported under <a href="https://github.com/Rdatatable/data.table/issues/2360"><a href='https://github.com/Rdatatable/data.table/issues/2360'>#2360</a></a>. This is fixed now. This fix also takes care of <a href="https://github.com/Rdatatable/data.table/issues/2275"><a href='https://github.com/Rdatatable/data.table/issues/2275'>#2275</a></a>. Thanks to <a href='https://github.com/ebs238'>@ebs238</a> for the nice minimal reproducible report, <a href='https://github.com/Mihael'>@Mihael</a> for asking on SO and to <a href='https://github.com/Frank'>@Frank</a> for following up on SO and filing an issue.</p></li>
<li><p><code>by=.EACHI</code> works now when <code>list</code> columns are being returned and some join values are missing, <a href="https://github.com/Rdatatable/data.table/issues/2300"><a href='https://github.com/Rdatatable/data.table/issues/2300'>#2300</a></a>. Thanks to <a href='https://github.com/jangorecki'>@jangorecki</a> and <a href='https://github.com/franknarf1'>@franknarf1</a> for the reproducible examples which have been added to the test suite.</p></li>
<li><p>Indices are now retrieved by exact name, <a href="https://github.com/Rdatatable/data.table/issues/2465"><a href='https://github.com/Rdatatable/data.table/issues/2465'>#2465</a></a>. This prevents usage of wrong indices as well as unexpected row reordering in join results. Thanks to <a href='https://github.com/pannnda'>@pannnda</a> for reporting and providing a reproducible example and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing.</p></li>
<li><p><code>setnames</code> of whole table when original table had <code>NA</code> names skipped replacing those, <a href="https://github.com/Rdatatable/data.table/issues/2475"><a href='https://github.com/Rdatatable/data.table/issues/2475'>#2475</a></a>. Thanks to <a href='https://github.com/franknarf1'>@franknarf1</a> and <a href="https://stackoverflow.com/questions/47228836/">BenoitLondon on StackOverflow</a> for the report and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for fixing.</p></li>
<li><p><code><a href="../reference/J.html">CJ()</a></code> works with multiple empty vectors now <a href="https://github.com/Rdatatable/data.table/issues/2511"><a href='https://github.com/Rdatatable/data.table/issues/2511'>#2511</a></a>. Thanks to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing.</p></li>
<li><p><code>:=</code> assignment of one vector to two or more columns, e.g. <code>DT[, c("x", "y") := 1:10]</code>, failed to copy the <code>1:10</code> data causing errors later if and when those columns were updated by reference, <a href="https://github.com/Rdatatable/data.table/issues/2540"><a href='https://github.com/Rdatatable/data.table/issues/2540'>#2540</a></a>. This is an old issue (<a href="https://github.com/Rdatatable/data.table/issues/185"><a href='https://github.com/Rdatatable/data.table/issues/185'>#185</a></a>) that had been fixed but reappeared when code was refactored. Thanks to <a href='https://github.com/patrickhowerter'>@patrickhowerter</a> for the detailed report with reproducible example and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing and strengthening tests so it doesn’t reappear again.</p></li>
<li><p>“Negative length vectors not allowed” error when grouping <code>median</code> and <code>var</code> fixed, <a href="https://github.com/Rdatatable/data.table/issues/2046"><a href='https://github.com/Rdatatable/data.table/issues/2046'>#2046</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/2111"><a href='https://github.com/Rdatatable/data.table/issues/2111'>#2111</a></a>. Thanks to <a href='https://github.com/caneff'>@caneff</a> and <a href='https://github.com/osofr'>@osofr</a> for reporting and to <a href='https://github.com/kmillar'>@kmillar</a> for debugging and explaining the cause.</p></li>
<li><p>Fixed a bug on Windows where <code>data.table</code>s containing non-UTF8 strings in <code>key</code>s were not properly sorted, <a href="https://github.com/Rdatatable/data.table/issues/2462"><a href='https://github.com/Rdatatable/data.table/issues/2462'>#2462</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/1826"><a href='https://github.com/Rdatatable/data.table/issues/1826'>#1826</a></a> and <a href="https://stackoverflow.com/questions/47599934/why-doesnt-r-data-table-support-well-for-non-ascii-keys-on-windows">StackOverflow</a>. Thanks to <a href='https://github.com/shrektan'>@shrektan</a> for reporting and fixing.</p></li>
<li><p><code>x.</code> prefixes during joins sometimes resulted in a “column not found” error. This is now fixed. Closes <a href="https://github.com/Rdatatable/data.table/issues/2313"><a href='https://github.com/Rdatatable/data.table/issues/2313'>#2313</a></a>. Thanks to <a href='https://github.com/franknarf1'>@franknarf1</a> for the MRE.</p></li>
<li><p><code><a href="../reference/setattr.html">setattr()</a></code> no longer segfaults when setting ‘class’ to empty character vector, <a href="https://github.com/Rdatatable/data.table/issues/2386"><a href='https://github.com/Rdatatable/data.table/issues/2386'>#2386</a></a>. Thanks to <a href='https://github.com/hatal175'>@hatal175</a> for reporting and to <a href='https://github.com/MarkusBonsch'>@MarkusBonsch</a> for fixing.</p></li>
<li><p>Fixed cases where the result of <code><a href="../reference/merge.html">merge.data.table()</a></code> would contain duplicate column names if <code>by.x</code> was also in <code><a href="https://rdrr.io/r/base/names.html">names(y)</a></code>. <code><a href="../reference/merge.html">merge.data.table()</a></code> gains the <code>no.dups</code> argument (default TRUE) to match the correpsonding patched behaviour in <code>base:::merge.data.frame()</code>. Now, when <code>by.x</code> is also in <code><a href="https://rdrr.io/r/base/names.html">names(y)</a></code> the column name from <code>y</code> has the corresponding <code>suffixes</code> added to it. <code>by.x</code> remains unchanged for backwards compatibility reasons. In addition, where duplicate column names arise anyway (i.e. <code>suffixes = c("", "")</code>) <code><a href="../reference/merge.html">merge.data.table()</a></code> will now throw a warning to match the behaviour of <code>base:::merge.data.frame()</code>. Thanks to <a href='https://github.com/sritchie73'>@sritchie73</a> for reporting and fixing <a href="https://github.com/Rdatatable/data.table/pull/2631">PR<a href='https://github.com/Rdatatable/data.table/issues/2631'>#2631</a></a> and <a href="https://github.com/Rdatatable/data.table/pull/2653">PR<a href='https://github.com/Rdatatable/data.table/issues/2653'>#2653</a></a></p></li>
<li><p><code><a href="../reference/J.html">CJ()</a></code> now fails with proper error message when results would exceed max integer, <a href="https://github.com/Rdatatable/data.table/issues/2636"><a href='https://github.com/Rdatatable/data.table/issues/2636'>#2636</a></a>.</p></li>
<li><p><code>NA</code> in character columns now display as <code>&lt;NA&gt;</code> just like base R to distinguish from <code>""</code> and <code>"NA"</code>.</p></li>
<li><p><code><a href="../reference/openmp-utils.html">getDTthreads()</a></code> could return INT_MAX (2 billion) after an explicit call to <code><a href="../reference/openmp-utils.html">setDTthreads(0)</a></code>, <a href="https://github.com/Rdatatable/data.table/pull/2708">PR<a href='https://github.com/Rdatatable/data.table/issues/2708'>#2708</a></a>.</p></li>
<li><p>Fixed a bug on Windows that <code>data.table</code> may break if the garbage collecting was triggered when sorting a large number of non-ASCII characters. Thanks to <a href='https://github.com/shrektan'>@shrektan</a> for reporting and fixing <a href="https://github.com/Rdatatable/data.table/pull/2678">PR<a href='https://github.com/Rdatatable/data.table/issues/2678'>#2678</a></a>, <a href="https://github.com/Rdatatable/data.table/issues/2674"><a href='https://github.com/Rdatatable/data.table/issues/2674'>#2674</a></a>.</p></li>
<li><p>Internal aliasing of <code>.</code> to <code>list</code> was over-aggressive in applying <code>list</code> even when <code>.</code> was intended within <code>bquote</code>, <a href="https://github.com/Rdatatable/data.table/issues/1912"><a href='https://github.com/Rdatatable/data.table/issues/1912'>#1912</a></a>. Thanks <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for reporting/filing and <a href='https://github.com/ecoRoland'>@ecoRoland</a> for suggesting and testing a fix.</p></li>
<li><p>Attempt to allocate a wildly large amount of RAM (16EB) when grouping by key and there are close to 2 billion 1-row groups, <a href="https://github.com/Rdatatable/data.table/issues/2777"><a href='https://github.com/Rdatatable/data.table/issues/2777'>#2777</a></a>. Thanks to <a href='https://github.com/jsams'>@jsams</a> for the detailed report.</p></li>
<li><p>Fix a bug that <code><a href="https://rdrr.io/r/base/print.html">print(dt, class=TRUE)</a></code> shows only <code>topn - 1</code> rows. Thanks to <a href='https://github.com/heavywatal'>@heavywatal</a> for reporting <a href="https://github.com/Rdatatable/data.table/issues/2803"><a href='https://github.com/Rdatatable/data.table/issues/2803'>#2803</a></a> and filing <a href="https://github.com/Rdatatable/data.table/pull/2804">PR<a href='https://github.com/Rdatatable/data.table/issues/2804'>#2804</a></a>.</p></li>
</ol>
</div>
<div id="notes-6" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-6" class="anchor"></a>NOTES</h2>
<ol>
<li><p>The license has been changed from GPL to MPL (Mozilla Public License). All contributors were consulted and approved. <a href="https://github.com/Rdatatable/data.table/pull/2456">PR<a href='https://github.com/Rdatatable/data.table/issues/2456'>#2456</a></a> details the reasons for the change.</p></li>
<li><p><code><a href="../reference/data.table.html">?data.table</a></code> makes explicit the option of using a <code>logical</code> vector in <code>j</code> to select columns, <a href="https://github.com/Rdatatable/data.table/issues/1978"><a href='https://github.com/Rdatatable/data.table/issues/1978'>#1978</a></a>. Thanks <a href='https://github.com/Henrik-P'>@Henrik-P</a> for the note and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for filing.</p></li>
<li><p>Test 1675.1 updated to cope with a change in R-devel in June 2017 related to <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> and <code>NA</code> levels.</p></li>
<li><p>Package <code>ezknitr</code> has been added to the whitelist of packages that run user code and should be consider data.table-aware, <a href="https://github.com/Rdatatable/data.table/issues/2266"><a href='https://github.com/Rdatatable/data.table/issues/2266'>#2266</a></a>. Thanks to Matt Mills for testing and reporting.</p></li>
<li><p>Printing with <code>quote = TRUE</code> now quotes column names as well, <a href="https://github.com/Rdatatable/data.table/issues/1319"><a href='https://github.com/Rdatatable/data.table/issues/1319'>#1319</a></a>. Thanks <a href='https://github.com/jan-glx'>@jan-glx</a> for the suggestion and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for the PR.</p></li>
<li><p>Added a blurb to <code><a href="../reference/melt.data.table.html">?melt.data.table</a></code> explicating the subtle difference in behavior of the <code>id.vars</code> argument vis-a-vis its analog in <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">reshape2::melt</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/1699"><a href='https://github.com/Rdatatable/data.table/issues/1699'>#1699</a></a>. Thanks <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for uncovering and filing.</p></li>
<li><p>Added some clarification about the usage of <code>on</code> to <code><a href="../reference/data.table.html">?data.table</a></code>, <a href="https://github.com/Rdatatable/data.table/issues/2383"><a href='https://github.com/Rdatatable/data.table/issues/2383'>#2383</a></a>. Thanks to <a href='https://github.com/peterlittlejohn'>@peterlittlejohn</a> for volunteering his confusion and <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for brushing things up.</p></li>
<li><p>Clarified that “data.table always sorts in <code>C-locale</code>” means that upper-case letters are sorted before lower-case letters by ordering in data.table (e.g. <code>setorder</code>, <code>setkey</code>, <code>DT[order(...)]</code>). Thanks to <a href='https://github.com/hughparsonage'>@hughparsonage</a> for the pull request editing the documentation. Note this makes no difference in most cases of data; e.g. ids where only uppercase or lowercase letters are used (<code>"AB123"&lt;"AC234"</code> is always true, regardless), or country names and words which are consistently capitalized. For example, <code>"America" &lt; "Brazil"</code> is not affected (it’s always true), and neither is <code>"america" &lt; "brazil"</code> (always true too); since the first letter is consistently capitalized. But, whether <code>"america" &lt; "Brazil"</code> (the words are not consistently capitalized) is true or false in base R depends on the locale of your R session. In America it is true by default and false if you i) type <code><a href="https://rdrr.io/r/base/locales.html">Sys.setlocale(locale="C")</a></code>, ii) the R session has been started in a C locale for you which can happen on servers/services (the locale comes from the environment the R session is started in). However, <code>"america" &lt; "Brazil"</code> is always, consistently false in data.table which can be a surprise because it differs to base R by default in most regions. It is false because <code>"B"&lt;"a"</code> is true because all upper-case letters come first, followed by all lower case letters (the ascii number of each letter determines the order, which is what is meant by <code>C-locale</code>).</p></li>
<li><p><code>data.table</code>’s dependency has been moved forward from R 3.0.0 (Apr 2013) to R 3.1.0 (Apr 2014; i.e. 3.5 years old). We keep this dependency as old as possible for as long as possible as requested by users in managed environments. Thanks to Jan Gorecki, the test suite from latest dev now runs on R 3.1.0 continously, as well as R-release (currently 3.4.2) and latest R-devel snapshot. The primary motivation for the bump to R 3.1.0 was allowing one new test which relies on better non-copying behaviour in that version, <a href="https://github.com/Rdatatable/data.table/issues/2484"><a href='https://github.com/Rdatatable/data.table/issues/2484'>#2484</a></a>. It also allows further internal simplifications. Thanks to <a href='https://github.com/MichaelChirico'>@MichaelChirico</a> for fixing another test that failed on R 3.1.0 due to slightly different behaviour of <code>base::read.csv</code> in R 3.1.0-only which the test was comparing to, <a href="https://github.com/Rdatatable/data.table/pull/2489"><a href='https://github.com/Rdatatable/data.table/issues/2489'>#2489</a></a>.</p></li>
<li><p>New vignette added: <em>Importing data.table</em> - focused on using data.table as a dependency in R packages. Answers most commonly asked questions and promote good practices.</p></li>
<li><p>As warned in v1.9.8 release notes below in this file (25 Nov 2016) it has been 1 year since then and so use of <code><a href="https://rdrr.io/r/base/options.html">options(datatable.old.unique.by.key=TRUE)</a></code> to restore the old default is now deprecated with warning. The new warning states that this option still works and repeats the request to pass <code>by=key(DT)</code> explicitly to <code><a href="../reference/duplicated.html">unique()</a></code>, <code><a href="../reference/duplicated.html">duplicated()</a></code>, <code><a href="../reference/duplicated.html">uniqueN()</a></code> and <code><a href="../reference/duplicated.html">anyDuplicated()</a></code> and to stop using this option. In another year, this warning will become error. Another year after that the option will be removed.</p></li>
<li>
<p>As <code><a href="../reference/set2key.html">set2key()</a></code> and <code><a href="../reference/set2key.html">key2()</a></code> have been warning since v1.9.8 (Nov 2016), their warnings have now been upgraded to errors. Note that when they were introduced in version 1.9.4 (Oct 2014) they were marked as ‘experimental’ in NEWS item 4. They will be removed in one year.</p>
<pre><code>Was warning: set2key() will be deprecated in the next relase. Please use setindex() instead.
Now error: set2key() is now deprecated. Please use setindex() instead.</code></pre>
</li>
<li><p>The option <code>datatable.showProgress</code> is no longer set to a default value when the package is loaded. Instead, the <code>default=</code> argument of <code>getOption</code> is used by both <code>fwrite</code> and <code>fread</code>. The default is the result of <code><a href="https://rdrr.io/r/base/interactive.html">interactive()</a></code> at the time of the call. Using <code>getOption</code> in this way is intended to be more helpful to users looking at <code><a href="https://rdrr.io/r/base/args.html">args(fread)</a></code> and <code><a href="../reference/fread.html">?fread</a></code>.</p></li>
<li><p><code><a href="../reference/print.data.table.html">print.data.table()</a></code> invisibly returns its first argument instead of <code>NULL</code>. This behavior is compatible with the standard <code><a href="https://rdrr.io/r/base/print.dataframe.html">print.data.frame()</a></code> and tibble’s <code>print.tbl_df()</code>. Thanks to <a href='https://github.com/heavywatal'>@heavywatal</a> for <a href="https://github.com/Rdatatable/data.table/pull/2807">PR<a href='https://github.com/Rdatatable/data.table/issues/2807'>#2807</a></a></p></li>
</ol>
</div>
</div>
    <div id="data-table-v1-10-4-3-20-oct-2017" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-10-4-3-20-oct-2017" class="anchor"></a>data.table v1.10.4-3 (20 Oct 2017)<small> 2017-10-27 </small>
</h1>
<ol>
<li>Fixed crash/hang on MacOS when <code><a href="https://rdrr.io/r/parallel/mclapply.html">parallel::mclapply</a></code> is used and data.table is merely loaded, <a href="https://github.com/Rdatatable/data.table/issues/2418"><a href='https://github.com/Rdatatable/data.table/issues/2418'>#2418</a></a>. Oddly, all tests including test 1705 (which tests <code>mclapply</code> with data.table) passed fine on CRAN. It appears to be some versions of MacOS or some versions of libraries on MacOS, perhaps. Many thanks to Martin Morgan for reporting and confirming this fix works. Thanks also to <a href='https://github.com/asenabouth'>@asenabouth</a>, Joe Thorley and Danton Noriega for testing, debugging and confirming that automatic parallelism inside data.table (such as <code>fwrite</code>) works well even on these MacOS installations. See also news items below for 1.10.4-1 and 1.10.4-2.</li>
</ol>
</div>
    <div id="data-table-v1-10-4-2-12-oct-2017" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-10-4-2-12-oct-2017" class="anchor"></a>data.table v1.10.4-2 (12 Oct 2017)<small> 2017-10-12 </small>
</h1>
<ol>
<li><p>OpenMP on MacOS is now supported by CRAN and included in CRAN’s package binaries for Mac. But installing v1.10.4-1 from source on MacOS failed when OpenMP was not enabled at compile time, <a href="https://github.com/Rdatatable/data.table/issues/2409"><a href='https://github.com/Rdatatable/data.table/issues/2409'>#2409</a></a>. Thanks to Liz Macfie and <a href='https://github.com/fupangpangpang'>@fupangpangpang</a> for reporting. The startup message when OpenMP is not enabled has been updated.</p></li>
<li><p>Two rare potential memory faults fixed, thanks to CRAN’s automated use of latest compiler tools; e.g. clang-5 and gcc-7</p></li>
</ol>
</div>
    <div id="data-table-v1-10-4-1-09-oct-2017" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-10-4-1-09-oct-2017" class="anchor"></a>data.table v1.10.4-1 (09 Oct 2017)<small> 2017-10-09 </small>
</h1>
<ol>
<li><p>The <code>nanotime</code> v0.2.0 update (June 2017) changed from <code>integer64</code> to <code>S4</code> and broke <code>fwrite</code> of <code>nanotime</code> columns. Fixed to work with <code>nanotime</code> both before and after v0.2.0.</p></li>
<li><p>Pass R-devel changes related to <code><a href="https://rdrr.io/r/base/deparse.html">deparse(,backtick=)</a></code> and <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>.</p></li>
<li><p>Internal <code>NAMED()==2</code> now <code>MAYBE_SHARED()</code>, <a href="https://github.com/Rdatatable/data.table/issues/2330"><a href='https://github.com/Rdatatable/data.table/issues/2330'>#2330</a></a>. Back-ported to pass under the stated dependency, R 3.0.0.</p></li>
<li><p>Attempted improvement on Mac-only when the <code>parallel</code> package is used too (which forks), <a href="https://github.com/Rdatatable/data.table/issues/2137"><a href='https://github.com/Rdatatable/data.table/issues/2137'>#2137</a></a>. Intel’s OpenMP implementation appears to leave threads running after the OpenMP parallel region (inside data.table) has finished unlike GNU libgomp. So, if and when <code>parallel</code>’s <code>fork</code> is invoked by the user after data.table has run in parallel already, instability occurs. The problem only occurs with Mac package binaries from CRAN because they are built by CRAN with Intel’s OpenMP library. No known problems on Windows or Linux and no known problems on any platform when <code>parallel</code> is not used. If this Mac-only fix still doesn’t work, call <code><a href="../reference/openmp-utils.html">setDTthreads(1)</a></code> immediately after <code><a href="https://rdrr.io/r/base/library.html">library(data.table)</a></code> which has been reported to fix the problem by putting <code>data.table</code> into single threaded mode earlier.</p></li>
<li><p>When <code><a href="../reference/fread.html">fread()</a></code> and <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> see <code>integer64</code> columns are present but package <code>bit64</code> is not installed, the warning is now displayed as intended. Thanks to a question by Santosh on r-help and forwarded by Bill Dunlap.</p></li>
</ol>
</div>
    <div id="data-table-v1-10-4-01-feb-2017" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-10-4-01-feb-2017" class="anchor"></a>data.table v1.10.4 (01 Feb 2017)<small> 2017-02-01 </small>
</h1>
<div id="bug-fixes-7" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-7" class="anchor"></a>BUG FIXES</h2>
<ol>
<li>The new specialized <code>nanotime</code> writer in <code><a href="../reference/fwrite.html">fwrite()</a></code> type punned using <code>*(long long *)&amp;REAL(column)[i]</code> which, strictly, is undefined behavour under C standards. It passed a plethora of tests on linux (gcc 5.4 and clang 3.8), win-builder and 6 out 10 CRAN flavours using gcc. But failed (wrong data written) with the newest version of clang (3.9.1) as used by CRAN on the failing flavors, and solaris-sparc. Replaced with the union method and added a grep to CRAN_Release.cmd.</li>
</ol>
</div>
</div>
    <div id="data-table-v1-10-2-31-jan-2017" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-10-2-31-jan-2017" class="anchor"></a>data.table v1.10.2 (31 Jan 2017)<small> 2017-01-31 </small>
</h1>
<div id="new-features-6" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-6" class="anchor"></a>NEW FEATURES</h2>
<ol>
<li>
<p>When <code>j</code> is a symbol prefixed with <code>..</code> it will be looked up in calling scope and its value taken to be column names or numbers.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">myCols =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"colA"</span>,<span class="st">"colB"</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">DT[, myCols, with=<span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">DT[, ..myCols]              <span class="co"># same</span></a></code></pre></div>
<p>When you see the <code>..</code> prefix think <em>one-level-up</em> like the directory <code>..</code> in all operating systems meaning the parent directory. In future the <code>..</code> prefix could be made to work on all symbols apearing anywhere inside <code>DT[...]</code>. It is intended to be a convenient way to protect your code from accidentally picking up a column name. Similar to how <code>x.</code> and <code>i.</code> prefixes (analogous to SQL table aliases) can already be used to disambiguate the same column name present in both <code>x</code> and <code>i</code>. A symbol prefix rather than a <code>..()</code> <em>function</em> will be easier for us to optimize internally and more convenient if you have many variables in calling scope that you wish to use in your expressions safely. This feature was first raised in 2012 and long wished for, <a href="https://github.com/Rdatatable/data.table/issues/633"><a href='https://github.com/Rdatatable/data.table/issues/633'>#633</a></a>. It is experimental.</p>
</li>
<li><p>When <code><a href="../reference/fread.html">fread()</a></code> or <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> see <code>integer64</code> columns are present, <code>bit64</code>’s namespace is now automatically loaded for convenience.</p></li>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code> now supports the new <a href="https://cran.r-project.org/package=nanotime"><code>nanotime</code></a> type by Dirk Eddelbuettel, <a href="https://github.com/Rdatatable/data.table/issues/1982"><a href='https://github.com/Rdatatable/data.table/issues/1982'>#1982</a></a>. Aside: <code>data.table</code> already automatically supported <code>nanotime</code> in grouping and joining operations via longstanding support of its underlying <code>integer64</code> type.</p></li>
<li>
<p><code><a href="../reference/setkey.html">indices()</a></code> gains a new argument <code>vectors</code>, default <code>FALSE</code>. This strsplits the index names by <code>__</code> for you, <a href="https://github.com/Rdatatable/data.table/issues/1589"><a href='https://github.com/Rdatatable/data.table/issues/1589'>#1589</a></a>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">DT =<span class="st"> </span><span class="kw"><a href="../reference/data.table.html">data.table</a></span>(<span class="dt">A=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">B=</span><span class="dv">6</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="kw"><a href="../reference/setkey.html">setindex</a></span>(DT, B)</a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="kw"><a href="../reference/setkey.html">setindex</a></span>(DT, B, A)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="kw"><a href="../reference/setkey.html">indices</a></span>(DT)</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">[<span class="dv">1</span>] <span class="st">"B"</span>    <span class="st">"B__A"</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="kw"><a href="../reference/setkey.html">indices</a></span>(DT, <span class="dt">vectors=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">[<span class="dv">1</span>] <span class="st">"B"</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9">[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb31-10" data-line-number="10">[<span class="dv">1</span>] <span class="st">"B"</span> <span class="st">"A"</span></a></code></pre></div>
</li>
</ol>
</div>
<div id="bug-fixes-8" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-8" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p>Some long-standing potential instability has been discovered and resolved many thanks to a detailed report from Bill Dunlap and Michael Sannella. At C level any call of the form <code>setAttrib(x, install(), allocVector())</code> can be unstable in any R package. Despite <code>setAttrib()</code> PROTECTing its inputs, the 3rd argument (<code>allocVector</code>) can be executed first only for its result to to be released by <code>install()</code>’s potential GC before reaching <code>setAttrib</code>’s PROTECTion of its inputs. Fixed by either PROTECTing or pre-<code>install()</code>ing. Added to CRAN_Release.cmd procedures: i) <code>grep</code>s to prevent usage of this idiom in future and ii) running data.table’s test suite with <code><a href="https://rdrr.io/r/base/gctorture.html">gctorture(TRUE)</a></code>.</p></li>
<li><p>A new potential instability introduced in the last release (v1.10.0) in GForce optimized grouping has been fixed by reverting one change from malloc to R_alloc. Thanks again to Michael Sannella for the detailed report.</p></li>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code> could write floating point values incorrectly, <a href="https://github.com/Rdatatable/data.table/issues/1968"><a href='https://github.com/Rdatatable/data.table/issues/1968'>#1968</a></a>. A thread-local variable was incorrectly thread-global. This variable’s usage lifetime is only a few clock cycles so it needed large data and many threads for several threads to overlap their usage of it and cause the problem. Many thanks to <a href='https://github.com/mgahan'>@mgahan</a> and <a href='https://github.com/jmosser'>@jmosser</a> for finding and reporting.</p></li>
</ol>
</div>
<div id="notes-7" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-7" class="anchor"></a>NOTES</h2>
<ol>
<li><p><code><a href="../reference/fwrite.html">fwrite()</a></code>’s <code>..turbo</code> option has been removed as the warning message warned. If you’ve found a problem, please <a href="https://github.com/Rdatatable/data.table/issues">report it</a>.</p></li>
<li><p>No known issues have arisen due to <code>DT[,1]</code> and <code>DT[,c("colA","colB")]</code> now returning columns as introduced in v1.9.8. However, as we’ve moved forward by setting <code><a href="https://rdrr.io/r/base/options.html">options('datatable.WhenJisSymbolThenCallingScope'=TRUE)</a></code> introduced then too, it has become clear a better solution is needed. All 340 CRAN and Bioconductor packages that use data.table have been checked with this option on. 331 lines would need to be changed in 59 packages. Their usage is elegant, correct and recommended, though. Examples are <code>DT[1, encoding]</code> in quanteda and <code>DT[winner=="first", freq]</code> in xgboost. These are looking up the columns <code>encoding</code> and <code>freq</code> respectively and returning them as vectors. But if, for some reason, those columns are removed from <code>DT</code> and <code>encoding</code> or <code>freq</code> are still variables in calling scope, their values in calling scope would be returned. Which cannot be what was intended and could lead to silent bugs. That was the risk we were trying to avoid. <br><code><a href="https://rdrr.io/r/base/options.html">options('datatable.WhenJisSymbolThenCallingScope')</a></code> is now removed. A migration timeline is no longer needed. The new strategy needs no code changes and has no breakage. It was proposed and discussed in point 2 <a href="https://github.com/Rdatatable/data.table/issues/1188#issuecomment-127824969">here</a>, as follows.<br> When <code>j</code> is a symbol (as in the quanteda and xgboost examples above) it will continue to be looked up as a column name and returned as a vector, as has always been the case. If it’s not a column name however, it is now a helpful error explaining that data.table is different to data.frame and what to do instead (use <code>..</code> prefix or <code>with=FALSE</code>). The old behaviour of returning the symbol’s value in calling scope can never have been useful to anybody and therefore not depended on. Just as the <code>DT[,1]</code> change could be made in v1.9.8, this change can be made now. This change increases robustness with no downside. Rerunning all 340 CRAN and Bioconductor package checks reveal 2 packages throwing the new error: partools and simcausal. Their maintainers have been informed that there is a likely bug on those lines due to data.table’s (now remedied) weakness. This is exactly what we wanted to reveal and improve.</p></li>
<li><p>As before, and as we can see is in common use in CRAN and Bioconductor packages using data.table, <code>DT[,myCols,with=FALSE]</code> continues to lookup <code>myCols</code> in calling scope and take its value as column names or numbers. You can move to the new experimental convenience feature <code>DT[, ..myCols]</code> if you wish at leisure.</p></li>
</ol>
</div>
</div>
    <div id="data-table-v1-10-0-03-dec-2016" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-10-0-03-dec-2016" class="anchor"></a>data.table v1.10.0 (03 Dec 2016)<small> 2016-12-03 </small>
</h1>
<div id="bug-fixes-9" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-9" class="anchor"></a>BUG FIXES</h2>
<ol>
<li><p><code><a href="../reference/fwrite.html">fwrite(..., quote='auto')</a></code> already quoted a field if it contained a <code>sep</code> or <code>\n</code>, or <code>sep2[2]</code> when <code>list</code> columns are present. Now it also quotes a field if it contains a double quote (<code>"</code>) as documented, <a href="https://github.com/Rdatatable/data.table/issues/1925"><a href='https://github.com/Rdatatable/data.table/issues/1925'>#1925</a></a>. Thanks to Aki Matsuo for reporting. Tests added. The <code>qmethod</code> tests did test escaping embedded double quotes, but only when <code>sep</code> or <code>\n</code> was present in the field as well to trigger the quoting of the field.</p></li>
<li><p>Fixed 3 test failures on Solaris only, <a href="https://github.com/Rdatatable/data.table/issues/1934"><a href='https://github.com/Rdatatable/data.table/issues/1934'>#1934</a></a>. Two were on both sparc and x86 and related to a <code>tzone</code> attribute difference between <code>as.POSIXct</code> and <code>as.POSIXlt</code> even when passed the default <code>tz=""</code>. The third was on sparc only: a minor rounding issue in <code><a href="../reference/fwrite.html">fwrite()</a></code> of 1e-305.</p></li>
<li><p>Regression crash fixed when 0’s occur at the end of a non-empty subset of an empty table, <a href="https://github.com/Rdatatable/data.table/issues/1937"><a href='https://github.com/Rdatatable/data.table/issues/1937'>#1937</a></a>. Thanks Arun for tracking down. Tests added. For example, subsetting the empty <code>DT=data.table(a=character())</code> with <code>DT[c(1,0)]</code> should return a 1 row result with one <code>NA</code> since 1 is past the end of <code>nrow(DT)==0</code>, the same result as <code>DT[1]</code>.</p></li>
<li><p>Fixed newly reported crash that also occurred in old v1.9.6 when <code>by=.EACHI</code>, <code>nomatch=0</code>, the first item in <code>i</code> has no match AND <code>j</code> has a function call that is passed a key column, <a href="https://github.com/Rdatatable/data.table/issues/1933"><a href='https://github.com/Rdatatable/data.table/issues/1933'>#1933</a></a>. Many thanks to Reino Bruner for finding and reporting with a reproducible example. Tests added.</p></li>
<li><p>Fixed <code><a href="../reference/fread.html">fread()</a></code> error occurring for a subset of Windows users: <code>showProgress is not type integer but type 'logical'.</code>, <a href="https://github.com/Rdatatable/data.table/issues/1944"><a href='https://github.com/Rdatatable/data.table/issues/1944'>#1944</a></a> and <a href="https://github.com/Rdatatable/data.table/issues/1111"><a href='https://github.com/Rdatatable/data.table/issues/1111'>#1111</a></a>. Our tests cover this usage (it is just default usage), pass on AppVeyor (Windows), win-builder (Windows) and CRAN’s Windows so perhaps it only occurs on a specific and different version of Windows to all those. Thanks to <a href='https://github.com/demydd'>@demydd</a> for reporting. Fixed by using strictly <code>logical</code> type at R level and <code>Rboolean</code> at C level, consistently throughout.</p></li>
<li><p>Combining <code>on=</code> (new in v1.9.6) with <code>by=</code> or <code>keyby=</code> gave incorrect results, <a href="https://github.com/Rdatatable/data.table/issues/1943"><a href='https://github.com/Rdatatable/data.table/issues/1943'>#1943</a></a>. Many thanks to Henrik-P for the detailed and reproducible report. Tests added.</p></li>
<li><p>New function <code>rleidv</code> was ignoring its <code>cols</code> argument, <a href="https://github.com/Rdatatable/data.table/issues/1942"><a href='https://github.com/Rdatatable/data.table/issues/1942'>#1942</a></a>. Thanks Josh O’Brien for reporting. Tests added.</p></li>
</ol>
</div>
<div id="notes-8" class="section level2">
<h2 class="hasAnchor">
<a href="#notes-8" class="anchor"></a>NOTES</h2>
<ol>
<li><p>It seems OpenMP is not available on CRAN’s Mac platform; NOTEs appeared in <a href="https://cran.r-project.org/web/checks/check_results_data.table.html">CRAN checks</a> for v1.9.8. Moved <code>Rprintf</code> from <code>init.c</code> to <code>packageStartupMessage</code> to avoid the NOTE as requested urgently by Professor Ripley. Also fixed the bad grammar of the message: ‘single threaded’ now ‘single-threaded’. If you have a Mac and run macOS or OS X on it (I run Ubuntu on mine) please contact CRAN maintainers and/or Apple if you’d like CRAN’s Mac binary to support OpenMP. Otherwise, please follow <a href="https://github.com/Rdatatable/data.table/wiki/Installation">these instructions for OpenMP on Mac</a> which people have reported success with.</p></li>
<li><p>Just to state explicitly: data.table does not now depend on or require OpenMP. If you don’t have it (as on CRAN’s Mac it appears but not in general on Mac) then data.table should build, run and pass all tests just fine.</p></li>
<li><p>There are now 5,910 raw tests as reported by <code><a href="../reference/test.data.table.html">test.data.table()</a></code>. Tests cover 91% of the 4k lines of R and 89% of the 7k lines of C. These stats are now known thanks to Jim Hester’s <a href="https://CRAN.R-project.org/package=covr">Covr</a> package and <a href="https://codecov.io/">Codecov.io</a>. If anyone is looking for something to help with, creating tests to hit the missed lines shown by clicking the <code>R</code> and <code>src</code> folders at the bottom <a href="https://codecov.io/github/Rdatatable/data.table?branch=master">here</a> would be very much appreciated.</p></li>
<li><p>The FAQ vignette has been revised given the changes in v1.9.8. In particular, the very first FAQ.</p></li>
<li><p>With hindsight, the last release v1.9.8 should have been named v1.10.0 to convey it wasn’t just a patch release from .6 to .8 owing to the ‘potentially breaking changes’ items. Thanks to <a href='https://github.com/neomantic'>@neomantic</a> for correctly pointing out. The best we can do now is now bump to 1.10.0.</p></li>
</ol>
</div>
</div>
    <div id="data-table-v1-9-8-nov-2016-back-to-v1-2-aug-2008-has-been-moved-to-news-0-md" class="section level1">
<h1 class="page-header">
<a href="#data-table-v1-9-8-nov-2016-back-to-v1-2-aug-2008-has-been-moved-to-news-0-md" class="anchor"></a><small> 2016-11-25 </small>data.table v1.9.8 (Nov 2016) back to v1.2 (Aug 2008) has been moved to <a href="https://github.com/Rdatatable/data.table/blob/master/NEWS.0.md">NEWS.0.md</a>
</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
        <li><a href="#data-table-v1-12-6">1.12.6</a></li>
        <li><a href="#data-table-v1-12-4-03-oct-2019">1.12.4</a></li>
        <li><a href="#data-table-v1-12-2-07-apr-2019">1.12.2</a></li>
        <li><a href="#data-table-v1-12-0-13-jan-2019">1.12.0</a></li>
        <li><a href="#data-table-v1-11-8-30-sep-2018">1.11.8</a></li>
        <li><a href="#data-table-v1-11-6-19-sep-2018">1.11.6</a></li>
        <li><a href="#data-table-v1-11-4-27-may-2018">1.11.4</a></li>
        <li><a href="#data-table-v1-11-2-08-may-2018">1.11.2</a></li>
        <li><a href="#data-table-v1-11-0-01-may-2018">1.11.0</a></li>
        <li><a href="#data-table-v1-10-4-3-20-oct-2017">1.10.4-3</a></li>
        <li><a href="#data-table-v1-10-4-2-12-oct-2017">1.10.4-2</a></li>
        <li><a href="#data-table-v1-10-4-1-09-oct-2017">1.10.4-1</a></li>
        <li><a href="#data-table-v1-10-4-01-feb-2017">1.10.4</a></li>
        <li><a href="#data-table-v1-10-2-31-jan-2017">1.10.2</a></li>
        <li><a href="#data-table-v1-10-0-03-dec-2016">1.10.0</a></li>
        <li><a href="#data-table-v1-9-8-nov-2016-back-to-v1-2-aug-2008-has-been-moved-to-news-0-md">1.9.8</a></li>
      </ul>
    </div>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matt Dowle, Arun Srinivasan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


