<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast dcast for data.table — dcast.data.table • data.table</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast dcast for data.table — dcast.data.table" />
<meta property="og:description" content="dcast.data.table is data.table's long-to-wide reshaping tool. In the spirit of data.table, it is very fast and memory efficient, making it well-suited to handling large data sets in RAM.  More importantly, it is capable of handling very large data quite efficiently in terms of memory usage. dcast.data.table can also cast multiple value.var columns and accepts multiple functions to fun.aggregate. See Examples for more." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">data.table</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.12.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/datatable-benchmarking.html">Benchmarking data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-faq.html">Frequently Asked Questions about data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-importing.html">Importing data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-intro.html">Introduction to data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-keys-fast-subset.html">Keys and fast binary search based subset</a>
    </li>
    <li>
      <a href="../articles/datatable-reference-semantics.html">Reference semantics</a>
    </li>
    <li>
      <a href="../articles/datatable-reshape.html">Efficient reshaping using data.tables</a>
    </li>
    <li>
      <a href="../articles/datatable-sd-usage.html">Using .SD for Data Analysis</a>
    </li>
    <li>
      <a href="../articles/datatable-secondary-indices-and-auto-indexing.html">Secondary indices and auto indexing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Rdatatable/data.table">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast dcast for data.table</h1>
    
    <div class="hidden name"><code>dcast.data.table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>dcast.data.table</code> is <code>data.table</code>'s long-to-wide reshaping tool. In the spirit of <code>data.table</code>, it is very fast and memory efficient, making it well-suited to handling large data sets in RAM.  More importantly, it is capable of handling very large data quite efficiently in terms of memory usage. <code>dcast.data.table</code> can also cast multiple <code>value.var</code> columns and accepts multiple functions to <code>fun.aggregate</code>. See Examples for more.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for data.table</span>
<span class='fu'>dcast</span>(<span class='no'>data</span>, <span class='no'>formula</span>, <span class='kw'>fun.aggregate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"_"</span>,
    <span class='no'>...</span>, <span class='kw'>margins</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>value.var</span> <span class='kw'>=</span> <span class='fu'>guess</span>(<span class='no'>data</span>),
    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"datatable.verbose"</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A <code>data.table</code>.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A formula of the form LHS ~ RHS to cast, see Details.</p></td>
    </tr>
    <tr>
      <th>fun.aggregate</th>
      <td><p>Should the data be aggregated before casting? If the formula doesn't identify a single observation for each cell, then aggregation defaults to <code>length</code> with a message.</p>
<p>To use multiple aggregation functions, pass a <code>list</code>; see Examples.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>Character vector of length 1, indicating the separating character in variable names generated during casting. Default is <code>_</code> for backwards compatibility.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any other arguments that may be passed to the aggregating function.</p></td>
    </tr>
    <tr>
      <th>margins</th>
      <td><p>Not implemented yet. Should take variable names to compute margins on. A value of <code>TRUE</code> would compute all margins.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>Specified if casting should be done on a subset of the data. Ex: <code>subset = .(col1 &lt;= 5)</code> or <code>subset = .(variable != "January")</code>.</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>Value with which to fill missing cells. If <code>fun.aggregate</code> is present, takes the value by applying the function on a 0-length vector.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p><code>FALSE</code> will cast by including all missing combinations.</p>
<p><code><a href='https://rdrr.io/r/base/c.html'>c(FALSE, TRUE)</a></code> will only include all missing combinations of formula <code>LHS</code>; <code><a href='https://rdrr.io/r/base/c.html'>c(TRUE, FALSE)</a></code> will only include all missing combinations of formula RHS. See Examples.</p></td>
    </tr>
    <tr>
      <th>value.var</th>
      <td><p>Name of the column whose values will be filled to cast. Function <code>guess()</code> tries to, well, guess this column automatically, if none is provided.</p>
<p>Cast multiple <code>value.var</code> columns simultaneously by passing their names as a <code>character</code> vector. See Examples.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Not used yet. May be dropped in the future or used to provide informative messages through the console.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The cast formula takes the form <code>LHS ~ RHS</code>, ex: <code>var1 + var2 ~ var3</code>. The order of entries in the formula is essential. There are two special variables: <code>.</code> represents no variable, while <code>...</code> represents all variables not otherwise mentioned in <code>formula</code>; see Examples.</p>
<p>When not all combinations of LHS &amp; RHS values are present in the data, some or all (in accordance with <code>drop</code>) missing combinations will replaced with the value specified by <code>fill</code>. Note that <code>fill</code> will be converted to the class of <code>value.var</code>; see Examples.</p>
<p><code>dcast</code> also allows <code>value.var</code> columns of type <code>list</code>.</p>
<p>When variable combinations in <code>formula</code> don't identify a unique value, <code>fun.aggregate</code> will have to be specified, which defaults to <code>length</code>. For the formula <code>var1 ~ var2</code>, this means there are some <code>(var1, var2)</code> combinations in the data corresponding to multiple rows (i.e. <code>x</code> is not unique by <code>(var1, var2)</code>.</p>
<p>The aggregating function should take a vector as input and return a single value (or a list of length one) as output. In cases where <code>value.var</code> is a list, the function should be able to handle a list input and provide a single value or list of length one as output.</p>
<p>If the formula's LHS contains the same column more than once, ex: <code>dcast(DT, x+x~ y)</code>, then the answer will have duplicate names. In those cases, the duplicate names are renamed using <code>make.unique</code> so that key can be set without issues.</p>
<p>Names for columns that are being cast are generated in the same order (separated by an underscore, <code>_</code>) from the (unique) values in each column mentioned in the formula RHS.</p>
<p>From <code>v1.9.4</code>, <code>dcast</code> tries to preserve attributes wherever possible.</p>
<p>From <code>v1.9.6</code>, it is possible to cast multiple <code>value.var</code> columns and also cast by providing multiple <code>fun.aggregate</code> functions. Multiple <code>fun.aggregate</code> functions should be provided as a <code>list</code>, for e.g., <code>list(mean, sum, function(x) paste(x, collapse="")</code>. <code>value.var</code> can be either a character vector or list of length one, or a list of length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(fun.aggregate)</a></code>. When <code>value.var</code> is a character vector or a list of length one, each function mentioned under <code>fun.aggregate</code> is applied to every column specified under <code>value.var</code> column. When <code>value.var</code> is a list of length equal to <code><a href='https://rdrr.io/r/base/length.html'>length(fun.aggregate)</a></code> each element of <code>fun.aggregate</code> is applied to each element of <code>value.var</code> column.</p>
<p>Historical note: <code>dcast.data.table</code> was originally designed as an enhancement to <code><a href='https://rdrr.io/pkg/reshape2/man/cast.html'>reshape2::dcast</a></code> in terms of computing and memory efficiency. <code>reshape2</code> has since been deprecated, and <code>dcast</code> has had a generic defined within <code>data.table</code> since <code>v1.9.6</code> in 2015, at which point the dependency between the packages became more etymological than programmatic. We thank the <code>reshape2</code> authors for the inspiration.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A keyed <code>data.table</code> that has been cast. The key columns are equal to the variables in the <code>formula</code> LHS in the same order.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='melt.data.table.html'>melt.data.table</a></code>, <code><a href='rowid.html'>rowid</a></code>, <a href='https://cran.r-project.org/package=reshape'>https://cran.r-project.org/package=reshape</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>ChickWeight</span> <span class='kw'>=</span> <span class='fu'><a href='as.data.table.html'>as.data.table</a></span>(<span class='no'>ChickWeight</span>)
<span class='fu'><a href='setattr.html'>setnames</a></span>(<span class='no'>ChickWeight</span>, <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>ChickWeight</span>)))
<span class='no'>DT</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='melt.data.table.html'>melt</a></span>(<span class='fu'><a href='as.data.table.html'>as.data.table</a></span>(<span class='no'>ChickWeight</span>), <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>2</span>:<span class='fl'>4</span>) <span class='co'># calls melt.data.table</span>

<span class='co'># dcast is an S3 method in data.table from v1.9.6</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>time</span> ~ <span class='no'>variable</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='no'>mean</span>) <span class='co'># using partial matching of argument</span></div><div class='output co'>#&gt;     time    weight
#&gt;  1:    0  41.06000
#&gt;  2:    2  49.22000
#&gt;  3:    4  59.95918
#&gt;  4:    6  74.30612
#&gt;  5:    8  91.24490
#&gt;  6:   10 107.83673
#&gt;  7:   12 129.24490
#&gt;  8:   14 143.81250
#&gt;  9:   16 168.08511
#&gt; 10:   18 190.19149
#&gt; 11:   20 209.71739
#&gt; 12:   21 218.68889</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>diet</span> ~ <span class='no'>variable</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='no'>mean</span>)</div><div class='output co'>#&gt;    diet   weight
#&gt; 1:    1 102.6455
#&gt; 2:    2 122.6167
#&gt; 3:    3 142.9500
#&gt; 4:    4 135.2627</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>diet</span>+<span class='no'>chick</span> ~ <span class='no'>time</span>, <span class='kw'>drop</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt;      diet chick  0  2  4  6   8  10  12  14  16  18  20  21
#&gt;   1:    1    18 39 35 NA NA  NA  NA  NA  NA  NA  NA  NA  NA
#&gt;   2:    1    16 41 45 49 51  57  51  54  NA  NA  NA  NA  NA
#&gt;   3:    1    15 41 49 56 64  68  68  67  68  NA  NA  NA  NA
#&gt;   4:    1    13 41 48 53 60  65  67  71  70  71  81  91  96
#&gt;   5:    1     9 42 51 59 68  85  96  90  92  93 100 100  98
#&gt;  ---                                                       
#&gt; 196:    4    49 40 53 64 85 108 128 152 166 184 203 233 237
#&gt; 197:    4    46 40 52 62 82 101 120 144 156 173 210 231 238
#&gt; 198:    4    50 41 54 67 84 105 122 155 175 205 234 264 264
#&gt; 199:    4    42 42 49 63 84 103 126 160 174 204 234 269 281
#&gt; 200:    4    48 39 50 62 80 104 125 154 170 222 261 303 322</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>diet</span>+<span class='no'>chick</span> ~ <span class='no'>time</span>, <span class='kw'>drop</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>fill</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt;      diet chick  0  2  4  6   8  10  12  14  16  18  20  21
#&gt;   1:    1    18 39 35  0  0   0   0   0   0   0   0   0   0
#&gt;   2:    1    16 41 45 49 51  57  51  54   0   0   0   0   0
#&gt;   3:    1    15 41 49 56 64  68  68  67  68   0   0   0   0
#&gt;   4:    1    13 41 48 53 60  65  67  71  70  71  81  91  96
#&gt;   5:    1     9 42 51 59 68  85  96  90  92  93 100 100  98
#&gt;  ---                                                       
#&gt; 196:    4    49 40 53 64 85 108 128 152 166 184 203 233 237
#&gt; 197:    4    46 40 52 62 82 101 120 144 156 173 210 231 238
#&gt; 198:    4    50 41 54 67 84 105 122 155 175 205 234 264 264
#&gt; 199:    4    42 42 49 63 84 103 126 160 174 204 234 269 281
#&gt; 200:    4    48 39 50 62 80 104 125 154 170 222 261 303 322</div><div class='input'>
<span class='co'># using subset</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>chick</span> ~ <span class='no'>time</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='no'>mean</span>, <span class='kw'>subset</span><span class='kw'>=</span><span class='fu'>.</span>(<span class='no'>time</span> <span class='kw'>&lt;</span> <span class='fl'>10</span> <span class='kw'>&amp;</span> <span class='no'>chick</span> <span class='kw'>&lt;</span> <span class='fl'>20</span>))</div><div class='output co'>#&gt;    chick  0  2   4   6   8
#&gt; 1:    18 39 35 NaN NaN NaN
#&gt; 2:    16 41 45  49  51  57
#&gt; 3:    15 41 49  56  64  68
#&gt; 4:    13 41 48  53  60  65
#&gt; 5:     9 42 51  59  68  85</div><div class='input'>
<span class='co'># drop argument, #1512</span>
<span class='no'>DT</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='data.table.html'>data.table</a></span>(<span class='kw'>v1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.1</span>, <span class='fl'>1.1</span>, <span class='fl'>1.1</span>, <span class='fl'>2.2</span>, <span class='fl'>2.2</span>, <span class='fl'>2.2</span>),
                 <span class='kw'>v2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>3L</span>, <span class='fl'>3L</span>, <span class='fl'>3L</span>), <span class='kw'>levels</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>3</span>),
                 <span class='kw'>v3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2L</span>, <span class='fl'>3L</span>, <span class='fl'>5L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>6L</span>), <span class='kw'>levels</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>6</span>),
                 <span class='kw'>v4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>5L</span>, <span class='fl'>4L</span>, <span class='fl'>3L</span>))
<span class='co'># drop=TRUE</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v1</span> + <span class='no'>v2</span> ~ <span class='no'>v3</span>)                      <span class='co'># default is drop=TRUE</span></div><div class='output co'>#&gt; <span class='message'>Using 'v4' as value column. Use 'value.var' to override</span></div><div class='output co'>#&gt;     v1 v2  1 2  3  5  6
#&gt; 1: 1.1  1 NA 3  2  2 NA
#&gt; 2: 2.2  3  5 4 NA NA  3</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v1</span> + <span class='no'>v2</span> ~ <span class='no'>v3</span>, <span class='kw'>drop</span><span class='kw'>=</span><span class='fl'>FALSE</span>)          <span class='co'># all missing combinations of both LHS and RHS</span></div><div class='output co'>#&gt; <span class='message'>Using 'v4' as value column. Use 'value.var' to override</span></div><div class='output co'>#&gt;     v1 v2  1  2  3  4  5  6
#&gt; 1: 1.1  1 NA  3  2 NA  2 NA
#&gt; 2: 1.1  2 NA NA NA NA NA NA
#&gt; 3: 1.1  3 NA NA NA NA NA NA
#&gt; 4: 2.2  1 NA NA NA NA NA NA
#&gt; 5: 2.2  2 NA NA NA NA NA NA
#&gt; 6: 2.2  3  5  4 NA NA NA  3</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v1</span> + <span class='no'>v2</span> ~ <span class='no'>v3</span>, <span class='kw'>drop</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>FALSE</span>, <span class='fl'>TRUE</span>)) <span class='co'># all missing combinations of only LHS</span></div><div class='output co'>#&gt; <span class='message'>Using 'v4' as value column. Use 'value.var' to override</span></div><div class='output co'>#&gt;     v1 v2  1  2  3  5  6
#&gt; 1: 1.1  1 NA  3  2  2 NA
#&gt; 2: 1.1  2 NA NA NA NA NA
#&gt; 3: 1.1  3 NA NA NA NA NA
#&gt; 4: 2.2  1 NA NA NA NA NA
#&gt; 5: 2.2  2 NA NA NA NA NA
#&gt; 6: 2.2  3  5  4 NA NA  3</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v1</span> + <span class='no'>v2</span> ~ <span class='no'>v3</span>, <span class='kw'>drop</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>)) <span class='co'># all missing combinations of only RHS</span></div><div class='output co'>#&gt; <span class='message'>Using 'v4' as value column. Use 'value.var' to override</span></div><div class='output co'>#&gt;     v1 v2  1 2  3  4  5  6
#&gt; 1: 1.1  1 NA 3  2 NA  2 NA
#&gt; 2: 2.2  3  5 4 NA NA NA  3</div><div class='input'>
<span class='co'># using . and ...</span>
<span class='no'>DT</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='data.table.html'>data.table</a></span>(<span class='kw'>v1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>6</span>),
                 <span class='kw'>v2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>, <span class='fl'>2</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>2</span>),
                 <span class='kw'>v3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>2</span>, <span class='fl'>6</span>),
                 <span class='kw'>v4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>6</span>))
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>...</span> ~ <span class='no'>v3</span>, <span class='kw'>value.var</span> <span class='kw'>=</span> <span class='st'>"v4"</span>) <span class='co'>#same as v1 + v2 ~ v3, value.var = "v4"</span></div><div class='output co'>#&gt;    v1 v2          1          2
#&gt; 1:  1  1 -0.2713771 -0.1364510
#&gt; 2:  1  2  0.2413600 -0.9840585
#&gt; 3:  1  3 -0.5286298 -1.4844445
#&gt; 4:  2  1 -0.2713771 -0.1364510
#&gt; 5:  2  2  0.2413600 -0.9840585
#&gt; 6:  2  3 -0.5286298 -1.4844445</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v1</span> + <span class='no'>v2</span> + <span class='no'>v3</span> ~ <span class='no'>.</span>, <span class='kw'>value.var</span> <span class='kw'>=</span> <span class='st'>"v4"</span>)</div><div class='output co'>#&gt;     v1 v2 v3          .
#&gt;  1:  1  1  1 -0.2713771
#&gt;  2:  1  1  2 -0.1364510
#&gt;  3:  1  2  1  0.2413600
#&gt;  4:  1  2  2 -0.9840585
#&gt;  5:  1  3  1 -0.5286298
#&gt;  6:  1  3  2 -1.4844445
#&gt;  7:  2  1  1 -0.2713771
#&gt;  8:  2  1  2 -0.1364510
#&gt;  9:  2  2  1  0.2413600
#&gt; 10:  2  2  2 -0.9840585
#&gt; 11:  2  3  1 -0.5286298
#&gt; 12:  2  3  2 -1.4844445</div><div class='input'>
<span class='co'>## for each combination of (v1, v2), add up all values of v4</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v1</span> + <span class='no'>v2</span> ~ <span class='no'>.</span>, <span class='kw'>value.var</span> <span class='kw'>=</span> <span class='st'>"v4"</span>, <span class='kw'>fun.aggregate</span> <span class='kw'>=</span> <span class='no'>sum</span>)</div><div class='output co'>#&gt;    v1 v2          .
#&gt; 1:  1  1 -0.4078281
#&gt; 2:  1  2 -0.7426985
#&gt; 3:  1  3 -2.0130743
#&gt; 4:  2  1 -0.4078281
#&gt; 5:  2  2 -0.7426985
#&gt; 6:  2  3 -2.0130743</div><div class='input'>
<span class='co'># fill and types</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v2</span> ~ <span class='no'>v3</span>, <span class='kw'>value.var</span> <span class='kw'>=</span> <span class='st'>'v1'</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fl'>0L</span>)  <span class='co'>#  0L --&gt; 0</span></div><div class='output co'>#&gt; <span class='message'>Aggregate function missing, defaulting to 'length'</span></div><div class='output co'>#&gt;    v2 1 2
#&gt; 1:  1 2 2
#&gt; 2:  2 2 2
#&gt; 3:  3 2 2</div><div class='input'><span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>v2</span> ~ <span class='no'>v3</span>, <span class='kw'>value.var</span> <span class='kw'>=</span> <span class='st'>'v4'</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fl'>1.1</span>) <span class='co'># 1.1 --&gt; 1L</span></div><div class='output co'>#&gt; <span class='message'>Aggregate function missing, defaulting to 'length'</span></div><div class='output co'>#&gt;    v2 1 2
#&gt; 1:  1 2 2
#&gt; 2:  2 2 2
#&gt; 3:  3 2 2</div><div class='input'>
<span class='co'># multiple value.var and multiple fun.aggregate</span>
<span class='no'>DT</span> <span class='kw'>=</span> <span class='fu'><a href='data.table.html'>data.table</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>5</span>,<span class='fl'>20</span>,<span class='fl'>TRUE</span>), <span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>2</span>,<span class='fl'>20</span>,<span class='fl'>TRUE</span>),
                <span class='kw'>z</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='fl'>20</span>,<span class='fl'>TRUE</span>), <span class='kw'>d1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>20</span>), <span class='kw'>d2</span><span class='kw'>=</span><span class='fl'>1L</span>)
<span class='co'># multiple value.var</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>x</span> + <span class='no'>y</span> ~ <span class='no'>z</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='no'>sum</span>, <span class='kw'>value.var</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"d1"</span>,<span class='st'>"d2"</span>))</div><div class='output co'>#&gt;    x y       d1_a      d1_b d2_a d2_b
#&gt; 1: 1 1 1.43682427 0.9854205    2    1
#&gt; 2: 1 2 0.70465202 0.1695072    1    1
#&gt; 3: 2 1 0.87082789 0.0000000    1    0
#&gt; 4: 2 2 0.00000000 0.0742473    0    1
#&gt; 5: 3 1 0.49326962 0.2193234    2    2
#&gt; 6: 3 2 0.08148138 0.0000000    1    0
#&gt; 7: 4 1 1.07577703 1.1836827    2    2
#&gt; 8: 4 2 0.67587545 0.7127355    1    1
#&gt; 9: 5 2 0.57778167 0.5192365    1    1</div><div class='input'><span class='co'># multiple fun.aggregate</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>x</span> + <span class='no'>y</span> ~ <span class='no'>z</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>sum</span>, <span class='no'>mean</span>), <span class='kw'>value.var</span><span class='kw'>=</span><span class='st'>"d1"</span>)</div><div class='output co'>#&gt;    x y   d1_sum_a  d1_sum_b  d1_mean_a d1_mean_b
#&gt; 1: 1 1 1.43682427 0.9854205 0.71841214 0.9854205
#&gt; 2: 1 2 0.70465202 0.1695072 0.70465202 0.1695072
#&gt; 3: 2 1 0.87082789 0.0000000 0.87082789       NaN
#&gt; 4: 2 2 0.00000000 0.0742473        NaN 0.0742473
#&gt; 5: 3 1 0.49326962 0.2193234 0.24663481 0.1096617
#&gt; 6: 3 2 0.08148138 0.0000000 0.08148138       NaN
#&gt; 7: 4 1 1.07577703 1.1836827 0.53788852 0.5918414
#&gt; 8: 4 2 0.67587545 0.7127355 0.67587545 0.7127355
#&gt; 9: 5 2 0.57778167 0.5192365 0.57778167 0.5192365</div><div class='input'><span class='co'># multiple fun.agg and value.var (all combinations)</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>x</span> + <span class='no'>y</span> ~ <span class='no'>z</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>sum</span>, <span class='no'>mean</span>), <span class='kw'>value.var</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"d1"</span>, <span class='st'>"d2"</span>))</div><div class='output co'>#&gt;    x y   d1_sum_a  d1_sum_b d2_sum_a d2_sum_b  d1_mean_a d1_mean_b d2_mean_a
#&gt; 1: 1 1 1.43682427 0.9854205        2        1 0.71841214 0.9854205         1
#&gt; 2: 1 2 0.70465202 0.1695072        1        1 0.70465202 0.1695072         1
#&gt; 3: 2 1 0.87082789 0.0000000        1        0 0.87082789       NaN         1
#&gt; 4: 2 2 0.00000000 0.0742473        0        1        NaN 0.0742473       NaN
#&gt; 5: 3 1 0.49326962 0.2193234        2        2 0.24663481 0.1096617         1
#&gt; 6: 3 2 0.08148138 0.0000000        1        0 0.08148138       NaN         1
#&gt; 7: 4 1 1.07577703 1.1836827        2        2 0.53788852 0.5918414         1
#&gt; 8: 4 2 0.67587545 0.7127355        1        1 0.67587545 0.7127355         1
#&gt; 9: 5 2 0.57778167 0.5192365        1        1 0.57778167 0.5192365         1
#&gt;    d2_mean_b
#&gt; 1:         1
#&gt; 2:         1
#&gt; 3:       NaN
#&gt; 4:         1
#&gt; 5:         1
#&gt; 6:       NaN
#&gt; 7:         1
#&gt; 8:         1
#&gt; 9:         1</div><div class='input'><span class='co'># multiple fun.agg and value.var (one-to-one)</span>
<span class='fu'>dcast</span>(<span class='no'>DT</span>, <span class='no'>x</span> + <span class='no'>y</span> ~ <span class='no'>z</span>, <span class='kw'>fun</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>sum</span>, <span class='no'>mean</span>), <span class='kw'>value.var</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"d1"</span>, <span class='st'>"d2"</span>))</div><div class='output co'>#&gt;    x y   d1_sum_a  d1_sum_b d2_mean_a d2_mean_b
#&gt; 1: 1 1 1.43682427 0.9854205         1         1
#&gt; 2: 1 2 0.70465202 0.1695072         1         1
#&gt; 3: 2 1 0.87082789 0.0000000         1       NaN
#&gt; 4: 2 2 0.00000000 0.0742473       NaN         1
#&gt; 5: 3 1 0.49326962 0.2193234         1         1
#&gt; 6: 3 2 0.08148138 0.0000000         1       NaN
#&gt; 7: 4 1 1.07577703 1.1836827         1         1
#&gt; 8: 4 2 0.67587545 0.7127355         1         1
#&gt; 9: 5 2 0.57778167 0.5192365         1         1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matt Dowle, Arun Srinivasan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


