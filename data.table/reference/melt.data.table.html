<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast melt for data.table — melt.data.table • data.table</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast melt for data.table — melt.data.table" />
<meta property="og:description" content="An S3 method for melting data.tables written in C for speed and memory
efficiency. Since v1.9.6, melt.data.table allows melting into
multiple columns simultaneously." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">data.table</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.12.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/datatable-benchmarking.html">Benchmarking data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-faq.html">Frequently Asked Questions about data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-importing.html">Importing data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-intro.html">Introduction to data.table</a>
    </li>
    <li>
      <a href="../articles/datatable-keys-fast-subset.html">Keys and fast binary search based subset</a>
    </li>
    <li>
      <a href="../articles/datatable-reference-semantics.html">Reference semantics</a>
    </li>
    <li>
      <a href="../articles/datatable-reshape.html">Efficient reshaping using data.tables</a>
    </li>
    <li>
      <a href="../articles/datatable-sd-usage.html">Using .SD for Data Analysis</a>
    </li>
    <li>
      <a href="../articles/datatable-secondary-indices-and-auto-indexing.html">Secondary indices and auto indexing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Rdatatable/data.table">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast melt for data.table</h1>
    
    <div class="hidden name"><code>melt.data.table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An S3 method for melting <code>data.table</code>s written in C for speed and memory
efficiency. Since <code>v1.9.6</code>, <code>melt.data.table</code> allows melting into
multiple columns simultaneously.</p>
    </div>

    <pre class="usage"><span class='co'>## fast melt a data.table</span>
<span class='co'># S3 method for data.table</span>
<span class='fu'>melt</span>(<span class='no'>data</span>, <span class='no'>id.vars</span>, <span class='no'>measure.vars</span>,
    <span class='kw'>variable.name</span> <span class='kw'>=</span> <span class='st'>"variable"</span>, <span class='kw'>value.name</span> <span class='kw'>=</span> <span class='st'>"value"</span>,
    <span class='no'>...</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>variable.factor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>value.factor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"datatable.verbose"</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A <code>data.table</code> object to melt.</p></td>
    </tr>
    <tr>
      <th>id.vars</th>
      <td><p>vector of id variables. Can be integer (corresponding id
column numbers) or character (id column names) vector. If missing, all
non-measure columns will be assigned to it. If integer, must be positive; see Details.</p></td>
    </tr>
    <tr>
      <th>measure.vars</th>
      <td><p>Measure variables for <code>melt</code>ing. Can be missing, vector, list, or pattern-based.</p>
<p></p><ul>
<li><p>When missing, <code>measure.vars</code> will become all columns outside <code>id.vars</code>.</p></li>
<li><p>Vector can be <code>integer</code> (implying column numbers) or <code>character</code> (column names).</p></li>
<li><p><code>list</code> is a generalization of the vector version -- each element of the list (which should be <code>integer</code> or <code>character</code> as above) will become a <code>melt</code>ed column.</p></li>
<li><p>Pattern-based column matching can be achieved with the regular expression-based <code><a href='patterns.html'>patterns</a></code> syntax; multiple patterns will produce multiple columns.</p></li>
</ul>

<p>For convenience/clarity in the case of multiple <code>melt</code>ed columns, resulting column names can be supplied as names to the elements <code>measure.vars</code> (in the <code>list</code> and <code>patterns</code> usages). See also <code>Examples</code>.</p></td>
    </tr>
    <tr>
      <th>variable.name</th>
      <td><p>name for the measured variable names column. The default name is <code>'variable'</code>.</p></td>
    </tr>
    <tr>
      <th>value.name</th>
      <td><p>name for the molten data values column(s). The default name is <code>'value'</code>. Multiple names can be provided here for the case when <code>measure.vars</code> is a <code>list</code>, though note well that the names provided in <code>measure.vars</code> take precedence.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>If <code>TRUE</code>, <code>NA</code> values will be removed from the molten
data.</p></td>
    </tr>
    <tr>
      <th>variable.factor</th>
      <td><p>If <code>TRUE</code>, the <code>variable</code> column will be
converted to <code>factor</code>, else it will be a <code>character</code> column.</p></td>
    </tr>
    <tr>
      <th>value.factor</th>
      <td><p>If <code>TRUE</code>, the <code>value</code> column will be converted
to <code>factor</code>, else the molten value type is left unchanged.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>TRUE</code> turns on status and information messages to the
console. Turn this on by default using <code><a href='https://rdrr.io/r/base/options.html'>options(datatable.verbose=TRUE)</a></code>.
The quantity and types of verbosity may be expanded in future.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>any other arguments to be passed to/from other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If <code>id.vars</code> and <code>measure.vars</code> are both missing, all
non-<code>numeric/integer/logical</code> columns are assigned as id variables and
the rest as measure variables. If only one of <code>id.vars</code> or
<code>measure.vars</code> is supplied, the rest of the columns will be assigned to
the other. Both <code>id.vars</code> and <code>measure.vars</code> can have the same column
more than once and the same column can be both as id and measure variables.</p>
<p><code>melt.data.table</code> also accepts <code>list</code> columns for both id and measure
variables.</p>
<p>When all <code>measure.vars</code> are not of the same type, they'll be coerced
according to the hierarchy <code>list</code> &gt; <code>character</code> &gt; <code>numeric &gt;
integer &gt; logical</code>. For example, if any of the measure variables is a
<code>list</code>, then entire value column will be coerced to a list. Note that,
if the type of <code>value</code> column is a list, <code>na.rm = TRUE</code> will have no
effect.</p>
<p>From version <code>1.9.6</code>, <code>melt</code> gains a feature with <code>measure.vars</code>
accepting a list of <code>character</code> or <code>integer</code> vectors as well to melt
into multiple columns in a single function call efficiently. The function
<code><a href='patterns.html'>patterns</a></code> can be used to provide regular expression patterns. When
used along with <code>melt</code>, if <code>cols</code> argument is not provided, the
patterns will be matched against <code><a href='https://rdrr.io/r/base/names.html'>names(data)</a></code>, for convenience.</p>
<p>Attributes are preserved if all <code>value</code> columns are of the same type. By
default, if any of the columns to be melted are of type <code>factor</code>, it'll
be coerced to <code>character</code> type. To get a <code>factor</code> column, set
<code>value.factor = TRUE</code>. <code>melt.data.table</code> also preserves
<code>ordered</code> factors.</p>
<p>Historical note: <code>melt.data.table</code> was originally designed as an enhancement to <code><a href='https://rdrr.io/pkg/reshape2/man/melt.html'>reshape2::melt</a></code> in terms of computing and memory efficiency. <code>reshape2</code> has since been deprecated, and <code>melt</code> has had a generic defined within <code>data.table</code> since <code>v1.9.6</code> in 2015, at which point the dependency between the packages became more etymological than programmatic. We thank the <code>reshape2</code> authors for the inspiration.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An unkeyed <code>data.table</code> containing the molten data.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='dcast.data.table.html'>dcast</a></code>, <a href='https://cran.r-project.org/package=reshape'>https://cran.r-project.org/package=reshape</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>45</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>data.table</span>)
<span class='no'>DT</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='data.table.html'>data.table</a></span>(
      <span class='kw'>i_1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>NA</span>),
      <span class='kw'>i_2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>10</span>),
      <span class='kw'>f_1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='fl'>NA</span>), <span class='fl'>6</span>, <span class='fl'>TRUE</span>)),
      <span class='kw'>f_2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"z"</span>, <span class='st'>"a"</span>, <span class='st'>"x"</span>, <span class='st'>"c"</span>, <span class='st'>"x"</span>, <span class='st'>"x"</span>), <span class='kw'>ordered</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
      <span class='kw'>c_1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='fl'>NA</span>), <span class='fl'>6</span>, <span class='fl'>TRUE</span>),
      <span class='kw'>d_1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>,<span class='fl'>NA</span>,<span class='fl'>4</span>:<span class='fl'>5</span>), <span class='kw'>origin</span><span class='kw'>=</span><span class='st'>"2013-09-01"</span>),
      <span class='kw'>d_2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='fl'>6</span>:<span class='fl'>1</span>, <span class='kw'>origin</span><span class='kw'>=</span><span class='st'>"2012-01-01"</span>))
<span class='co'># add a couple of list cols</span>
<span class='no'>DT</span>[, <span class='no'>l_1</span> <span class='kw'>:=</span> <span class='no'>DT</span>[, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='no'>i_1</span>, <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>5</span>,<span class='fl'>1</span>)))), <span class='kw'>by</span> <span class='kw'>=</span> <span class='no'>i_1</span>]$<span class='no'>c</span>]</div><div class='output co'>#&gt;    i_1 i_2  f_1 f_2  c_1        d_1        d_2            l_1
#&gt; 1:   1  NA    a   z    c 2013-09-02 2012-01-07      1,1,1,1,1
#&gt; 2:   2   6    c   a    c 2013-09-03 2012-01-06        2,2,2,2
#&gt; 3:   3   7    b   x &lt;NA&gt; 2013-09-04 2012-01-05        3,3,3,3
#&gt; 4:   4   8 &lt;NA&gt;   c    c       &lt;NA&gt; 2012-01-04        4,4,4,4
#&gt; 5:   5   9    c   x &lt;NA&gt; 2013-09-05 2012-01-03              5
#&gt; 6:  NA  10    b   x    c 2013-09-06 2012-01-02 NA,NA,NA,NA,NA</div><div class='input'><span class='no'>DT</span>[, <span class='no'>l_2</span> <span class='kw'>:=</span> <span class='no'>DT</span>[, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='no'>c_1</span>, <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>5</span>,<span class='fl'>1</span>)))), <span class='kw'>by</span> <span class='kw'>=</span> <span class='no'>i_1</span>]$<span class='no'>c</span>]</div><div class='output co'>#&gt;    i_1 i_2  f_1 f_2  c_1        d_1        d_2            l_1       l_2
#&gt; 1:   1  NA    a   z    c 2013-09-02 2012-01-07      1,1,1,1,1   c,c,c,c
#&gt; 2:   2   6    c   a    c 2013-09-03 2012-01-06        2,2,2,2   c,c,c,c
#&gt; 3:   3   7    b   x &lt;NA&gt; 2013-09-04 2012-01-05        3,3,3,3  NA,NA,NA
#&gt; 4:   4   8 &lt;NA&gt;   c    c       &lt;NA&gt; 2012-01-04        4,4,4,4 c,c,c,c,c
#&gt; 5:   5   9    c   x &lt;NA&gt; 2013-09-05 2012-01-03              5        NA
#&gt; 6:  NA  10    b   x    c 2013-09-06 2012-01-02 NA,NA,NA,NA,NA       c,c</div><div class='input'>
<span class='co'># id, measure as character/integer/numeric vectors</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='st'>"f_1"</span>)</div><div class='output co'>#&gt;    i_1 i_2 variable value
#&gt; 1:   1  NA      f_1     a
#&gt; 2:   2   6      f_1     c
#&gt; 3:   3   7      f_1     b
#&gt; 4:   4   8      f_1  &lt;NA&gt;
#&gt; 5:   5   9      f_1     c
#&gt; 6:  NA  10      f_1     b</div><div class='input'><span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"i_1"</span>, <span class='st'>"i_2"</span>), <span class='kw'>measure</span><span class='kw'>=</span><span class='fl'>3</span>) <span class='co'># same as above</span></div><div class='output co'>#&gt;    i_1 i_2 variable value
#&gt; 1:   1  NA      f_1     a
#&gt; 2:   2   6      f_1     c
#&gt; 3:   3   7      f_1     b
#&gt; 4:   4   8      f_1  &lt;NA&gt;
#&gt; 5:   5   9      f_1     c
#&gt; 6:  NA  10      f_1     b</div><div class='input'><span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fl'>3L</span>, <span class='kw'>value.factor</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># same, but 'value' is factor</span></div><div class='output co'>#&gt;    i_1 i_2 variable value
#&gt; 1:   1  NA      f_1     a
#&gt; 2:   2   6      f_1     c
#&gt; 3:   3   7      f_1     b
#&gt; 4:   4   8      f_1  &lt;NA&gt;
#&gt; 5:   5   9      f_1     c
#&gt; 6:  NA  10      f_1     b</div><div class='input'><span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fl'>3</span>:<span class='fl'>4</span>, <span class='kw'>value.factor</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># 'value' is *ordered* factor</span></div><div class='output co'>#&gt;     i_1 i_2 variable value
#&gt;  1:   1  NA      f_1     a
#&gt;  2:   2   6      f_1     c
#&gt;  3:   3   7      f_1     b
#&gt;  4:   4   8      f_1  &lt;NA&gt;
#&gt;  5:   5   9      f_1     c
#&gt;  6:  NA  10      f_1     b
#&gt;  7:   1  NA      f_2     z
#&gt;  8:   2   6      f_2     a
#&gt;  9:   3   7      f_2     x
#&gt; 10:   4   8      f_2     c
#&gt; 11:   5   9      f_2     x
#&gt; 12:  NA  10      f_2     x</div><div class='input'>
<span class='co'># preserves attribute when types are identical, ex: Date</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>3</span>:<span class='fl'>4</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"d_1"</span>, <span class='st'>"d_2"</span>))</div><div class='output co'>#&gt;      f_1 f_2 variable      value
#&gt;  1:    a   z      d_1 2013-09-02
#&gt;  2:    c   a      d_1 2013-09-03
#&gt;  3:    b   x      d_1 2013-09-04
#&gt;  4: &lt;NA&gt;   c      d_1       &lt;NA&gt;
#&gt;  5:    c   x      d_1 2013-09-05
#&gt;  6:    b   x      d_1 2013-09-06
#&gt;  7:    a   z      d_2 2012-01-07
#&gt;  8:    c   a      d_2 2012-01-06
#&gt;  9:    b   x      d_2 2012-01-05
#&gt; 10: &lt;NA&gt;   c      d_2 2012-01-04
#&gt; 11:    c   x      d_2 2012-01-03
#&gt; 12:    b   x      d_2 2012-01-02</div><div class='input'><span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>3</span>:<span class='fl'>4</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"i_1"</span>, <span class='st'>"d_1"</span>)) <span class='co'># attribute not preserved</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'measure.vars' [i_1, d_1] are not all of the same type. By order of hierarchy, the molten data value column will be of type 'double'. All measure variables not of type 'double' will be coerced too. Check DETAILS in ?melt.data.table for more on coercion.</span></div><div class='output co'>#&gt;      f_1 f_2 variable value
#&gt;  1:    a   z      i_1     1
#&gt;  2:    c   a      i_1     2
#&gt;  3:    b   x      i_1     3
#&gt;  4: &lt;NA&gt;   c      i_1     4
#&gt;  5:    c   x      i_1     5
#&gt;  6:    b   x      i_1    NA
#&gt;  7:    a   z      d_1 15950
#&gt;  8:    c   a      d_1 15951
#&gt;  9:    b   x      d_1 15952
#&gt; 10: &lt;NA&gt;   c      d_1    NA
#&gt; 11:    c   x      d_1 15953
#&gt; 12:    b   x      d_1 15954</div><div class='input'>
<span class='co'># on list</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"l_1"</span>, <span class='st'>"l_2"</span>)) <span class='co'># value is a list</span></div><div class='output co'>#&gt;     i_1 variable          value
#&gt;  1:   1      l_1      1,1,1,1,1
#&gt;  2:   2      l_1        2,2,2,2
#&gt;  3:   3      l_1        3,3,3,3
#&gt;  4:   4      l_1        4,4,4,4
#&gt;  5:   5      l_1              5
#&gt;  6:  NA      l_1 NA,NA,NA,NA,NA
#&gt;  7:   1      l_2        c,c,c,c
#&gt;  8:   2      l_2        c,c,c,c
#&gt;  9:   3      l_2       NA,NA,NA
#&gt; 10:   4      l_2      c,c,c,c,c
#&gt; 11:   5      l_2             NA
#&gt; 12:  NA      l_2            c,c</div><div class='input'><span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"c_1"</span>, <span class='st'>"l_1"</span>)) <span class='co'># c1 coerced to list</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'measure.vars' [c_1, l_1] are not all of the same type. By order of hierarchy, the molten data value column will be of type 'list'. All measure variables not of type 'list' will be coerced too. Check DETAILS in ?melt.data.table for more on coercion.</span></div><div class='output co'>#&gt;     i_1 variable          value
#&gt;  1:   1      c_1              c
#&gt;  2:   2      c_1              c
#&gt;  3:   3      c_1             NA
#&gt;  4:   4      c_1              c
#&gt;  5:   5      c_1             NA
#&gt;  6:  NA      c_1              c
#&gt;  7:   1      l_1      1,1,1,1,1
#&gt;  8:   2      l_1        2,2,2,2
#&gt;  9:   3      l_1        3,3,3,3
#&gt; 10:   4      l_1        4,4,4,4
#&gt; 11:   5      l_1              5
#&gt; 12:  NA      l_1 NA,NA,NA,NA,NA</div><div class='input'>
<span class='co'># on character</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"c_1"</span>, <span class='st'>"f_1"</span>)) <span class='co'># value is char</span></div><div class='output co'>#&gt;     i_1 variable value
#&gt;  1:   1      c_1     c
#&gt;  2:   2      c_1     c
#&gt;  3:   3      c_1  &lt;NA&gt;
#&gt;  4:   4      c_1     c
#&gt;  5:   5      c_1  &lt;NA&gt;
#&gt;  6:  NA      c_1     c
#&gt;  7:   1      f_1     a
#&gt;  8:   2      f_1     c
#&gt;  9:   3      f_1     b
#&gt; 10:   4      f_1  &lt;NA&gt;
#&gt; 11:   5      f_1     c
#&gt; 12:  NA      f_1     b</div><div class='input'><span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"c_1"</span>, <span class='st'>"i_2"</span>)) <span class='co'># i2 coerced to char</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'measure.vars' [c_1, i_2] are not all of the same type. By order of hierarchy, the molten data value column will be of type 'character'. All measure variables not of type 'character' will be coerced too. Check DETAILS in ?melt.data.table for more on coercion.</span></div><div class='output co'>#&gt;     i_1 variable value
#&gt;  1:   1      c_1     c
#&gt;  2:   2      c_1     c
#&gt;  3:   3      c_1  &lt;NA&gt;
#&gt;  4:   4      c_1     c
#&gt;  5:   5      c_1  &lt;NA&gt;
#&gt;  6:  NA      c_1     c
#&gt;  7:   1      i_2  &lt;NA&gt;
#&gt;  8:   2      i_2     6
#&gt;  9:   3      i_2     7
#&gt; 10:   4      i_2     8
#&gt; 11:   5      i_2     9
#&gt; 12:  NA      i_2    10</div><div class='input'>
<span class='co'># on na.rm=TRUE. NAs are removed efficiently, from within C</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"c_1"</span>, <span class='st'>"i_2"</span>), <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># remove NA</span></div><div class='output co'>#&gt; <span class='warning'>Warning: 'measure.vars' [c_1, i_2] are not all of the same type. By order of hierarchy, the molten data value column will be of type 'character'. All measure variables not of type 'character' will be coerced too. Check DETAILS in ?melt.data.table for more on coercion.</span></div><div class='output co'>#&gt;    i_1 variable value
#&gt; 1:   1      c_1     c
#&gt; 2:   2      c_1     c
#&gt; 3:   4      c_1     c
#&gt; 4:  NA      c_1     c
#&gt; 5:   2      i_2     6
#&gt; 6:   3      i_2     7
#&gt; 7:   4      i_2     8
#&gt; 8:   5      i_2     9
#&gt; 9:  NA      i_2    10</div><div class='input'>
<span class='co'># measure.vars can be also a list</span>
<span class='co'># melt "f_1,f_2" and "d_1,d_2" simultaneously, retain 'factor' attribute</span>
<span class='co'># convenient way using internal function patterns()</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='patterns.html'>patterns</a></span>(<span class='st'>"^f_"</span>, <span class='st'>"^d_"</span>), <span class='kw'>value.factor</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;     i_1 i_2 variable value1     value2
#&gt;  1:   1  NA        1      a 2013-09-02
#&gt;  2:   2   6        1      c 2013-09-03
#&gt;  3:   3   7        1      b 2013-09-04
#&gt;  4:   4   8        1   &lt;NA&gt;       &lt;NA&gt;
#&gt;  5:   5   9        1      c 2013-09-05
#&gt;  6:  NA  10        1      b 2013-09-06
#&gt;  7:   1  NA        2      z 2012-01-07
#&gt;  8:   2   6        2      a 2012-01-06
#&gt;  9:   3   7        2      x 2012-01-05
#&gt; 10:   4   8        2      c 2012-01-04
#&gt; 11:   5   9        2      x 2012-01-03
#&gt; 12:  NA  10        2      x 2012-01-02</div><div class='input'><span class='co'># same as above, but provide list of columns directly by column names or indices</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fl'>3</span>:<span class='fl'>4</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"d_1"</span>, <span class='st'>"d_2"</span>)), <span class='kw'>value.factor</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;     i_1 i_2 variable value1     value2
#&gt;  1:   1  NA        1      a 2013-09-02
#&gt;  2:   2   6        1      c 2013-09-03
#&gt;  3:   3   7        1      b 2013-09-04
#&gt;  4:   4   8        1   &lt;NA&gt;       &lt;NA&gt;
#&gt;  5:   5   9        1      c 2013-09-05
#&gt;  6:  NA  10        1      b 2013-09-06
#&gt;  7:   1  NA        2      z 2012-01-07
#&gt;  8:   2   6        2      a 2012-01-06
#&gt;  9:   3   7        2      x 2012-01-05
#&gt; 10:   4   8        2      c 2012-01-04
#&gt; 11:   5   9        2      x 2012-01-03
#&gt; 12:  NA  10        2      x 2012-01-02</div><div class='input'><span class='co'># same as above, but provide names directly:</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='patterns.html'>patterns</a></span>(<span class='kw'>f</span><span class='kw'>=</span><span class='st'>"^f_"</span>, <span class='kw'>d</span><span class='kw'>=</span><span class='st'>"^d_"</span>), <span class='kw'>value.factor</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;     i_1 i_2 variable    f          d
#&gt;  1:   1  NA        1    a 2013-09-02
#&gt;  2:   2   6        1    c 2013-09-03
#&gt;  3:   3   7        1    b 2013-09-04
#&gt;  4:   4   8        1 &lt;NA&gt;       &lt;NA&gt;
#&gt;  5:   5   9        1    c 2013-09-05
#&gt;  6:  NA  10        1    b 2013-09-06
#&gt;  7:   1  NA        2    z 2012-01-07
#&gt;  8:   2   6        2    a 2012-01-06
#&gt;  9:   3   7        2    x 2012-01-05
#&gt; 10:   4   8        2    c 2012-01-04
#&gt; 11:   5   9        2    x 2012-01-03
#&gt; 12:  NA  10        2    x 2012-01-02</div><div class='input'>
<span class='co'># na.rm=TRUE removes rows with NAs in any 'value' columns</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='patterns.html'>patterns</a></span>(<span class='st'>"f_"</span>, <span class='st'>"d_"</span>), <span class='kw'>value.factor</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;     i_1 i_2 variable value1     value2
#&gt;  1:   1  NA        1      a 2013-09-02
#&gt;  2:   2   6        1      c 2013-09-03
#&gt;  3:   3   7        1      b 2013-09-04
#&gt;  4:   5   9        1      c 2013-09-05
#&gt;  5:  NA  10        1      b 2013-09-06
#&gt;  6:   1  NA        2      z 2012-01-07
#&gt;  7:   2   6        2      a 2012-01-06
#&gt;  8:   3   7        2      x 2012-01-05
#&gt;  9:   4   8        2      c 2012-01-04
#&gt; 10:   5   9        2      x 2012-01-03
#&gt; 11:  NA  10        2      x 2012-01-02</div><div class='input'>
<span class='co'># return 'NA' for missing columns, 'na.rm=TRUE' ignored due to list column</span>
<span class='fu'>melt</span>(<span class='no'>DT</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>measure</span><span class='kw'>=</span><span class='fu'><a href='patterns.html'>patterns</a></span>(<span class='st'>"l_"</span>, <span class='st'>"c_"</span>), <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;     i_1 i_2 variable         value1 value2
#&gt;  1:   1  NA        1      1,1,1,1,1      c
#&gt;  2:   2   6        1        2,2,2,2      c
#&gt;  3:   3   7        1        3,3,3,3   &lt;NA&gt;
#&gt;  4:   4   8        1        4,4,4,4      c
#&gt;  5:   5   9        1              5   &lt;NA&gt;
#&gt;  6:  NA  10        1 NA,NA,NA,NA,NA      c
#&gt;  7:   1  NA        2        c,c,c,c   &lt;NA&gt;
#&gt;  8:   2   6        2        c,c,c,c   &lt;NA&gt;
#&gt;  9:   3   7        2       NA,NA,NA   &lt;NA&gt;
#&gt; 10:   4   8        2      c,c,c,c,c   &lt;NA&gt;
#&gt; 11:   5   9        2             NA   &lt;NA&gt;
#&gt; 12:  NA  10        2            c,c   &lt;NA&gt;</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matt Dowle, Arun Srinivasan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


