<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MSEP, RMSEP and R2 of PLSR and PCR models — mvrVal • pls</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="MSEP, RMSEP and R2 of PLSR and PCR models — mvrVal" />
<meta property="og:description" content="Functions to estimate the mean squared error of prediction (MSEP),
  root mean squared error of prediction (RMSEP) and \(R^2\)
  (A.K.A. coefficient of multiple determination) for fitted
  PCR and PLSR models.  Test-set, cross-validation and calibration-set
  estimates are implemented." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pls</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bhmevik/pls">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MSEP, RMSEP and R2 of PLSR and PCR models</h1>
    
    <div class="hidden name"><code>mvrVal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to estimate the mean squared error of prediction (MSEP),
  root mean squared error of prediction (RMSEP) and \(R^2\)
  (A.K.A. coefficient of multiple determination) for fitted
  PCR and PLSR models.  Test-set, cross-validation and calibration-set
  estimates are implemented.</p>
    </div>

    <pre class="usage"><span class='fu'>MSEP</span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for mvr</span>
<span class='fu'>MSEP</span>(<span class='no'>object</span>, <span class='no'>estimate</span>, <span class='no'>newdata</span>, <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='no'>object</span>$<span class='no'>ncomp</span>, <span class='no'>comps</span>,
     <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='no'>cumulative</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>RMSEP</span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for mvr</span>
<span class='fu'>RMSEP</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='fu'>R2</span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for mvr</span>
<span class='fu'>R2</span>(<span class='no'>object</span>, <span class='no'>estimate</span>, <span class='no'>newdata</span>, <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='no'>object</span>$<span class='no'>ncomp</span>, <span class='no'>comps</span>,
   <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='no'>cumulative</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>mvrValstats</span>(<span class='no'>object</span>, <span class='no'>estimate</span>, <span class='no'>newdata</span>, <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='no'>object</span>$<span class='no'>ncomp</span>, <span class='no'>comps</span>,
            <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='no'>cumulative</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an <code>mvr</code> object</p></td>
    </tr>
    <tr>
      <th>estimate</th>
      <td><p>a character vector.  Which estimators to use.
    Should be a subset of <code><a href='https://rdrr.io/r/base/c.html'>c("all", "train", "CV", "adjCV",
      "test")</a></code>.  <code>"adjCV"</code> is only available for (R)MSEP.  See
    below for how the estimators are chosen.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>a data frame with test set data.</p></td>
    </tr>
    <tr>
      <th>ncomp, comps</th>
      <td><p>a vector of positive integers.  The components or number
    of components to use.  See below.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>logical.  Whether estimates for a model with zero
    components should be returned as well.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>logical.  Whether estimated standard errors of the estimates
    should be calculated.  Not implemented yet.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments sent to underlying functions or (for
    <code>RMSEP</code>) to <code>MSEP</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>RMSEP</code> simply calls <code>MSEP</code> and takes the square root of the
  estimates.  It therefore accepts the same arguments as <code>MSEP</code>.</p>
<p>Several estimators can be used.  <code>"train"</code> is the training
  or calibration data estimate, also called (R)MSEC.  For <code>R2</code>,
  this is the unadjusted \(R^2\).  It is
  overoptimistic and should not be used for assessing models.
  <code>"CV"</code> is the cross-validation estimate, and <code>"adjCV"</code> (for
  <code>RMSEP</code> and <code>MSEP</code>) is
  the bias-corrected cross-validation estimate.  They can only be
  calculated if the model has been cross-validated.
  Finally, <code>"test"</code> is the test set estimate, using <code>newdata</code>
  as test set.</p>
<p>Which estimators to use is decided as follows (see below for
  <code>mvrValstats</code>).  If
  <code>estimate</code> is not specified, the test set estimate is returned if
  <code>newdata</code> is specified, otherwise the CV and adjusted CV (for
  <code>RMSEP</code> and <code>MSEP</code>)
  estimates if the model has been cross-validated, otherwise the
  training data estimate.  If <code>estimate</code> is <code>"all"</code>, all
  possible estimates are calculated.  Otherwise, the specified estimates
  are calculated.</p>
<p>Several model sizes can also be specified.  If <code>comps</code> is missing
  (or is <code>NULL</code>), <code><a href='https://rdrr.io/r/base/length.html'>length(ncomp)</a></code> models are used, with
  <code>ncomp[1]</code> components, ..., <code>ncomp[length(ncomp)]</code>
  components.  Otherwise, a single model with the components
  <code>comps[1]</code>, ..., <code>comps[length(comps)]</code> is used.
  If <code>intercept</code> is <code>TRUE</code>, a model with zero components is
  also used (in addition to the above).</p>
<p>The \(R^2\) values returned by <code>"R2"</code> are calculated as \(1
    - SSE/SST\), where \(SST\) is the (corrected) total sum of squares
  of the response, and \(SSE\) is the sum of squared errors for either
  the fitted values (i.e., the residual sum of squares), test set
  predictions or cross-validated predictions (i.e., the \(PRESS\)).
  For <code>estimate = "train"</code>, this is equivalent to the squared
  correlation between the fitted values and the response.  For
  <code>estimate = "train"</code>, the estimate is often called the prediction
  \(R^2\).</p>  
<p><code>mvrValstats</code> is a utility function that calculates the
  statistics needed by <code>MSEP</code> and <code>R2</code>.  It is not intended to
  be used interactively.  It accepts the same arguments as <code>MSEP</code>
  and <code>R2</code>.  However, the <code>estimate</code> argument must be
  specified explicitly: no partial matching and no automatic choice is
  made.  The function simply calculates the types of estimates it knows,
  and leaves the other untouched.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>mvrValstats</code> returns a list with components</p><dl class='dl-horizontal'>
  <dt>SSE</dt><dd><p>three-dimensional array of SSE values.  The first dimension
    is the different estimators, the second is the response variables
    and the third is the models.</p></dd>
  <dt>SST</dt><dd><p>matrix of SST values.  The first dimension
    is the different estimators and the second is the response
    variables.</p></dd>
  <dt>nobj</dt><dd><p>a numeric vector giving the number of objects used for
    each estimator.</p></dd>
  <dt>comps</dt><dd><p>the components specified, with <code>0</code> prepended if
    <code>intercept</code> is <code>TRUE</code>.</p></dd>
  <dt>cumulative</dt><dd><p><code>TRUE</code> if <code>comps</code> was <code>NULL</code> or not
    specified.</p></dd>
  
</dl>

<p>The other functions return an object of class <code>"mvrVal"</code>, with
  components</p><dl class='dl-horizontal'>
  <dt>val</dt><dd><p>three-dimensional array of estimates.  The first dimension
    is the different estimators, the second is the response variables
    and the third is the models.</p></dd>
  <dt>type</dt><dd><p><code>"MSEP"</code>, <code>"RMSEP"</code> or <code>"R2"</code>.</p></dd>
  <dt>comps</dt><dd><p>the components specified, with <code>0</code> prepended if
    <code>intercept</code> is <code>TRUE</code>.</p></dd>
  <dt>cumulative</dt><dd><p><code>TRUE</code> if <code>comps</code> was <code>NULL</code> or not
    specified.</p></dd>
  <dt>call</dt><dd><p>the function call</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mevik, B.-H., Cederkvist, H. R. (2004) Mean Squared Error of
  Prediction (MSEP) Estimates for Principal Component Regression (PCR)
  and Partial Least Squares Regression (PLSR).
  <em>Journal of Chemometrics</em>, <b>18</b>(9), 422--429.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mvr.html'>mvr</a></code>, <code><a href='crossval.html'>crossval</a></code>, <code><a href='mvrCv.html'>mvrCv</a></code>,
  <code><a href='validationplot.html'>validationplot</a></code>, <code><a href='validationplot.html'>plot.mvrVal</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>oliveoil</span>)
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mvr.html'>plsr</a></span>(<span class='no'>sensory</span> ~ <span class='no'>chemical</span>, <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>oliveoil</span>, <span class='kw'>validation</span> <span class='kw'>=</span> <span class='st'>"LOO"</span>)
<span class='fu'>RMSEP</span>(<span class='no'>mod</span>)</div><div class='output co'>#&gt; 
#&gt; Response: yellow 
#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps
#&gt; CV            20.1    18.97    16.10    16.71    18.11
#&gt; adjCV         20.1    18.91    16.03    16.61    17.93
#&gt; 
#&gt; Response: green 
#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps
#&gt; CV           24.26    23.88    20.45    21.35    23.96
#&gt; adjCV        24.26    23.80    20.35    21.20    23.70
#&gt; 
#&gt; Response: brown 
#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps
#&gt; CV           5.297    4.019    3.987    3.987    4.107
#&gt; adjCV        5.297    3.990    3.955    3.947    4.050
#&gt; 
#&gt; Response: glossy 
#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps
#&gt; CV           6.391    5.109    5.161    5.571    6.446
#&gt; adjCV        6.391    5.087    5.129    5.522    6.363
#&gt; 
#&gt; Response: transp 
#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps
#&gt; CV            8.58    7.258    7.158    7.665    8.794
#&gt; adjCV         8.58    7.232    7.118    7.607    8.691
#&gt; 
#&gt; Response: syrup 
#&gt;        (Intercept)  1 comps  2 comps  3 comps  4 comps
#&gt; CV           3.166    2.134    2.325    2.478    2.939
#&gt; adjCV        3.166    2.128    2.310    2.458    2.901</div><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>R2</span>(<span class='no'>mod</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Ron Wehrens and Bjørn-Helge Mevik</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bjørn-Helge Mevik, Ron Wehrens, Kristian Hovde Liland.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


