<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Suggestions for the optimal number of components in PCR and PLSR models — selectNcomp • pls</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Suggestions for the optimal number of components in PCR and PLSR models — selectNcomp" />
<meta property="og:description" content="Choosing the best number of components in PCR and PLSR models is difficult
  and usually done on the basis of visual inspection of the validation
  plots. In cases where large numbers of models are built this choice
  needs to be automated. This function implements two proposals, one
  based on randomization (permutation) testing, and an
  approach based on the standard error of the cross-validation residuals." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pls</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bhmevik/pls">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Suggestions for the optimal number of components in PCR and PLSR models</h1>
    
    <div class="hidden name"><code>selectNcomp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Choosing the best number of components in PCR and PLSR models is difficult
  and usually done on the basis of visual inspection of the validation
  plots. In cases where large numbers of models are built this choice
  needs to be automated. This function implements two proposals, one
  based on randomization (permutation) testing, and an
  approach based on the standard error of the cross-validation residuals.</p>
    </div>

    <pre class="usage"><span class='fu'>selectNcomp</span>(<span class='no'>object</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"randomization"</span>, <span class='st'>"onesigma"</span>),
            <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='no'>object</span>$<span class='no'>ncomp</span>,
            <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an <code>mvr</code> object.  The fitted model. It should
    contain a <code>validation</code> element.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character string, indicating the heuristic to use.</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>number of permutations in the <code>"randomization"</code>
    approach - not used in the <code>"onesigma"</code> approach.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>cutoff for p values in the <code>"randomization"</code>
    approach - not used in the <code>"onesigma"</code> approach.</p></td>
    </tr>
    <tr>
      <th>ncomp</th>
      <td><p>maximum number of components to consider when determining
    the global minimum in the cross-validation curve.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>whether or not to show a cross-validation plot. The plot
    for the <code>"randomization"</code> approach shows models that do not differ
    significantly from the global RMSEP minimum with open circles; the
    <code>"onesigma"</code> approach shows the 
    one-sigma bands around the RMSEP values. In both cases, the
    selection is indicated with a blue dashed line.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further plotting arguments, e.g., to add a title to the
    plot, or to limit the plotting range.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In both approaches the results of cross-validation are used, so
  the model should have been calculated with some form of
  cross-validation. First, the absolute minimum in the CV curve is
  determined (considering only the first ncomp components), leading to
  the reference model. The randomization test approach (Van der Voet, 1994)
  checks whether the squared prediction errors of models with fewer
  components are significantly larger than in the reference model. This
  leads for each model considered to a \(p\) value; the smallest model not
  significantly worse than the reference model is returned as the
  selected one.</p>
<p>The approach <code>"onesigma"</code> simply returns the first model where the
  optimal CV is within one standard error of the absolute optimum
  (Hastie, Tibshirani and Friedman, 2009). Note that here we
  simply use the standard deviation of the cross-validation
  residuals, in line with the procedure used to calculate the error
  measure itself. Some other packages implementing similar procedures
  (such as <code>glmnet</code>) calculate an error measure for each validation
  segment separately and use the average as the final estimate. In such
  cases the standard error across segments is the relevant measure of
  spread. For LOO, the two procedures are identical. In other forms of
  validation, small differences will occur.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A number indicating the suggested number of components in the
  model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Van der Voet, H. (1994) Comparing the predictive accuracy of models
  using a simple randomization test. Chemom. Intell. Lab. Syst. 25 (2),
  313-323</p>
<p>Hastie, T., Friedman, J. and Tibshirani, R. The Elements of
  Statistical Learning: data mining, inference, and prediction,
  Springer (2013), 10th printing with corrections, paragraph 7.10.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mvr.html'>mvr</a></code>, <code><a href='summary.mvr.html'>summary.mvr</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>yarn</span>)
<span class='no'>yarn.pls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mvr.html'>plsr</a></span>(<span class='no'>density</span> ~ <span class='no'>NIR</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>yarn</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                 <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>validation</span> <span class='kw'>=</span> <span class='st'>"LOO"</span>)
<span class='fu'>selectNcomp</span>(<span class='no'>yarn.pls</span>, <span class='st'>"onesigma"</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>))</div><div class='img'><img src='selectNcomp-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; [1] 9</div><div class='input'><span class='fu'>selectNcomp</span>(<span class='no'>yarn.pls</span>, <span class='st'>"randomization"</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='selectNcomp-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; [1] 8</div><div class='input'><span class='fu'>selectNcomp</span>(<span class='no'>yarn.pls</span>, <span class='st'>"randomization"</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
            <span class='kw'>ncomp</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>))</div><div class='img'><img src='selectNcomp-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; [1] 7</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Ron Wehrens, Hilko van der Voet and Gerie van der Heijden</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bjørn-Helge Mevik, Ron Wehrens, Kristian Hovde Liland.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


