<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict method for eXtreme Gradient Boosting model — predict.xgb.Booster • xgboost</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict method for eXtreme Gradient Boosting model — predict.xgb.Booster" />
<meta property="og:description" content="Predicted values based on either xgboost model or model handle object." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xgboost</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.90.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-archive fa-lg"></span>
     
    R Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../boot/index.html">boot</a>
    </li>
    <li>
      <a href="../../broom/index.html">broom</a>
    </li>
    <li>
      <a href="../../caret/index.html">caret</a>
    </li>
    <li>
      <a href="../../cluster/index.html">cluster</a>
    </li>
    <li>
      <a href="../../coefplot/index.html">coefplot</a>
    </li>
    <li>
      <a href="../../data.table/index.html">data.table</a>
    </li>
    <li>
      <a href="../../devtools/index.html">devtools</a>
    </li>
    <li>
      <a href="../../dplyr/index.html">dplyr</a>
    </li>
    <li>
      <a href="../../e1071/index.html">e1071</a>
    </li>
    <li>
      <a href="../../forcats/index.html">forcats</a>
    </li>
    <li>
      <a href="../../gbm/index.html">gbm</a>
    </li>
    <li>
      <a href="../../ggplot2/index.html">ggplot2</a>
    </li>
    <li>
      <a href="../../glmnet/index.html">glmnet</a>
    </li>
    <li>
      <a href="../../gridExtra/index.html">gridExtra</a>
    </li>
    <li>
      <a href="../../ISLR/index.html">ISLR</a>
    </li>
    <li>
      <a href="../../MASS/index.html">MASS</a>
    </li>
    <li>
      <a href="../../pdp/index.html">pdp</a>
    </li>
    <li>
      <a href="../../pls/index.html">pls</a>
    </li>
    <li>
      <a href="../../plyr/index.html">plyr</a>
    </li>
    <li>
      <a href="../../pROC/index.html">pROC</a>
    </li>
    <li>
      <a href="../../purrr/index.html">purrr</a>
    </li>
    <li>
      <a href="../../randomForest/index.html">randomForest</a>
    </li>
    <li>
      <a href="../../readr/index.html">readr</a>
    </li>
    <li>
      <a href="../../rpart/index.html">rpart</a>
    </li>
    <li>
      <a href="../../rpart.plot/index.html">rpart.plot</a>
    </li>
    <li>
      <a href="../../stringr/index.html">stringr</a>
    </li>
    <li>
      <a href="../../tibble/index.html">tibble</a>
    </li>
    <li>
      <a href="../../tidyr/index.html">tidyr</a>
    </li>
    <li>
      <a href="../../xgboost/index.html">xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/discoverYourData.html">Understand your dataset with Xgboost</a>
    </li>
    <li>
      <a href="../articles/xgboostPresentation.html">Xgboost presentation</a>
    </li>
    <li>
      <a href="../articles/xgboostfromJSON.html">XGBoost from JSON</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dmlc/xgboost">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict method for eXtreme Gradient Boosting model</h1>
    <small class="dont-index">Source: <a href='https://github.com/dmlc/xgboost/blob/master/R/xgb.Booster.R'><code>R/xgb.Booster.R</code></a></small>
    <div class="hidden name"><code>predict.xgb.Booster.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predicted values based on either xgboost model or model handle object.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for xgb.Booster</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>object</span>, <span class='no'>newdata</span>, <span class='kw'>missing</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>outputmargin</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ntreelimit</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>predleaf</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>predcontrib</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>approxcontrib</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>predinteraction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>reshape</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for xgb.Booster.handle</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>xgb.Booster</code> or <code>xgb.Booster.handle</code></p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>takes <code>matrix</code>, <code>dgCMatrix</code>, local data file or <code>xgb.DMatrix</code>.</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>Missing is only used when input is dense matrix. Pick a float value that represents
missing values in data (e.g., sometimes 0 or some other extreme value is used).</p></td>
    </tr>
    <tr>
      <th>outputmargin</th>
      <td><p>whether the prediction should be returned in the for of original untransformed
sum of predictions from boosting iterations' results. E.g., setting <code>outputmargin=TRUE</code> for
logistic regression would result in predictions for log-odds instead of probabilities.</p></td>
    </tr>
    <tr>
      <th>ntreelimit</th>
      <td><p>limit the number of model's trees or boosting iterations used in prediction (see Details).
It will use all the trees by default (<code>NULL</code> value).</p></td>
    </tr>
    <tr>
      <th>predleaf</th>
      <td><p>whether predict leaf index.</p></td>
    </tr>
    <tr>
      <th>predcontrib</th>
      <td><p>whether to return feature contributions to individual predictions (see Details).</p></td>
    </tr>
    <tr>
      <th>approxcontrib</th>
      <td><p>whether to use a fast approximation for feature contributions (see Details).</p></td>
    </tr>
    <tr>
      <th>predinteraction</th>
      <td><p>whether to return contributions of feature interactions to individual predictions (see Details).</p></td>
    </tr>
    <tr>
      <th>reshape</th>
      <td><p>whether to reshape the vector of predictions to a matrix form when there are several
prediction outputs per case. This option has no effect when either of predleaf, predcontrib,
or predinteraction flags is TRUE.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Parameters passed to <code>predict.xgb.Booster</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For regression or binary classification, it returns a vector of length <code>nrows(newdata)</code>.
For multiclass classification, either a <code>num_class * nrows(newdata)</code> vector or
a <code>(nrows(newdata), num_class)</code> dimension matrix is returned, depending on
the <code>reshape</code> value.</p>
<p>When <code>predleaf = TRUE</code>, the output is a matrix object with the
number of columns corresponding to the number of trees.</p>
<p>When <code>predcontrib = TRUE</code> and it is not a multiclass setting, the output is a matrix object with
<code>num_features + 1</code> columns. The last "+ 1" column in a matrix corresponds to bias.
For a multiclass case, a list of <code>num_class</code> elements is returned, where each element is
such a matrix. The contribution values are on the scale of untransformed margin
(e.g., for binary classification would mean that the contributions are log-odds deviations from bias).</p>
<p>When <code>predinteraction = TRUE</code> and it is not a multiclass setting, the output is a 3d array with
dimensions <code><a href='https://rdrr.io/r/base/c.html'>c(nrow, num_features + 1, num_features + 1)</a></code>. The off-diagonal (in the last two dimensions)
elements represent different features interaction contributions. The array is symmetric WRT the last
two dimensions. The "+ 1" columns corresponds to bias. Summing this array along the last dimension should
produce practically the same result as predict with <code>predcontrib = TRUE</code>.
For a multiclass case, a list of <code>num_class</code> elements is returned, where each element is
such an array.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that <code>ntreelimit</code> is not necessarily equal to the number of boosting iterations
and it is not necessarily equal to the number of trees in a model.
E.g., in a random forest-like model, <code>ntreelimit</code> would limit the number of trees.
But for multiclass classification, while there are multiple trees per iteration,
<code>ntreelimit</code> limits the number of boosting iterations.</p>
<p>Also note that <code>ntreelimit</code> would currently do nothing for predictions from gblinear,
since gblinear doesn't keep its boosting history.</p>
<p>One possible practical applications of the <code>predleaf</code> option is to use the model
as a generator of new features which capture non-linearity and interactions,
e.g., as implemented in <code><a href='xgb.create.features.html'>xgb.create.features</a></code>.</p>
<p>Setting <code>predcontrib = TRUE</code> allows to calculate contributions of each feature to
individual predictions. For "gblinear" booster, feature contributions are simply linear terms
(feature_beta * feature_value). For "gbtree" booster, feature contributions are SHAP
values (Lundberg 2017) that sum to the difference between the expected output
of the model and the current prediction (where the hessian weights are used to compute the expectations).
Setting <code>approxcontrib = TRUE</code> approximates these values following the idea explained
in <a href='http://blog.datadive.net/interpreting-random-forests/'>http://blog.datadive.net/interpreting-random-forests/</a>.</p>
<p>With <code>predinteraction = TRUE</code>, SHAP values of contributions of interaction of each pair of features
are computed. Note that this operation might be rather expensive in terms of compute and memory.
Since it quadratically depends on the number of features, it is recommended to perform selection
of the most important features first. See below about the format of the returned results.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Scott M. Lundberg, Su-In Lee, "A Unified Approach to Interpreting Model Predictions", NIPS Proceedings 2017, <a href='https://arxiv.org/abs/1705.07874'>https://arxiv.org/abs/1705.07874</a></p>
<p>Scott M. Lundberg, Su-In Lee, "Consistent feature attribution for tree ensembles", <a href='https://arxiv.org/abs/1706.06060'>https://arxiv.org/abs/1706.06060</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='xgb.train.html'>xgb.train</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## binary classification:</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>agaricus.train</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>'xgboost'</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>agaricus.test</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>'xgboost'</span>)
<span class='no'>train</span> <span class='kw'>&lt;-</span> <span class='no'>agaricus.train</span>
<span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='no'>agaricus.test</span>

<span class='no'>bst</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xgb.train.html'>xgboost</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>train</span>$<span class='no'>data</span>, <span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>train</span>$<span class='no'>label</span>, <span class='kw'>max_depth</span> <span class='kw'>=</span> <span class='fl'>2</span>,
               <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>nthread</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nrounds</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>objective</span> <span class='kw'>=</span> <span class='st'>"binary:logistic"</span>)</div><div class='output co'>#&gt; [1]	train-error:0.046522 
#&gt; [2]	train-error:0.043605 
#&gt; [3]	train-error:0.023338 
#&gt; [4]	train-error:0.028251 
#&gt; [5]	train-error:0.011823 </div><div class='input'><span class='co'># use all trees by default</span>
<span class='no'>pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='no'>test</span>$<span class='no'>data</span>)
<span class='co'># use only the 1st tree</span>
<span class='no'>pred1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='no'>test</span>$<span class='no'>data</span>, <span class='kw'>ntreelimit</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># Predicting tree leafs:</span>
<span class='co'># the result is an nsamples X ntrees matrix</span>
<span class='no'>pred_leaf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='no'>test</span>$<span class='no'>data</span>, <span class='kw'>predleaf</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pred_leaf</span>)</div><div class='output co'>#&gt;  num [1:1611, 1:5] 4 3 4 4 5 3 3 4 3 3 ...</div><div class='input'>
<span class='co'># Predicting feature contributions to predictions:</span>
<span class='co'># the result is an nsamples X (nfeatures + 1) matrix</span>
<span class='no'>pred_contr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='no'>test</span>$<span class='no'>data</span>, <span class='kw'>predcontrib</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pred_contr</span>)</div><div class='output co'>#&gt;  num [1:1611, 1:127] 0 0 0 0 0 0 0 0 0 0 ...
#&gt;  - attr(*, "dimnames")=List of 2
#&gt;   ..$ : NULL
#&gt;   ..$ : chr [1:127] "cap-shape=bell" "cap-shape=conical" "cap-shape=convex" "cap-shape=flat" ...</div><div class='input'><span class='co'># verify that contributions' sums are equal to log-odds of predictions (up to float precision):</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span>(<span class='no'>pred_contr</span>) - <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>qlogis</a></span>(<span class='no'>pred</span>))</div><div class='output co'>#&gt;       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
#&gt; -3.064e-07 -1.913e-07 -4.851e-08  7.001e-08  2.419e-07  5.765e-07 </div><div class='input'><span class='co'># for the 1st record, let's inspect its features that had non-zero contribution to prediction:</span>
<span class='no'>contr1</span> <span class='kw'>&lt;-</span> <span class='no'>pred_contr</span>[<span class='fl'>1</span>,]
<span class='no'>contr1</span> <span class='kw'>&lt;-</span> <span class='no'>contr1</span>[-<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>contr1</span>)]    <span class='co'># drop BIAS</span>
<span class='no'>contr1</span> <span class='kw'>&lt;-</span> <span class='no'>contr1</span>[<span class='no'>contr1</span> <span class='kw'>!=</span> <span class='fl'>0</span>]        <span class='co'># drop non-contributing features</span>
<span class='no'>contr1</span> <span class='kw'>&lt;-</span> <span class='no'>contr1</span>[<span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>contr1</span>))] <span class='co'># order by contribution magnitude</span>
<span class='no'>old_mar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"mar"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mar</span> <span class='kw'>=</span> <span class='no'>old_mar</span> + <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>7</span>,<span class='fl'>0</span>,<span class='fl'>0</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span>(<span class='no'>contr1</span>, <span class='kw'>horiz</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>las</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"contribution to prediction in log-odds"</span>)</div><div class='img'><img src='predict.xgb.Booster-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mar</span> <span class='kw'>=</span> <span class='no'>old_mar</span>)


<span class='co'>## multiclass classification in iris dataset:</span>

<span class='no'>lb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>iris</span>$<span class='no'>Species</span>) - <span class='fl'>1</span>
<span class='no'>num_class</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>11</span>)
<span class='no'>bst</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xgb.train.html'>xgboost</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>]), <span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>lb</span>,
               <span class='kw'>max_depth</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>nthread</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nrounds</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>subsample</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
               <span class='kw'>objective</span> <span class='kw'>=</span> <span class='st'>"multi:softprob"</span>, <span class='kw'>num_class</span> <span class='kw'>=</span> <span class='no'>num_class</span>)</div><div class='output co'>#&gt; [1]	train-merror:0.040000 
#&gt; [2]	train-merror:0.026667 
#&gt; [3]	train-merror:0.026667 
#&gt; [4]	train-merror:0.020000 
#&gt; [5]	train-merror:0.020000 
#&gt; [6]	train-merror:0.020000 
#&gt; [7]	train-merror:0.013333 
#&gt; [8]	train-merror:0.020000 
#&gt; [9]	train-merror:0.020000 
#&gt; [10]	train-merror:0.020000 </div><div class='input'><span class='co'># predict for softmax returns num_class probability numbers per case:</span>
<span class='no'>pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>]))
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pred</span>)</div><div class='output co'>#&gt;  num [1:450] 0.98502 0.00926 0.00572 0.98502 0.00926 ...</div><div class='input'><span class='co'># reshape it to a num_class-columns matrix</span>
<span class='no'>pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>pred</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>num_class</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># convert the probabilities to softmax labels</span>
<span class='no'>pred_labels</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/maxCol.html'>max.col</a></span>(<span class='no'>pred</span>) - <span class='fl'>1</span>
<span class='co'># the following should result in the same error as seen in the last iteration</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>pred_labels</span> <span class='kw'>!=</span> <span class='no'>lb</span>)/<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>lb</span>)</div><div class='output co'>#&gt; [1] 0.02</div><div class='input'>
<span class='co'># compare that to the predictions from softmax:</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>11</span>)
<span class='no'>bst</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xgb.train.html'>xgboost</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>]), <span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>lb</span>,
               <span class='kw'>max_depth</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>nthread</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nrounds</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>subsample</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
               <span class='kw'>objective</span> <span class='kw'>=</span> <span class='st'>"multi:softmax"</span>, <span class='kw'>num_class</span> <span class='kw'>=</span> <span class='no'>num_class</span>)</div><div class='output co'>#&gt; [1]	train-merror:0.040000 
#&gt; [2]	train-merror:0.026667 
#&gt; [3]	train-merror:0.026667 
#&gt; [4]	train-merror:0.020000 
#&gt; [5]	train-merror:0.020000 
#&gt; [6]	train-merror:0.020000 
#&gt; [7]	train-merror:0.013333 
#&gt; [8]	train-merror:0.020000 
#&gt; [9]	train-merror:0.020000 
#&gt; [10]	train-merror:0.020000 </div><div class='input'><span class='no'>pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>]))
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>pred</span>)</div><div class='output co'>#&gt;  num [1:150] 0 0 0 0 0 0 0 0 0 0 ...</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>pred</span>, <span class='no'>pred_labels</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'># prediction from using only 5 iterations should result</span>
<span class='co'># in the same error as seen in iteration 5:</span>
<span class='no'>pred5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>iris</span>[, -<span class='fl'>5</span>]), <span class='kw'>ntreelimit</span><span class='kw'>=</span><span class='fl'>5</span>)
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>pred5</span> <span class='kw'>!=</span> <span class='no'>lb</span>)/<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>lb</span>)</div><div class='output co'>#&gt; [1] 0.02</div><div class='input'>

<span class='co'>## random forest-like model of 25 trees for binary classification:</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>11</span>)
<span class='no'>bst</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xgb.train.html'>xgboost</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>train</span>$<span class='no'>data</span>, <span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>train</span>$<span class='no'>label</span>, <span class='kw'>max_depth</span> <span class='kw'>=</span> <span class='fl'>5</span>,
               <span class='kw'>nthread</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>nrounds</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>objective</span> <span class='kw'>=</span> <span class='st'>"binary:logistic"</span>,
               <span class='kw'>num_parallel_tree</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>subsample</span> <span class='kw'>=</span> <span class='fl'>0.6</span>, <span class='kw'>colsample_bytree</span> <span class='kw'>=</span> <span class='fl'>0.1</span>)</div><div class='output co'>#&gt; [1]	train-error:0.039306 </div><div class='input'><span class='co'># Inspect the prediction error vs number of trees:</span>
<span class='no'>lb</span> <span class='kw'>&lt;-</span> <span class='no'>test</span>$<span class='no'>label</span>
<span class='no'>dtest</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xgb.DMatrix.html'>xgb.DMatrix</a></span>(<span class='no'>test</span>$<span class='no'>data</span>, <span class='kw'>label</span><span class='kw'>=</span><span class='no'>lb</span>)
<span class='no'>err</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>1</span>:<span class='fl'>25</span>, <span class='kw'>function</span>(<span class='no'>n</span>) {
  <span class='no'>pred</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bst</span>, <span class='no'>dtest</span>, <span class='kw'>ntreelimit</span><span class='kw'>=</span><span class='no'>n</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>((<span class='no'>pred</span> <span class='kw'>&gt;</span> <span class='fl'>0.5</span>) <span class='kw'>!=</span> <span class='no'>lb</span>)/<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>lb</span>)
})
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>err</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0.1</span>), <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>'#trees'</span>)</div><div class='img'><img src='predict.xgb.Booster-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tianqi Chen, Tong He, Michael Benesty, Vadim Khotilovich, Yuan Tang, Hyunsu Cho, Kailong Chen, Rory Mitchell, Ignacio Cano, Tianyi Zhou, Mu Li, Junyuan Xie, Min Lin, Yifeng Geng, Yutian Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


